var e=Object.defineProperty,t=t=>{let n={};for(var r in t)e(n,r,{get:t[r],enumerable:!0});return n};(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var n={context:void 0,registry:void 0,effects:void 0,done:!1,getContextId(){return r(this.context.count)},getNextContextId(){return r(this.context.count++)}};function r(e){let t=String(e),r=t.length-1;return n.context.id+(r?String.fromCharCode(96+r):``)+t}function i(e){n.context=e}function a(){return{...n.context,id:n.getNextContextId(),count:0}}var o=(e,t)=>e===t,s=Symbol(`solid-proxy`),c=typeof Proxy==`function`,l=Symbol(`solid-track`),u={equals:o},d=null,f=Ae,p=1,m=2,h={owned:null,cleanups:null,context:null,owner:null},g={},_=null,v=null,y=null,b=null,x=null,S=null,C=null,ee=0;function te(e,t){let n=x,r=_,i=e.length===0,a=t===void 0?r:t,o=i?h:{owned:null,cleanups:null,context:a?a.context:null,owner:a},s=i?e:()=>e(()=>O(()=>Fe(o)));_=o,x=null;try{return k(s,!0)}finally{x=n,_=r}}function w(e,t){t=t?Object.assign({},u,t):u;let n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0};return[Ce.bind(n),e=>(typeof e==`function`&&(e=v&&v.running&&v.sources.has(n)?e(n.tValue):e(n.value)),we(n,e))]}function ne(e,t,n){let r=De(e,t,!0,p);y&&v&&v.running?S.push(r):Te(r)}function T(e,t,n){let r=De(e,t,!1,p);y&&v&&v.running?S.push(r):Te(r)}function E(e,t,n){f=Me;let r=De(e,t,!1,p),i=xe&&ye(xe);i&&(r.suspense=i),(!n||!n.render)&&(r.user=!0),C?C.push(r):Te(r)}function D(e,t,n){n=n?Object.assign({},u,n):u;let r=De(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,y&&v&&v.running?(r.tState=p,S.push(r)):Te(r),Ce.bind(r)}function re(e){return e&&typeof e==`object`&&`then`in e}function ie(e,t,r){let i,a,o;typeof t==`function`?(i=e,a=t,o=r||{}):(i=!0,a=e,o=t||{});let s=null,c=g,l=null,u=!1,d=!1,f=`initialValue`in o,p=typeof i==`function`&&D(i),m=new Set,[h,y]=(o.storage||w)(o.initialValue),[b,S]=w(void 0),[C,ee]=w(void 0,{equals:!1}),[te,T]=w(f?`ready`:`unresolved`);n.context&&(l=n.getNextContextId(),o.ssrLoadFrom===`initial`?c=o.initialValue:n.load&&n.has(l)&&(c=n.load(l)));function E(e,t,n,r){return s===e&&(s=null,r!==void 0&&(f=!0),(e===c||t===c)&&o.onHydrated&&queueMicrotask(()=>o.onHydrated(r,{value:t})),c=g,v&&e&&u?(v.promises.delete(e),u=!1,k(()=>{v.running=!0,ie(t,n)},!1)):ie(t,n)),t}function ie(e,t){k(()=>{t===void 0&&y(()=>e),T(t===void 0?f?`ready`:`unresolved`:`errored`),S(t);for(let e of m.keys())e.decrement();m.clear()},!1)}function ae(){let e=xe&&ye(xe),t=h(),n=b();if(n!==void 0&&!s)throw n;return x&&!x.user&&e&&ne(()=>{C(),s&&(e.resolved&&v&&u?v.promises.add(s):m.has(e)||(e.increment(),m.add(e)))}),t}function oe(e=!0){if(e!==!1&&d)return;d=!1;let t=p?p():i;if(u=v&&v.running,t==null||t===!1){E(s,O(h));return}v&&s&&v.promises.delete(s);let n,r=c===g?O(()=>{try{return a(t,{value:h(),refetching:e})}catch(e){n=e}}):c;if(n!==void 0){E(s,void 0,Le(n),t);return}else if(!re(r))return E(s,r,void 0,t),r;return s=r,`v`in r?(r.s===1?E(s,r.v,void 0,t):E(s,void 0,Le(r.v),t),r):(d=!0,queueMicrotask(()=>d=!1),k(()=>{T(f?`refreshing`:`pending`),ee()},!1),r.then(e=>E(r,e,void 0,t),e=>E(r,void 0,Le(e),t)))}Object.defineProperties(ae,{state:{get:()=>te()},error:{get:()=>b()},loading:{get(){let e=te();return e===`pending`||e===`refreshing`}},latest:{get(){if(!f)return ae();let e=b();if(e&&!s)throw e;return h()}}});let se=_;return p?ne(()=>(se=_,oe(!1))):oe(!1),[ae,{refetch:e=>pe(se,()=>oe(e)),mutate:y}]}function ae(e,t=o,n){let r=new Map,i=De(n=>{let i=e();for(let[e,a]of r.entries())if(t(e,i)!==t(e,n))for(let e of a.values())e.state=p,e.pure?S.push(e):C.push(e);return i},void 0,!0,p);return Te(i),e=>{let n=x;if(n){let t;(t=r.get(e))?t.add(n):r.set(e,t=new Set([n])),le(()=>{t.delete(n),!t.size&&r.delete(e)})}return t(e,v&&v.running&&v.sources.has(i)?i.tValue:i.value)}}function oe(e){return k(e,!1)}function O(e){if(!b&&x===null)return e();let t=x;x=null;try{return b?b.untrack(e):e()}finally{x=t}}function se(e,t,n){let r=Array.isArray(e),i,a=n&&n.defer;return n=>{let o;if(r){o=Array(e.length);for(let t=0;t<e.length;t++)o[t]=e[t]()}else o=e();if(a)return a=!1,n;let s=O(()=>t(o,i,n));return i=o,s}}function ce(e){E(()=>O(e))}function le(e){return _===null||(_.cleanups===null?_.cleanups=[e]:_.cleanups.push(e)),e}function ue(e,t){d||=Symbol(`error`),_=De(void 0,void 0,!0),_.context={..._.context,[d]:[t]},v&&v.running&&v.sources.add(_);try{return e()}catch(e){ze(e)}finally{_=_.owner}}function de(){return x}function fe(){return _}function pe(e,t){let n=_,r=x;_=e,x=null;try{return k(t,!0)}catch(e){ze(e)}finally{_=n,x=r}}function me(e){if(v&&v.running)return e(),v.done;let t=x,n=_;return Promise.resolve().then(()=>{x=t,_=n;let r;return(y||xe)&&(r=v||={sources:new Set,effects:[],promises:new Set,disposed:new Set,queue:new Set,running:!0},r.done||=new Promise(e=>r.resolve=e),r.running=!0),k(e,!1),x=_=null,r?r.done:void 0})}var[he,ge]=w(!1);function _e(e){C.push.apply(C,e),e.length=0}function ve(e,t){let n=Symbol(`context`);return{id:n,Provider:Ve(n),defaultValue:e}}function ye(e){let t;return _&&_.context&&(t=_.context[e.id])!==void 0?t:e.defaultValue}function be(e){let t=D(e),n=D(()=>Be(t()));return n.toArray=()=>{let e=n();return Array.isArray(e)?e:e==null?[]:[e]},n}var xe;function Se(){return xe||=ve()}function Ce(){let e=v&&v.running;if(this.sources&&(e?this.tState:this.state))if((e?this.tState:this.state)===p)Te(this);else{let e=S;S=null,k(()=>Ne(this),!1),S=e}if(x){let e=this.observers?this.observers.length:0;x.sources?(x.sources.push(this),x.sourceSlots.push(e)):(x.sources=[this],x.sourceSlots=[e]),this.observers?(this.observers.push(x),this.observerSlots.push(x.sources.length-1)):(this.observers=[x],this.observerSlots=[x.sources.length-1])}return e&&v.sources.has(this)?this.tValue:this.value}function we(e,t,n){let r=v&&v.running&&v.sources.has(e)?e.tValue:e.value;if(!e.comparator||!e.comparator(r,t)){if(v){let r=v.running;(r||!n&&v.sources.has(e))&&(v.sources.add(e),e.tValue=t),r||(e.value=t)}else e.value=t;e.observers&&e.observers.length&&k(()=>{for(let t=0;t<e.observers.length;t+=1){let n=e.observers[t],r=v&&v.running;r&&v.disposed.has(n)||((r?!n.tState:!n.state)&&(n.pure?S.push(n):C.push(n),n.observers&&Pe(n)),r?n.tState=p:n.state=p)}if(S.length>1e6)throw S=[],Error()},!1)}return t}function Te(e){if(!e.fn)return;Fe(e);let t=ee;Ee(e,v&&v.running&&v.sources.has(e)?e.tValue:e.value,t),v&&!v.running&&v.sources.has(e)&&queueMicrotask(()=>{k(()=>{v&&(v.running=!0),x=_=e,Ee(e,e.tValue,t),x=_=null},!1)})}function Ee(e,t,n){let r,i=_,a=x;x=_=e;try{r=e.fn(t)}catch(t){return e.pure&&(v&&v.running?(e.tState=p,e.tOwned&&e.tOwned.forEach(Fe),e.tOwned=void 0):(e.state=p,e.owned&&e.owned.forEach(Fe),e.owned=null)),e.updatedAt=n+1,ze(t)}finally{x=a,_=i}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&`observers`in e?we(e,r,!0):v&&v.running&&e.pure?(v.sources.add(e),e.tValue=r):e.value=r,e.updatedAt=n)}function De(e,t,n,r=p,i){let a={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:_,context:_?_.context:null,pure:n};if(v&&v.running&&(a.state=0,a.tState=r),_===null||_!==h&&(v&&v.running&&_.pure?_.tOwned?_.tOwned.push(a):_.tOwned=[a]:_.owned?_.owned.push(a):_.owned=[a]),b&&a.fn){let[e,t]=w(void 0,{equals:!1}),n=b.factory(a.fn,t);le(()=>n.dispose());let r=b.factory(a.fn,()=>me(t).then(()=>r.dispose()));a.fn=t=>(e(),v&&v.running?r.track(t):n.track(t))}return a}function Oe(e){let t=v&&v.running;if((t?e.tState:e.state)===0)return;if((t?e.tState:e.state)===m)return Ne(e);if(e.suspense&&O(e.suspense.inFallback))return e.suspense.effects.push(e);let n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<ee);){if(t&&v.disposed.has(e))return;(t?e.tState:e.state)&&n.push(e)}for(let r=n.length-1;r>=0;r--){if(e=n[r],t){let t=e,i=n[r+1];for(;(t=t.owner)&&t!==i;)if(v.disposed.has(t))return}if((t?e.tState:e.state)===p)Te(e);else if((t?e.tState:e.state)===m){let t=S;S=null,k(()=>Ne(e,n[0]),!1),S=t}}}function k(e,t){if(S)return e();let n=!1;t||(S=[]),C?n=!0:C=[],ee++;try{let t=e();return ke(n),t}catch(e){n||(C=null),S=null,ze(e)}}function ke(e){if(S&&=(y&&v&&v.running?je(S):Ae(S),null),e)return;let t;if(v){if(!v.promises.size&&!v.queue.size){let e=v.sources,n=v.disposed;C.push.apply(C,v.effects),t=v.resolve;for(let e of C)`tState`in e&&(e.state=e.tState),delete e.tState;v=null,k(()=>{for(let e of n)Fe(e);for(let t of e){if(t.value=t.tValue,t.owned)for(let e=0,n=t.owned.length;e<n;e++)Fe(t.owned[e]);t.tOwned&&(t.owned=t.tOwned),delete t.tValue,delete t.tOwned,t.tState=0}ge(!1)},!1)}else if(v.running){v.running=!1,v.effects.push.apply(v.effects,C),C=null,ge(!0);return}}let n=C;C=null,n.length&&k(()=>f(n),!1),t&&t()}function Ae(e){for(let t=0;t<e.length;t++)Oe(e[t])}function je(e){for(let t=0;t<e.length;t++){let n=e[t],r=v.queue;r.has(n)||(r.add(n),y(()=>{r.delete(n),k(()=>{v.running=!0,Oe(n)},!1),v&&(v.running=!1)}))}}function Me(e){let t,r=0;for(t=0;t<e.length;t++){let n=e[t];n.user?e[r++]=n:Oe(n)}if(n.context){if(n.count){n.effects||=[],n.effects.push(...e.slice(0,r));return}i()}for(n.effects&&(n.done||!n.count)&&(e=[...n.effects,...e],r+=n.effects.length,delete n.effects),t=0;t<r;t++)Oe(e[t])}function Ne(e,t){let n=v&&v.running;n?e.tState=0:e.state=0;for(let r=0;r<e.sources.length;r+=1){let i=e.sources[r];if(i.sources){let e=n?i.tState:i.state;e===p?i!==t&&(!i.updatedAt||i.updatedAt<ee)&&Oe(i):e===m&&Ne(i,t)}}}function Pe(e){let t=v&&v.running;for(let n=0;n<e.observers.length;n+=1){let r=e.observers[n];(t?!r.tState:!r.state)&&(t?r.tState=m:r.state=m,r.pure?S.push(r):C.push(r),r.observers&&Pe(r))}}function Fe(e){let t;if(e.sources)for(;e.sources.length;){let t=e.sources.pop(),n=e.sourceSlots.pop(),r=t.observers;if(r&&r.length){let e=r.pop(),i=t.observerSlots.pop();n<r.length&&(e.sourceSlots[i]=n,r[n]=e,t.observerSlots[n]=i)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)Fe(e.tOwned[t]);delete e.tOwned}if(v&&v.running&&e.pure)Ie(e,!0);else if(e.owned){for(t=e.owned.length-1;t>=0;t--)Fe(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}v&&v.running?e.tState=0:e.state=0}function Ie(e,t){if(t||(e.tState=0,v.disposed.add(e)),e.owned)for(let t=0;t<e.owned.length;t++)Ie(e.owned[t])}function Le(e){return e instanceof Error?e:Error(typeof e==`string`?e:`Unknown error`,{cause:e})}function Re(e,t,n){try{for(let n of t)n(e)}catch(e){ze(e,n&&n.owner||null)}}function ze(e,t=_){let n=d&&t&&t.context&&t.context[d],r=Le(e);if(!n)throw r;C?C.push({fn(){Re(r,n,t)},state:p}):Re(r,n,t)}function Be(e){if(typeof e==`function`&&!e.length)return Be(e());if(Array.isArray(e)){let t=[];for(let n=0;n<e.length;n++){let r=Be(e[n]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return e}function Ve(e,t){return function(t){let n;return T(()=>n=O(()=>(_.context={..._.context,[e]:t.value},be(()=>t.children))),void 0),n}}var He=Symbol(`fallback`);function Ue(e){for(let t=0;t<e.length;t++)e[t]()}function We(e,t,n={}){let r=[],i=[],a=[],o=0,s=t.length>1?[]:null;return le(()=>Ue(a)),()=>{let c=e()||[],u=c.length,d,f;return c[l],O(()=>{let e,t,l,m,h,g,_,v,y;if(u===0)o!==0&&(Ue(a),a=[],r=[],i=[],o=0,s&&=[]),n.fallback&&(r=[He],i[0]=te(e=>(a[0]=e,n.fallback())),o=1);else if(o===0){for(i=Array(u),f=0;f<u;f++)r[f]=c[f],i[f]=te(p);o=u}else{for(l=Array(u),m=Array(u),s&&(h=Array(u)),g=0,_=Math.min(o,u);g<_&&r[g]===c[g];g++);for(_=o-1,v=u-1;_>=g&&v>=g&&r[_]===c[v];_--,v--)l[v]=i[_],m[v]=a[_],s&&(h[v]=s[_]);for(e=new Map,t=Array(v+1),f=v;f>=g;f--)y=c[f],d=e.get(y),t[f]=d===void 0?-1:d,e.set(y,f);for(d=g;d<=_;d++)y=r[d],f=e.get(y),f!==void 0&&f!==-1?(l[f]=i[d],m[f]=a[d],s&&(h[f]=s[d]),f=t[f],e.set(y,f)):a[d]();for(f=g;f<u;f++)f in l?(i[f]=l[f],a[f]=m[f],s&&(s[f]=h[f],s[f](f))):i[f]=te(p);i=i.slice(0,o=u),r=c.slice(0)}return i});function p(e){if(a[f]=e,s){let[e,n]=w(f);return s[f]=n,t(c[f],e)}return t(c[f])}}}var Ge=!1;function A(e,t){if(Ge&&n.context){let r=n.context;i(a());let o=O(()=>e(t||{}));return i(r),o}return O(()=>e(t||{}))}function Ke(){return!0}var qe={get(e,t,n){return t===s?n:e.get(t)},has(e,t){return t===s?!0:e.has(t)},set:Ke,deleteProperty:Ke,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:Ke,deleteProperty:Ke}},ownKeys(e){return e.keys()}};function Je(e){return(e=typeof e==`function`?e():e)?e:{}}function Ye(){for(let e=0,t=this.length;e<t;++e){let t=this[e]();if(t!==void 0)return t}}function Xe(...e){let t=!1;for(let n=0;n<e.length;n++){let r=e[n];t||=!!r&&s in r,e[n]=typeof r==`function`?(t=!0,D(r)):r}if(c&&t)return new Proxy({get(t){for(let n=e.length-1;n>=0;n--){let r=Je(e[n])[t];if(r!==void 0)return r}},has(t){for(let n=e.length-1;n>=0;n--)if(t in Je(e[n]))return!0;return!1},keys(){let t=[];for(let n=0;n<e.length;n++)t.push(...Object.keys(Je(e[n])));return[...new Set(t)]}},qe);let n={},r=Object.create(null);for(let t=e.length-1;t>=0;t--){let i=e[t];if(!i)continue;let a=Object.getOwnPropertyNames(i);for(let e=a.length-1;e>=0;e--){let t=a[e];if(t===`__proto__`||t===`constructor`)continue;let o=Object.getOwnPropertyDescriptor(i,t);if(!r[t])r[t]=o.get?{enumerable:!0,configurable:!0,get:Ye.bind(n[t]=[o.get.bind(i)])}:o.value===void 0?void 0:o;else{let e=n[t];e&&(o.get?e.push(o.get.bind(i)):o.value!==void 0&&e.push(()=>o.value))}}}let i={},a=Object.keys(r);for(let e=a.length-1;e>=0;e--){let t=a[e],n=r[t];n&&n.get?Object.defineProperty(i,t,n):i[t]=n?n.value:void 0}return i}function Ze(e,...t){let n=t.length;if(c&&s in e){let r=n>1?t.flat():t[0],i=t.map(t=>new Proxy({get(n){return t.includes(n)?e[n]:void 0},has(n){return t.includes(n)&&n in e},keys(){return t.filter(t=>t in e)}},qe));return i.push(new Proxy({get(t){return r.includes(t)?void 0:e[t]},has(t){return r.includes(t)?!1:t in e},keys(){return Object.keys(e).filter(e=>!r.includes(e))}},qe)),i}let r=[];for(let e=0;e<=n;e++)r[e]={};for(let i of Object.getOwnPropertyNames(e)){let a=n;for(let e=0;e<t.length;e++)if(t[e].includes(i)){a=e;break}let o=Object.getOwnPropertyDescriptor(e,i);!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable?r[a][i]=o.value:Object.defineProperty(r[a],i,o)}return r}function Qe(e){let t,r,a=a=>{let o=n.context;if(o){let[a,s]=w();n.count||=0,n.count++,(r||=e()).then(e=>{!n.done&&i(o),n.count--,s(()=>e.default),i()}),t=a}else if(!t){let[n]=ie(()=>(r||=e()).then(e=>e.default));t=n}let s;return D(()=>(s=t())?O(()=>{if(!o||n.done)return s(a);let e=n.context;i(o);let t=s(a);return i(e),t}):``)};return a.preload=()=>r||((r=e()).then(e=>t=()=>e.default),r),a}var $e=0;function et(){return n.context?n.getNextContextId():`cl-${$e++}`}var tt=e=>`Stale read from <${e}>.`;function nt(e){let t=`fallback`in e&&{fallback:()=>e.fallback};return D(We(()=>e.each,e.children,t||void 0))}function rt(e){let t=e.keyed,n=D(()=>e.when,void 0,void 0),r=t?n:D(n,void 0,{equals:(e,t)=>!e==!t});return D(()=>{let i=r();if(i){let a=e.children;return typeof a==`function`&&a.length>0?O(()=>a(t?i:()=>{if(!O(r))throw tt(`Show`);return n()})):a}return e.fallback},void 0,void 0)}function it(e){let t=be(()=>e.children),n=D(()=>{let e=t(),n=Array.isArray(e)?e:[e],r=()=>void 0;for(let e=0;e<n.length;e++){let t=e,i=n[e],a=r,o=D(()=>a()?void 0:i.when,void 0,void 0),s=i.keyed?o:D(o,void 0,{equals:(e,t)=>!e==!t});r=()=>a()||(s()?[t,o,i]:void 0)}return r});return D(()=>{let t=n()();if(!t)return e.fallback;let[r,i,a]=t,o=a.children;return typeof o==`function`&&o.length>0?O(()=>o(a.keyed?i():()=>{if(O(n)()?.[0]!==r)throw tt(`Match`);return i()})):o},void 0,void 0)}function at(e){return e}var ot;function st(){ot&&[...ot].forEach(e=>e())}function ct(e){let t;n.context&&n.load&&(t=n.load(n.getContextId()));let[r,i]=w(t,void 0);return ot||=new Set,ot.add(i),le(()=>ot.delete(i)),D(()=>{let t;if(t=r()){let n=e.fallback;return typeof n==`function`&&n.length?O(()=>n(t,()=>i())):n}return ue(()=>e.children,i)},void 0,void 0)}var lt=ve();function ut(e){let t=0,r,a,o,s,c,[l,u]=w(!1),d=Se(),f={increment:()=>{++t===1&&u(!0)},decrement:()=>{--t===0&&u(!1)},inFallback:l,effects:[],resolved:!1},p=fe();if(n.context&&n.load){let e=n.getContextId(),t=n.load(e);if(t&&(typeof t!=`object`||t.s!==1?o=t:n.gather(e)),o&&o!==`$$f`){let[t,r]=w(void 0,{equals:!1});s=t,o.then(()=>{if(n.done)return r();n.gather(e),i(a),r(),i()},e=>{c=e,r()})}}let m=ye(lt);m&&(r=m.register(f.inFallback));let h;return le(()=>h&&h()),A(d.Provider,{value:f,get children(){return D(()=>{if(c)throw c;if(a=n.context,s){s(),s=void 0;return}a&&o===`$$f`&&i();let t=D(()=>e.children);return D(n=>{let s=f.inFallback(),{showContent:c=!0,showFallback:l=!0}=r?r():{};if((!s||o&&o!==`$$f`)&&c)return f.resolved=!0,h&&h(),h=a=o=void 0,_e(f.effects),t();if(l)return h?n:te(t=>(h=t,a&&=(i({id:a.id+`F`,count:0}),void 0),e.fallback),p)})})}})}var dt=new Set([`className`,`value`,`readOnly`,`noValidate`,`formNoValidate`,`isMap`,`noModule`,`playsInline`,`adAuctionHeaders`,`allowFullscreen`,`browsingTopics`,`defaultChecked`,`defaultMuted`,`defaultSelected`,`disablePictureInPicture`,`disableRemotePlayback`,`preservesPitch`,`shadowRootClonable`,`shadowRootCustomElementRegistry`,`shadowRootDelegatesFocus`,`shadowRootSerializable`,`sharedStorageWritable`,...`allowfullscreen.async.alpha.autofocus.autoplay.checked.controls.default.disabled.formnovalidate.hidden.indeterminate.inert.ismap.loop.multiple.muted.nomodule.novalidate.open.playsinline.readonly.required.reversed.seamless.selected.adauctionheaders.browsingtopics.credentialless.defaultchecked.defaultmuted.defaultselected.defer.disablepictureinpicture.disableremoteplayback.preservespitch.shadowrootclonable.shadowrootcustomelementregistry.shadowrootdelegatesfocus.shadowrootserializable.sharedstoragewritable`.split(`.`)]),ft=new Set([`innerHTML`,`textContent`,`innerText`,`children`]),pt=Object.assign(Object.create(null),{className:`class`,htmlFor:`for`}),mt=Object.assign(Object.create(null),{class:`className`,novalidate:{$:`noValidate`,FORM:1},formnovalidate:{$:`formNoValidate`,BUTTON:1,INPUT:1},ismap:{$:`isMap`,IMG:1},nomodule:{$:`noModule`,SCRIPT:1},playsinline:{$:`playsInline`,VIDEO:1},readonly:{$:`readOnly`,INPUT:1,TEXTAREA:1},adauctionheaders:{$:`adAuctionHeaders`,IFRAME:1},allowfullscreen:{$:`allowFullscreen`,IFRAME:1},browsingtopics:{$:`browsingTopics`,IMG:1},defaultchecked:{$:`defaultChecked`,INPUT:1},defaultmuted:{$:`defaultMuted`,AUDIO:1,VIDEO:1},defaultselected:{$:`defaultSelected`,OPTION:1},disablepictureinpicture:{$:`disablePictureInPicture`,VIDEO:1},disableremoteplayback:{$:`disableRemotePlayback`,AUDIO:1,VIDEO:1},preservespitch:{$:`preservesPitch`,AUDIO:1,VIDEO:1},shadowrootclonable:{$:`shadowRootClonable`,TEMPLATE:1},shadowrootdelegatesfocus:{$:`shadowRootDelegatesFocus`,TEMPLATE:1},shadowrootserializable:{$:`shadowRootSerializable`,TEMPLATE:1},sharedstoragewritable:{$:`sharedStorageWritable`,IFRAME:1,IMG:1}});function ht(e,t){let n=mt[e];return typeof n==`object`?n[t]?n.$:void 0:n}var gt=new Set([`beforeinput`,`click`,`dblclick`,`contextmenu`,`focusin`,`focusout`,`input`,`keydown`,`keyup`,`mousedown`,`mousemove`,`mouseout`,`mouseover`,`mouseup`,`pointerdown`,`pointermove`,`pointerout`,`pointerover`,`pointerup`,`touchend`,`touchmove`,`touchstart`]),_t={xlink:`http://www.w3.org/1999/xlink`,xml:`http://www.w3.org/XML/1998/namespace`},vt=e=>D(()=>e());function yt(e,t,n){let r=n.length,i=t.length,a=r,o=0,s=0,c=t[i-1].nextSibling,l=null;for(;o<i||s<a;){if(t[o]===n[s]){o++,s++;continue}for(;t[i-1]===n[a-1];)i--,a--;if(i===o){let t=a<r?s?n[s-1].nextSibling:n[a-s]:c;for(;s<a;)e.insertBefore(n[s++],t)}else if(a===s)for(;o<i;)(!l||!l.has(t[o]))&&t[o].remove(),o++;else if(t[o]===n[a-1]&&n[s]===t[i-1]){let r=t[--i].nextSibling;e.insertBefore(n[s++],t[o++].nextSibling),e.insertBefore(n[--a],r),t[i]=n[a]}else{if(!l){l=new Map;let e=s;for(;e<a;)l.set(n[e],e++)}let r=l.get(t[o]);if(r!=null)if(s<r&&r<a){let c=o,u=1,d;for(;++c<i&&c<a&&!((d=l.get(t[c]))==null||d!==r+u);)u++;if(u>r-s){let i=t[o];for(;s<r;)e.insertBefore(n[s++],i)}else e.replaceChild(n[s++],t[o++])}else o++;else t[o++].remove()}}}var bt=`_$DX_DELEGATE`;function xt(e,t,n,r={}){let i;return te(r=>{i=r,t===document?e():N(t,e(),t.firstChild?null:void 0,n)},r.owner),()=>{i(),t.textContent=``}}function j(e,t,n,r){let i,a=()=>{let t=r?document.createElementNS(`http://www.w3.org/1998/Math/MathML`,`template`):document.createElement(`template`);return t.innerHTML=e,n?t.content.firstChild.firstChild:r?t.firstChild:t.content.firstChild},o=t?()=>O(()=>document.importNode(i||=a(),!0)):()=>(i||=a()).cloneNode(!0);return o.cloneNode=o,o}function St(e,t=window.document){let n=t[bt]||(t[bt]=new Set);for(let r=0,i=e.length;r<i;r++){let i=e[r];n.has(i)||(n.add(i),t.addEventListener(i,It))}}function Ct(e,t,n){Mt(e)||(n==null?e.removeAttribute(t):e.setAttribute(t,n))}function wt(e,t,n,r){Mt(e)||(r==null?e.removeAttributeNS(t,n):e.setAttributeNS(t,n,r))}function Tt(e,t,n){Mt(e)||(n?e.setAttribute(t,``):e.removeAttribute(t))}function M(e,t){Mt(e)||(t==null?e.removeAttribute(`class`):e.className=t)}function Et(e,t,n,r){if(r)Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n;else if(Array.isArray(n)){let r=n[0];e.addEventListener(t,n[0]=t=>r.call(e,n[1],t))}else e.addEventListener(t,n,typeof n!=`function`&&n)}function Dt(e,t,n={}){let r=Object.keys(t||{}),i=Object.keys(n),a,o;for(a=0,o=i.length;a<o;a++){let r=i[a];!r||r===`undefined`||t[r]||(Pt(e,r,!1),delete n[r])}for(a=0,o=r.length;a<o;a++){let i=r[a],o=!!t[i];!i||i===`undefined`||n[i]===o||!o||(Pt(e,i,!0),n[i]=o)}return n}function Ot(e,t,n){if(!t)return n?Ct(e,`style`):t;let r=e.style;if(typeof t==`string`)return r.cssText=t;typeof n==`string`&&(r.cssText=n=void 0),n||={},t||={};let i,a;for(a in n)t[a]??r.removeProperty(a),delete n[a];for(a in t)i=t[a],i!==n[a]&&(r.setProperty(a,i),n[a]=i);return n}function kt(e,t={},n,r){let i={};return r||T(()=>i.children=Lt(e,t.children,i.children)),T(()=>typeof t.ref==`function`&&At(t.ref,e)),T(()=>jt(e,t,n,!0,i,!0)),i}function At(e,t,n){return O(()=>e(t,n))}function N(e,t,n,r){if(n!==void 0&&!r&&(r=[]),typeof t!=`function`)return Lt(e,t,r,n);T(r=>Lt(e,t(),r,n),r)}function jt(e,t,n,r,i={},a=!1){for(let r in t||={},i)if(!(r in t)){if(r===`children`)continue;i[r]=Ft(e,r,null,i[r],n,a,t)}for(let o in t){if(o===`children`){r||Lt(e,t.children);continue}let s=t[o];i[o]=Ft(e,o,s,i[o],n,a,t)}}function Mt(e){return!!n.context&&!n.done&&(!e||e.isConnected)}function Nt(e){return e.toLowerCase().replace(/-([a-z])/g,(e,t)=>t.toUpperCase())}function Pt(e,t,n){let r=t.trim().split(/\s+/);for(let t=0,i=r.length;t<i;t++)e.classList.toggle(r[t],n)}function Ft(e,t,n,r,i,a,o){let s,c,l,u,d;if(t===`style`)return Ot(e,n,r);if(t===`classList`)return Dt(e,n,r);if(n===r)return r;if(t===`ref`)a||n(e);else if(t.slice(0,3)===`on:`){let i=t.slice(3);r&&e.removeEventListener(i,r,typeof r!=`function`&&r),n&&e.addEventListener(i,n,typeof n!=`function`&&n)}else if(t.slice(0,10)===`oncapture:`){let i=t.slice(10);r&&e.removeEventListener(i,r,!0),n&&e.addEventListener(i,n,!0)}else if(t.slice(0,2)===`on`){let i=t.slice(2).toLowerCase(),a=gt.has(i);if(!a&&r){let t=Array.isArray(r)?r[0]:r;e.removeEventListener(i,t)}(a||n)&&(Et(e,i,n,a),a&&St([i]))}else if(t.slice(0,5)===`attr:`)Ct(e,t.slice(5),n);else if(t.slice(0,5)===`bool:`)Tt(e,t.slice(5),n);else if((d=t.slice(0,5)===`prop:`)||(l=ft.has(t))||!i&&((u=ht(t,e.tagName))||(c=dt.has(t)))||(s=e.nodeName.includes(`-`)||`is`in o)){if(d)t=t.slice(5),c=!0;else if(Mt(e))return n;t===`class`||t===`className`?M(e,n):s&&!c&&!l?e[Nt(t)]=n:e[u||t]=n}else{let r=i&&t.indexOf(`:`)>-1&&_t[t.split(`:`)[0]];r?wt(e,r,t,n):Ct(e,pt[t]||t,n)}return n}function It(e){if(n.registry&&n.events&&n.events.find(([t,n])=>n===e))return;let t=e.target,r=`$$${e.type}`,i=e.target,a=e.currentTarget,o=t=>Object.defineProperty(e,`target`,{configurable:!0,value:t}),s=()=>{let n=t[r];if(n&&!t.disabled){let i=t[`${r}Data`];if(i===void 0?n.call(t,e):n.call(t,i,e),e.cancelBubble)return}return t.host&&typeof t.host!=`string`&&!t.host._$host&&t.contains(e.target)&&o(t.host),!0},c=()=>{for(;s()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,`currentTarget`,{configurable:!0,get(){return t||document}}),n.registry&&!n.done&&(n.done=_$HY.done=!0),e.composedPath){let n=e.composedPath();o(n[0]);for(let e=0;e<n.length-2&&(t=n[e],s());e++){if(t._$host){t=t._$host,c();break}if(t.parentNode===a)break}}else c();o(i)}function Lt(e,t,n,r,i){let a=Mt(e);if(a){!n&&(n=[...e.childNodes]);let t=[];for(let e=0;e<n.length;e++){let r=n[e];r.nodeType===8&&r.data.slice(0,2)===`!$`?r.remove():t.push(r)}n=t}for(;typeof n==`function`;)n=n();if(t===n)return n;let o=typeof t,s=r!==void 0;if(e=s&&n[0]&&n[0].parentNode||e,o===`string`||o===`number`){if(a||o===`number`&&(t=t.toString(),t===n))return n;if(s){let i=n[0];i&&i.nodeType===3?i.data!==t&&(i.data=t):i=document.createTextNode(t),n=Bt(e,n,r,i)}else n=n!==``&&typeof n==`string`?e.firstChild.data=t:e.textContent=t}else if(t==null||o===`boolean`){if(a)return n;n=Bt(e,n,r)}else if(o===`function`)return T(()=>{let i=t();for(;typeof i==`function`;)i=i();n=Lt(e,i,n,r)}),()=>n;else if(Array.isArray(t)){let o=[],c=n&&Array.isArray(n);if(Rt(o,t,n,i))return T(()=>n=Lt(e,o,n,r,!0)),()=>n;if(a){if(!o.length)return n;if(r===void 0)return n=[...e.childNodes];let t=o[0];if(t.parentNode!==e)return n;let i=[t];for(;(t=t.nextSibling)!==r;)i.push(t);return n=i}if(o.length===0){if(n=Bt(e,n,r),s)return n}else c?n.length===0?zt(e,o,r):yt(e,n,o):(n&&Bt(e),zt(e,o));n=o}else if(t.nodeType){if(a&&t.parentNode)return n=s?[t]:t;if(Array.isArray(n)){if(s)return n=Bt(e,n,r,t);Bt(e,n,null,t)}else n==null||n===``||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}return n}function Rt(e,t,n,r){let i=!1;for(let a=0,o=t.length;a<o;a++){let o=t[a],s=n&&n[e.length],c;if(!(o==null||o===!0||o===!1))if((c=typeof o)==`object`&&o.nodeType)e.push(o);else if(Array.isArray(o))i=Rt(e,o,s)||i;else if(c===`function`)if(r){for(;typeof o==`function`;)o=o();i=Rt(e,Array.isArray(o)?o:[o],Array.isArray(s)?s:[s])||i}else e.push(o),i=!0;else{let t=String(o);s&&s.nodeType===3&&s.data===t?e.push(s):e.push(document.createTextNode(t))}}return i}function zt(e,t,n=null){for(let r=0,i=t.length;r<i;r++)e.insertBefore(t[r],n)}function Bt(e,t,n,r){if(n===void 0)return e.textContent=``;let i=r||document.createTextNode(``);if(t.length){let r=!1;for(let a=t.length-1;a>=0;a--){let o=t[a];if(i!==o){let t=o.parentNode===e;!r&&!a?t?e.replaceChild(i,o):e.insertBefore(i,n):t&&o.remove()}else r=!0}}else e.insertBefore(i,n);return[i]}function Vt(){let e=new Set;function t(t){return e.add(t),()=>e.delete(t)}let n=!1;function r(t,r){if(n)return!(n=!1);let i={to:t,options:r,defaultPrevented:!1,preventDefault:()=>i.defaultPrevented=!0};for(let a of e)a.listener({...i,from:a.location,retry:e=>{e&&(n=!0),a.navigate(t,{...r,resolve:!1})}});return!i.defaultPrevented}return{subscribe:t,confirm:r}}var Ht;function Ut(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},``),Ht=window.history.state._depth}Ut();function Wt(e){return{...e,_depth:window.history.state&&window.history.state._depth}}function Gt(e,t){let n=!1;return()=>{let r=Ht;Ut();let i=r==null?null:Ht-r;if(n){n=!1;return}i&&t(i)?(n=!0,window.history.go(-i)):e()}}var Kt=/^(?:[a-z0-9]+:)?\/\//i,qt=/^\/+|(\/)\/+$/g;const Jt=`http://sr`;function Yt(e,t=!1){let n=e.replace(qt,`$1`);return n?t||/^[?#]/.test(n)?n:`/`+n:``}function Xt(e,t,n){if(Kt.test(t))return;let r=Yt(e),i=n&&Yt(n),a=``;return a=!i||t.startsWith(`/`)?r:i.toLowerCase().indexOf(r.toLowerCase())===0?i:r+i,(a||`/`)+Yt(t,!a)}function Zt(e,t){if(e==null)throw Error(t);return e}function Qt(e,t){return Yt(e).replace(/\/*(\*.*)?$/g,``)+Yt(t)}function $t(e){let t={};return e.searchParams.forEach((e,n)=>{n in t?Array.isArray(t[n])?t[n].push(e):t[n]=[t[n],e]:t[n]=e}),t}function en(e,t,n){let[r,i]=e.split(`/*`,2),a=r.split(`/`).filter(Boolean),o=a.length;return e=>{let r=e.split(`/`).filter(Boolean),s=r.length-o;if(s<0||s>0&&i===void 0&&!t)return null;let c={path:o?``:`/`,params:{}},l=e=>n===void 0?void 0:n[e];for(let e=0;e<o;e++){let t=a[e],n=t[0]===`:`,i=n?r[e]:r[e].toLowerCase(),o=n?t.slice(1):t.toLowerCase();if(n&&tn(i,l(o)))c.params[o]=i;else if(n||!tn(i,o))return null;c.path+=`/${i}`}if(i){let e=s?r.slice(-s).join(`/`):``;if(tn(e,l(i)))c.params[i]=e;else return null}return c}}function tn(e,t){let n=t=>t===e;return t===void 0?!0:typeof t==`string`?n(t):typeof t==`function`?t(e):Array.isArray(t)?t.some(n):t instanceof RegExp?t.test(e):!1}function nn(e){let[t,n]=e.pattern.split(`/*`,2),r=t.split(`/`).filter(Boolean);return r.reduce((e,t)=>e+(t.startsWith(`:`)?2:3),r.length-(n===void 0?0:1))}function rn(e){let t=new Map,n=fe();return new Proxy({},{get(r,i){return t.has(i)||pe(n,()=>t.set(i,D(()=>e()[i]))),t.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(e())},has(t,n){return n in e()}})}function an(e){let t=/(\/?\:[^\/]+)\?/.exec(e);if(!t)return[e];let n=e.slice(0,t.index),r=e.slice(t.index+t[0].length),i=[n,n+=t[1]];for(;t=/^(\/\:[^\/]+)\?/.exec(r);)i.push(n+=t[1]),r=r.slice(t[0].length);return an(r).reduce((e,t)=>[...e,...i.map(e=>e+t)],[])}var on=100;const sn=ve(),cn=ve(),ln=()=>Zt(ye(sn),`<A> and 'use' router primitives can be only used inside a Route.`),un=()=>ye(cn)||ln().base,dn=e=>{let t=un();return D(()=>t.resolvePath(e()))},fn=e=>{let t=ln();return D(()=>{let n=e();return n===void 0?n:t.renderPath(n)})},pn=()=>ln().navigatorFactory(),mn=()=>ln().location;function hn(e,t=``){let{component:n,preload:r,load:i,children:a,info:o}=e,s=!a||Array.isArray(a)&&!a.length,c={key:e,component:n,preload:r||i,info:o};return _n(e.path).reduce((n,r)=>{for(let i of an(r)){let a=Qt(t,i),o=s?a:a.split(`/*`,1)[0];o=o.split(`/`).map(e=>e.startsWith(`:`)||e.startsWith(`*`)?e:encodeURIComponent(e)).join(`/`),n.push({...c,originalPath:r,pattern:o,matcher:en(o,!s,e.matchFilters)})}return n},[])}function gn(e,t=0){return{routes:e,score:nn(e[e.length-1])*1e4-t,matcher(t){let n=[];for(let r=e.length-1;r>=0;r--){let i=e[r],a=i.matcher(t);if(!a)return null;n.unshift({...a,route:i})}return n}}}function _n(e){return Array.isArray(e)?e:[e]}function vn(e,t=``,n=[],r=[]){let i=_n(e);for(let e=0,a=i.length;e<a;e++){let a=i[e];if(a&&typeof a==`object`){a.hasOwnProperty(`path`)||(a.path=``);let e=hn(a,t);for(let t of e){n.push(t);let e=Array.isArray(a.children)&&a.children.length===0;if(a.children&&!e)vn(a.children,t.pattern,n,r);else{let e=gn([...n],r.length);r.push(e)}n.pop()}}}return n.length?r:r.sort((e,t)=>t.score-e.score)}function yn(e,t){for(let n=0,r=e.length;n<r;n++){let r=e[n].matcher(t);if(r)return r}return[]}function bn(e,t,n){let r=new URL(Jt),i=D(t=>{let n=e();try{return new URL(n,r)}catch{return console.error(`Invalid path ${n}`),t}},r,{equals:(e,t)=>e.href===t.href}),a=D(()=>i().pathname),o=D(()=>i().search,!0),s=D(()=>i().hash),c=()=>``,l=se(o,()=>$t(i()));return{get pathname(){return a()},get search(){return o()},get hash(){return s()},get state(){return t()},get key(){return c()},query:n?n(l):rn(l)}}var xn;function Sn(){return xn}function Cn(e,t,n,r={}){let{signal:[i,a],utils:o={}}=e,s=o.parsePath||(e=>e),c=o.renderPath||(e=>e),l=o.beforeLeave||Vt(),u=Xt(``,r.base||``);if(u===void 0)throw Error(`${u} is not a valid base path`);u&&!i().value&&a({value:u,replace:!0,scroll:!1});let[d,f]=w(!1),p,m=(e,t)=>{t.value===h()&&t.state===_()||(p===void 0&&f(!0),xn=e,p=t,me(()=>{p===t&&(g(p.value),v(p.state),st(),x[1](e=>e.filter(e=>e.pending)))}).finally(()=>{p===t&&oe(()=>{xn=void 0,e===`navigate`&&re(p),f(!1),p=void 0})}))},[h,g]=w(i().value),[_,v]=w(i().state),y=bn(h,_,o.queryWrapper),b=[],x=w([]),S=D(()=>typeof r.transformUrl==`function`?yn(t(),r.transformUrl(y.pathname)):yn(t(),y.pathname)),C=()=>{let e=S(),t={};for(let n=0;n<e.length;n++)Object.assign(t,e[n].params);return t},ee=o.paramsWrapper?o.paramsWrapper(C,t):rn(C),te={pattern:u,path:()=>u,outlet:()=>null,resolvePath(e){return Xt(u,e)}};return T(se(i,e=>m(`native`,e),{defer:!0})),{base:te,location:y,params:ee,isRouting:d,renderPath:c,parsePath:s,navigatorFactory:E,matches:S,beforeLeave:l,preloadRoute:ie,singleFlight:r.singleFlight===void 0?!0:r.singleFlight,submissions:x};function ne(e,t,n){O(()=>{if(typeof t==`number`){t&&(o.go?o.go(t):console.warn(`Router integration does not support relative routing`));return}let r=!t||t[0]===`?`,{replace:i,resolve:a,scroll:s,state:c}={replace:!1,resolve:!r,scroll:!0,...n},u=a?e.resolvePath(t):Xt(r&&y.pathname||``,t);if(u===void 0)throw Error(`Path '${t}' is not a routable path`);if(b.length>=on)throw Error(`Too many redirects`);let d=h();(u!==d||c!==_())&&l.confirm(u,n)&&(b.push({value:d,replace:i,scroll:s,state:_()}),m(`navigate`,{value:u,state:c}))})}function E(e){return e=e||ye(cn)||te,(t,n)=>ne(e,t,n)}function re(e){let t=b[0];t&&(a({...e,replace:t.replace,scroll:t.scroll}),b.length=0)}function ie(e,r){let i=yn(t(),e.pathname),a=xn;for(let t in xn=`preload`,i){let{route:a,params:o}=i[t];a.component&&a.component.preload&&a.component.preload();let{preload:s}=a;r&&s&&pe(n(),()=>s({params:o,location:{pathname:e.pathname,search:e.search,hash:e.hash,query:$t(e),state:null,key:``},intent:`preload`}))}xn=a}}function wn(e,t,n,r){let{base:i,location:a,params:o}=e,{pattern:s,component:c,preload:l}=r().route,u=D(()=>r().path);c&&c.preload&&c.preload();let d=l?l({params:o,location:a,intent:xn||`initial`}):void 0;return{parent:t,pattern:s,path:u,outlet:()=>c?A(c,{params:o,location:a,data:d,get children(){return n()}}):n(),resolvePath(e){return Xt(i.path(),e,u())}}}const Tn=e=>t=>{let{base:n}=t,r=be(()=>t.children),i=D(()=>vn(r(),t.base||``)),a,o=Cn(e,i,()=>a,{base:n,singleFlight:t.singleFlight,transformUrl:t.transformUrl});return e.create&&e.create(o),A(sn.Provider,{value:o,get children(){return A(En,{routerState:o,get root(){return t.root},get preload(){return t.rootPreload||t.rootLoad},get children(){return[vt(()=>(a=fe())&&null),A(Dn,{routerState:o,get branches(){return i()}})]}})}})};function En(e){let t=e.routerState.location,n=e.routerState.params,r=D(()=>e.preload&&O(()=>{e.preload({params:n,location:t,intent:Sn()||`initial`})}));return A(rt,{get when(){return e.root},keyed:!0,get fallback(){return e.children},children:i=>A(i,{params:n,location:t,get data(){return r()},get children(){return e.children}})})}function Dn(e){let t=[],n,r=D(se(e.routerState.matches,(i,a,o)=>{let s=a&&i.length===a.length,c=[];for(let n=0,l=i.length;n<l;n++){let l=a&&a[n],u=i[n];o&&l&&u.route.key===l.route.key?c[n]=o[n]:(s=!1,t[n]&&t[n](),te(i=>{t[n]=i,c[n]=wn(e.routerState,c[n-1]||e.routerState.base,On(()=>r()[n+1]),()=>{let t=e.routerState.matches();return t[n]??t[0]})}))}return t.splice(i.length).forEach(e=>e()),o&&s?o:(n=c[0],c)}));return On(()=>r()&&n)()}var On=e=>()=>A(rt,{get when(){return e()},keyed:!0,children:e=>A(cn.Provider,{value:e,get children(){return e.outlet()}})});const kn=e=>{let t=be(()=>e.children);return Xe(e,{get children(){return t()}})};function An([e,t],n,r){return[n?()=>n(e()):e,r?e=>t(r(e)):t]}function jn(e){let t=!1,r=e=>typeof e==`string`?{value:e}:e,i=An(w(r(e.get()),{equals:(e,t)=>e.value===t.value&&e.state===t.state}),void 0,r=>(!t&&e.set(r),n.registry&&!n.done&&(n.done=!0),r));return e.init&&le(e.init((n=e.get())=>{t=!0,i[1](r(n)),t=!1})),Tn({signal:i,create:e.create,utils:e.utils})}function Mn(e,t,n){return e.addEventListener(t,n),()=>e.removeEventListener(t,n)}function Nn(e,t){let n=e&&document.getElementById(e);n?n.scrollIntoView():t&&window.scrollTo(0,0)}const Pn=new Map;function Fn(e=!0,t=!1,n=`/_server`,r){return i=>{let a=i.base.path(),o=i.navigatorFactory(i.base),s,c;function l(e){return e.namespaceURI===`http://www.w3.org/2000/svg`}function u(e){if(e.defaultPrevented||e.button!==0||e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)return;let n=e.composedPath().find(e=>e instanceof Node&&e.nodeName.toUpperCase()===`A`);if(!n||t&&!n.hasAttribute(`link`))return;let r=l(n),i=r?n.href.baseVal:n.href;if((r?n.target.baseVal:n.target)||!i&&!n.hasAttribute(`state`))return;let o=(n.getAttribute(`rel`)||``).split(/\s+/);if(n.hasAttribute(`download`)||o&&o.includes(`external`))return;let s=r?new URL(i,document.baseURI):new URL(i);if(!(s.origin!==window.location.origin||a&&s.pathname&&!s.pathname.toLowerCase().startsWith(a.toLowerCase())))return[n,s]}function d(e){let t=u(e);if(!t)return;let[n,r]=t,a=i.parsePath(r.pathname+r.search+r.hash),s=n.getAttribute(`state`);e.preventDefault(),o(a,{resolve:!1,replace:n.hasAttribute(`replace`),scroll:!n.hasAttribute(`noscroll`),state:s?JSON.parse(s):void 0})}function f(e){let t=u(e);if(!t)return;let[n,a]=t;r&&(a.pathname=r(a.pathname)),i.preloadRoute(a,n.getAttribute(`preload`)!==`false`)}function p(e){clearTimeout(s);let t=u(e);if(!t)return c=null;let[n,a]=t;c!==n&&(r&&(a.pathname=r(a.pathname)),s=setTimeout(()=>{i.preloadRoute(a,n.getAttribute(`preload`)!==`false`),c=n},20))}function m(e){if(e.defaultPrevented)return;let t=e.submitter&&e.submitter.hasAttribute(`formaction`)?e.submitter.getAttribute(`formaction`):e.target.getAttribute(`action`);if(!t)return;if(!t.startsWith(`https://action/`)){let e=new URL(t,Jt);if(t=i.parsePath(e.pathname+e.search),!t.startsWith(n))return}if(e.target.method.toUpperCase()!==`POST`)throw Error(`Only POST forms are supported for Actions`);let r=Pn.get(t);if(r){e.preventDefault();let t=new FormData(e.target,e.submitter);r.call({r:i,f:e.target},e.target.enctype===`multipart/form-data`?t:new URLSearchParams(t))}}St([`click`,`submit`]),document.addEventListener(`click`,d),e&&(document.addEventListener(`mousemove`,p,{passive:!0}),document.addEventListener(`focusin`,f,{passive:!0}),document.addEventListener(`touchstart`,f,{passive:!0})),document.addEventListener(`submit`,m),le(()=>{document.removeEventListener(`click`,d),e&&(document.removeEventListener(`mousemove`,p),document.removeEventListener(`focusin`,f),document.removeEventListener(`touchstart`,f)),document.removeEventListener(`submit`,m)})}}function In(e){let t=()=>{let e=window.location.pathname.replace(/^\/+/,`/`)+window.location.search,t=window.history.state&&window.history.state._depth&&Object.keys(window.history.state).length===1?void 0:window.history.state;return{value:e+window.location.hash,state:t}},n=Vt();return jn({get:t,set({value:e,replace:t,scroll:n,state:r}){t?window.history.replaceState(Wt(r),``,e):window.history.pushState(r,``,e),Nn(decodeURIComponent(window.location.hash.slice(1)),n),Ut()},init:e=>Mn(window,`popstate`,Gt(e,e=>{if(e)return!n.confirm(e);{let e=t();return!n.confirm(e.value,{state:e.state})}})),create:Fn(e.preload,e.explicitLinks,e.actionBase,e.transformUrl),utils:{go:e=>window.history.go(e),beforeLeave:n}})(e)}var Ln=j(`<a>`);function Rn(e){e=Xe({inactiveClass:`inactive`,activeClass:`active`},e);let[,t]=Ze(e,[`href`,`state`,`class`,`activeClass`,`inactiveClass`,`end`]),n=dn(()=>e.href),r=fn(n),i=mn(),a=D(()=>{let t=n();if(t===void 0)return[!1,!1];let r=Yt(t.split(/[?#]/,1)[0]).toLowerCase(),a=decodeURI(Yt(i.pathname).toLowerCase());return[e.end?r===a:a.startsWith(r+`/`)||a===r,r===a]});return(()=>{var n=Ln();return kt(n,Xe(t,{get href(){return r()||e.href},get state(){return JSON.stringify(e.state)},get classList(){return{...e.class&&{[e.class]:!0},[e.inactiveClass]:!a()[0],[e.activeClass]:a()[0],...t.classList}},link:``,get"aria-current"(){return a()[1]?`page`:void 0}}),!1,!1),n})()}var zn=Symbol(`store-raw`),Bn=Symbol(`store-node`),Vn=Symbol(`store-has`),Hn=Symbol(`store-self`);function Un(e){let t=e[s];if(!t&&(Object.defineProperty(e,s,{value:t=new Proxy(e,Zn)}),!Array.isArray(e))){let n=Object.keys(e),r=Object.getOwnPropertyDescriptors(e);for(let i=0,a=n.length;i<a;i++){let a=n[i];r[a].get&&Object.defineProperty(e,a,{enumerable:r[a].enumerable,get:r[a].get.bind(t)})}}return t}function Wn(e){let t;return typeof e==`object`&&!!e&&(e[s]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function Gn(e,t=new Set){let n,r,i,a;if(n=e!=null&&e[zn])return n;if(!Wn(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let n=0,a=e.length;n<a;n++)i=e[n],(r=Gn(i,t))!==i&&(e[n]=r)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);let n=Object.keys(e),o=Object.getOwnPropertyDescriptors(e);for(let s=0,c=n.length;s<c;s++)a=n[s],!o[a].get&&(i=e[a],(r=Gn(i,t))!==i&&(e[a]=r))}return e}function Kn(e,t){let n=e[t];return n||Object.defineProperty(e,t,{value:n=Object.create(null)}),n}function qn(e,t,n){if(e[t])return e[t];let[r,i]=w(n,{equals:!1,internal:!0});return r.$=i,e[t]=r}function Jn(e,t){let n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===s||t===Bn?n:(delete n.value,delete n.writable,n.get=()=>e[s][t],n)}function Yn(e){de()&&qn(Kn(e,Bn),Hn)()}function Xn(e){return Yn(e),Reflect.ownKeys(e)}var Zn={get(e,t,n){if(t===zn)return e;if(t===s)return n;if(t===l)return Yn(e),n;let r=Kn(e,Bn),i=r[t],a=i?i():e[t];if(t===Bn||t===Vn||t===`__proto__`)return a;if(!i){let n=Object.getOwnPropertyDescriptor(e,t);de()&&(typeof a!=`function`||e.hasOwnProperty(t))&&!(n&&n.get)&&(a=qn(r,t,a)())}return Wn(a)?Un(a):a},has(e,t){return t===zn||t===s||t===l||t===Bn||t===Vn||t===`__proto__`?!0:(de()&&qn(Kn(e,Vn),t)(),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:Xn,getOwnPropertyDescriptor:Jn};function P(e,t,n,r=!1){if(!r&&e[t]===n)return;let i=e[t],a=e.length;n===void 0?(delete e[t],e[Vn]&&e[Vn][t]&&i!==void 0&&e[Vn][t].$()):(e[t]=n,e[Vn]&&e[Vn][t]&&i===void 0&&e[Vn][t].$());let o=Kn(e,Bn),s;if((s=qn(o,t,i))&&s.$(()=>n),Array.isArray(e)&&e.length!==a){for(let t=e.length;t<a;t++)(s=o[t])&&s.$();(s=qn(o,`length`,a))&&s.$(e.length)}(s=o[Hn])&&s.$()}function Qn(e,t){let n=Object.keys(t);for(let r=0;r<n.length;r+=1){let i=n[r];P(e,i,t[i])}}function $n(e,t){if(typeof t==`function`&&(t=t(e)),t=Gn(t),Array.isArray(t)){if(e===t)return;let n=0,r=t.length;for(;n<r;n++){let r=t[n];e[n]!==r&&P(e,n,r)}P(e,`length`,r)}else Qn(e,t)}function er(e,t,n=[]){let r,i=e;if(t.length>1){r=t.shift();let a=typeof r,o=Array.isArray(e);if(Array.isArray(r)){for(let i=0;i<r.length;i++)er(e,[r[i]].concat(t),n);return}else if(o&&a===`function`){for(let i=0;i<e.length;i++)r(e[i],i)&&er(e,[i].concat(t),n);return}else if(o&&a===`object`){let{from:i=0,to:a=e.length-1,by:o=1}=r;for(let r=i;r<=a;r+=o)er(e,[r].concat(t),n);return}else if(t.length>1){er(e[r],t,[r].concat(n));return}i=e[r],n=[r].concat(n)}let a=t[0];typeof a==`function`&&(a=a(i,n),a===i)||r===void 0&&a==null||(a=Gn(a),r===void 0||Wn(i)&&Wn(a)&&!Array.isArray(a)?Qn(i,a):P(e,r,a))}function tr(...[e,t]){let n=Gn(e||{}),r=Array.isArray(n),i=Un(n);function a(...e){oe(()=>{r&&e.length===1?$n(n,e[0]):er(n,e)})}return[i,a]}var nr=Symbol(`store-root`);function rr(e,t,n,r,i){let a=t[n];if(e===a)return;let o=Array.isArray(e);if(n!==nr&&(!Wn(e)||!Wn(a)||o!==Array.isArray(a)||i&&e[i]!==a[i])){P(t,n,e);return}if(o){if(e.length&&a.length&&(!r||i&&e[0]&&e[0][i]!=null)){let t,n,o,s,c,l,u,d;for(o=0,s=Math.min(a.length,e.length);o<s&&(a[o]===e[o]||i&&a[o]&&e[o]&&a[o][i]&&a[o][i]===e[o][i]);o++)rr(e[o],a,o,r,i);let f=Array(e.length),p=new Map;for(s=a.length-1,c=e.length-1;s>=o&&c>=o&&(a[s]===e[c]||i&&a[s]&&e[c]&&a[s][i]&&a[s][i]===e[c][i]);s--,c--)f[c]=a[s];if(o>c||o>s){for(n=o;n<=c;n++)P(a,n,e[n]);for(;n<e.length;n++)P(a,n,f[n]),rr(e[n],a,n,r,i);a.length>e.length&&P(a,`length`,e.length);return}for(u=Array(c+1),n=c;n>=o;n--)l=e[n],d=i&&l?l[i]:l,t=p.get(d),u[n]=t===void 0?-1:t,p.set(d,n);for(t=o;t<=s;t++)l=a[t],d=i&&l?l[i]:l,n=p.get(d),n!==void 0&&n!==-1&&(f[n]=a[t],n=u[n],p.set(d,n));for(n=o;n<e.length;n++)n in f?(P(a,n,f[n]),rr(e[n],a,n,r,i)):P(a,n,e[n])}else for(let t=0,n=e.length;t<n;t++)rr(e[t],a,t,r,i);a.length>e.length&&P(a,`length`,e.length);return}let s=Object.keys(e);for(let t=0,n=s.length;t<n;t++)rr(e[s[t]],a,s[t],r,i);let c=Object.keys(a);for(let t=0,n=c.length;t<n;t++)e[c[t]]===void 0&&P(a,c[t],void 0)}function ir(e,t={}){let{merge:n,key:r=`id`}=t,i=Gn(e);return e=>{if(!Wn(e)||!Wn(i))return i;let t=rr(i,{[nr]:e},nr,n,r);return t===void 0?e:t}}function ar(e,t){let n,r=()=>!n||n.state===`unresolved`?void 0:n.latest;[n]=ie(()=>sr(e,ue(()=>O(r),()=>void 0)),e=>e,t);let i=(()=>n());return Object.defineProperty(i,`latest`,{get(){return n.latest}}),i}var or=class e{static all(){return new e}static allSettled(){return new e}static any(){return new e}static race(){return new e}static reject(){return new e}static resolve(){return new e}catch(){return new e}then(){return new e}finally(){return new e}};function sr(e,t){if(!n.context)return e(t);let r=fetch,i=Promise;try{return window.fetch=()=>new or,Promise=or,e(t)}finally{window.fetch=r,Promise=i}}function cr(e){return Math.hypot(e.x,e.y)}function lr(e,t){return cr(fr(e,t))}function ur(e=0,t=0){return{x:e,y:t}}function dr(e,t){return{x:e.x+t.x,y:e.y+t.y}}function fr(e,t){return{x:e.x-t.x,y:e.y-t.y}}function pr(e,t){return{x:e.x*t,y:e.y*t}}var mr={duration:.2,easing:e=>e},hr={stiffness:150,damping:18},gr={speed:1},_r={amplitude:0,frequency:3,bias:0},F=class{value;velocity=0;baseValue=0;mode=`hold`;time=0;timeInMode=0;tweenStart=0;tweenTarget=0;tweenConfig=mr;springTarget=0;springConfig=hr;followTarget=0;followConfig=gr;swayEnabled=!1;swayConfig={..._r};lastSwayValue=0;swayFade=0;constructor(e=0){this.baseValue=e,this.value=this.baseValue}hold(){return this.mode=`hold`,this.timeInMode=0,this.velocity=0,this}tweenTo(e,t){return this.mode=`tween`,this.tweenConfig={...mr,...t},this.tweenStart=this.value,this.tweenTarget=e,this.timeInMode=0,this}springTo(e,t){return this.mode=`spring`,this.springConfig={...hr,...t},this.springTarget=e,this.timeInMode=0,this}followTo(e,t){return this.mode=`follow`,this.followConfig={...gr,...t},this.followTarget=e,this}swayTo(e){return this.swayConfig={...this.swayConfig,...e},this.swayEnabled=!0,this}disableSway(){return this.swayEnabled=!1,this}update(e){switch(this.time+=e,this.timeInMode+=e,this.mode){case`hold`:break;case`tween`:{let e=Math.min(this.timeInMode/this.tweenConfig.duration,1),t=this.tweenConfig.easing(e);this.baseValue=this.tweenStart+(this.tweenTarget-this.tweenStart)*t;break}case`spring`:{let{stiffness:t,damping:n}=this.springConfig,r=-t*(this.baseValue-this.springTarget)-n*this.velocity;this.velocity+=r*e,this.baseValue+=this.velocity*e;break}case`follow`:{let{speed:t}=this.followConfig,n=1-(1-t)**e;this.baseValue+=(this.followTarget-this.baseValue)*n;break}}if(this.swayEnabled&&this.swayConfig){this.swayFade=Math.min(this.swayFade+e*8,1);let t=(Math.sin(this.time*this.swayConfig.frequency+0)*this.swayConfig.amplitude+this.swayConfig.bias-this.lastSwayValue)*this.swayFade;this.baseValue+=t,this.lastSwayValue+=t}else this.swayFade=0;this.value=this.baseValue}},vr=class e{renderer;static INSTANCE_STRIDE=15;maxInstances;buffer;cursor=0;constructor(t,n=8192){this.renderer=t,this.maxInstances=n,this.buffer=new Float32Array(n*e.INSTANCE_STRIDE)}beginFrame(){this.cursor=0}endFrame(){this.flush()}pushMask(){this.flush(),this.renderer.pushMask()}popMask(){this.flush(),this.renderer.popMask()}endMask(){this.flush(),this.renderer.endMask()}ensureCapacity(e){if(this.cursor+e>this.maxInstances&&(this.flush(),e>this.maxInstances))throw Error(`Requested instance count exceeds maxInstances`)}pushInstance(t){let n=this.cursor*e.INSTANCE_STRIDE;for(let r=0;r<e.INSTANCE_STRIDE;r++)this.buffer[n+r]=t[r]??0;this.cursor++}fillRect(e,t,n,r,i,a=0){this.ensureCapacity(1),this.pushInstance([e,t,n,r,a,i.r,i.g,i.b,i.a,0,0,0,0,0,0])}fillRoundRect(e,t,n,r,i,a,o=0){this.ensureCapacity(1),this.pushInstance([e,t,n,r,o,a.r,a.g,a.b,a.a,1,i,0,0,0,0])}strokeRoundRect(e,t,n,r,i,a,o,s=[0,0],c=0){this.ensureCapacity(1),this.pushInstance([e,t,n+a,r+a,c,o.r,o.g,o.b,o.a,1,i,a,s[0],s[1],0])}strokeRect(e,t,n,r,i,a,o=[0,0],s=0){this.ensureCapacity(1),this.pushInstance([e,t,n+i,r+i,s,a.r,a.g,a.b,a.a,0,0,i,o[0],o[1],0])}fillCircle(e,t,n,r,i=[0,0]){this.ensureCapacity(1);let a=n*2,o=n*2;this.pushInstance([e,t,a,o,0,r.r,r.g,r.b,r.a,3,n,0,i[0],i[1],0])}strokeCircle(e,t,n,r,i,a=[0,0]){this.ensureCapacity(1);let o=n*2,s=n*2;this.pushInstance([e,t,o+r*2,s+r*2,0,i.r,i.g,i.b,i.a,3,n,r,a[0],a[1],0])}strokeLine(e,t,n,r,i,a,o=[0,0]){this.ensureCapacity(1);let s=n-e,c=r-t,l=Math.hypot(s,c),u=Math.atan2(c,s),d=l+i+8,f=i+8,p=(e+n)*.5,m=(t+r)*.5,h=i*.5;this.pushInstance([p,m,d,f,u,a.r,a.g,a.b,a.a,2,h,0,o[0],o[1],l])}flush(){if(this.cursor===0)return;let t=this.cursor*e.INSTANCE_STRIDE,n=this.buffer.subarray(0,t);this.renderer.instanceData.length>=t?this.renderer.instanceData.set(n,0):this.renderer.instanceData=new Float32Array(n),this.renderer.instanceCount=this.cursor,this.renderer.flush(),this.cursor=0}};function yr(e,t,n,r){let i=new Float32Array(16);return i[0]=2/(t-e),i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2/(r-n),i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=-1,i[11]=0,i[12]=-(t+e)/(t-e),i[13]=-(r+n)/(r-n),i[14]=0,i[15]=1,i}yr(0,1920,1080,0);var br=class{gl;program;vao;quadVBO;instanceVBO;maxInstances;instanceStride;instanceData;instanceCount=0;uProjectionMatrix;maskDepth=0;projectionMatrix;constructor(e,t,n,r=1e4){let i=n.getContext(`webgl2`,{antialias:!0,stencil:!0});if(!i)throw Error(`WebGL2 not supported`);this.gl=i,this.projectionMatrix=yr(0,e,t,0),this.maxInstances=r,this.quadVBO=i.createBuffer(),this.instanceVBO=i.createBuffer(),this.program=this.createProgram(`#version 300 es
precision highp float;

layout(location = 0) in vec2 a_pos;            // quad vertex (0-1 space)
layout(location = 1) in vec2 a_translation;    // world position
layout(location = 2) in vec2 a_size;           // width, height
layout(location = 3) in float a_rotation;      // radians
layout(location = 4) in vec4 a_color;          // RGBA
layout(location = 5) in float a_type;          // shape type
layout(location = 6) in float a_radius;        // roundRect radius or line thickness*0.5
layout(location = 7) in float a_stroke;        // stroke width (0 = fill)
layout(location = 8) in vec2 a_dash;           // (dashLength, gapLength)
layout(location = 9) in float a_length;        // shape length for lines (distance between AB)

out vec2 v_local;
out vec2 v_size;
out vec4 v_color;
out float v_type;
out float v_radius;
out float v_stroke;
out vec2 v_dash;
out float v_length;

uniform mat4 u_projection; // 1920x1080 Orto Matrix

void main() {
    // Convert quad coordinates (0..1) to local space (-0.5..0.5)
    vec2 local = (a_pos - 0.5) * a_size;
    v_local = local;
    v_size = a_size;

    // Pass instance data to fragment shader
    v_color = a_color;
    v_type = a_type;
    v_radius = a_radius;
    v_stroke = a_stroke;
    v_dash = a_dash;
    v_length = a_length;

    // Rotation
    float s = sin(a_rotation);
    float c = cos(a_rotation);
    vec2 rotated = vec2(
        local.x * c - local.y * s,
        local.x * s + local.y * c
    );

    // Final world position
    vec2 world = rotated + a_translation;

    // convert pixel pos to NDC
    //vec2 ndc = (world / u_resolution) * 2.0 - 1.0;
    vec4 ndc = u_projection * vec4(world, 0.0, 1.0);
    //gl_Position = vec4(ndc * vec2(1, -1), 0.0, 1.0);
    gl_Position = ndc;
}`,`#version 300 es
precision highp float;

in vec2 v_local;
in vec2 v_size;
in vec4 v_color;
in float v_type;
in float v_radius;
in float v_stroke;
in vec2 v_dash;
in float v_length;

out vec4 fragColor;

// ************** SDF UTILITIES ************** //

float sdRect(vec2 p, vec2 b) {
    vec2 d = abs(p) - b;
    return max(d.x, d.y);
}

float sdRoundRect(vec2 p, vec2 b, float r) {
    vec2 d = abs(p) - b + vec2(r);
    return length(max(d, 0.0)) - r;
}

float sdCapsule(vec2 p, float len, float r) {
    // Capsule along +X axis centered at origin
    vec2 a = vec2(-len * 0.5, 0.0);
    vec2 b = vec2( len * 0.5, 0.0);
    vec2 pa = p - a;
    vec2 ba = b - a;
    float h = clamp(dot(pa, ba) / dot(ba, ba), 0.0, 1.0);
    return length(pa - ba * h) - r;
}

float sdCircle(vec2 p, float r) {
    return length(p) - r;
}

float applyDash(float distAlongLine, float dash, float gap) {
    float total = dash + gap;
    float m = mod(distAlongLine, total);
    return (m < dash) ? 1.0 : 0.0;
}


void main() {

    // Normalize local coords to center
    vec2 p = v_local;

    float d = 0.0;

    //--------------------------------------------------
    // RECTANGLE
    //--------------------------------------------------
    if (v_type == 0.0) {
        d = sdRect(p, v_size * 0.5);
    }

    //--------------------------------------------------
    // ROUND RECTANGLE
    //--------------------------------------------------
    if (v_type == 1.0) {
        d = sdRoundRect(p, v_size * 0.5 - vec2(v_radius), v_radius);
    }

    //--------------------------------------------------
    // CAPSULE LINE (round caps)
    //--------------------------------------------------
    if (v_type == 2.0) {
        // line thickness = v_radius*2
        d = sdCapsule(p, v_length, v_radius);
    }

    if (v_type == 3.0) {
        d = sdCircle(p, v_radius);
    }

    //--------------------------------------------------
    // STROKE / FILL HANDLING
    //--------------------------------------------------
    float alpha = 0.0;

    if (v_stroke == 0.0) {
        // FILL SHAPE
        float edge = fwidth(d) * 1.2;
        edge = max(edge, 1.0);
        alpha = 1.0 - smoothstep(0.0, edge, d);
    } else {
        // STROKE SHAPE
        float halfStroke = v_stroke * 0.5;
        float distToStroke = abs(d) - halfStroke;
    
        float edge = fwidth(distToStroke) * 1.2;
        edge = max(edge, 1.0);
        alpha = 1.0 - smoothstep(0.0, edge, distToStroke);
    
        //--------------------------------------------------
        // DASHING (ANTI-ALIASED, STABLE)
        //--------------------------------------------------
        if (v_dash.x > 0.0 && alpha > 0.0) {
    
            // ---------------------------------------------
            // Arc-length approximation
            // ---------------------------------------------
            float s;
    
            if (v_type == 2.0) {
                // line / rect-like shapes: project along x
                s = p.x + v_length * 0.5;
            } else {
                // fallback: radial distance (better than Manhattan)
                s = length(p);
            }
    
            // ---------------------------------------------
            // Dash pattern
            // ---------------------------------------------
            float period = v_dash.x + v_dash.y;
            float phase  = mod(s, period);
    
            // derivative-aware AA for dash edges
            float dashEdge = fwidth(s);
    
            float dashMask =
                1.0 - smoothstep(
                    v_dash.x - dashEdge,
                    v_dash.x + dashEdge,
                    phase
                );
    
            alpha *= dashMask;
        }
    }

    float a= v_color.a * alpha;
    fragColor = vec4(v_color.rgb * a, a);
}`),this.uProjectionMatrix=i.getUniformLocation(this.program,`u_projection`),this.instanceStride=15,this.instanceData=new Float32Array(this.maxInstances*this.instanceStride),this.vao=this.createVAO(),i.enable(i.BLEND),i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA)}set_viewport(e,t){this.gl.viewport(0,0,e,t)}pushMask(){let e=this.gl;e.enable(e.STENCIL_TEST),e.colorMask(!1,!1,!1,!1),e.stencilFunc(e.ALWAYS,this.maskDepth+1,255),e.stencilOp(e.KEEP,e.KEEP,e.REPLACE)}endMask(){let e=this.gl;e.colorMask(!0,!0,!0,!0),this.maskDepth++,e.stencilFunc(e.EQUAL,this.maskDepth,255),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}popMask(){this.maskDepth--;let e=this.gl;this.maskDepth>0?e.stencilFunc(e.EQUAL,this.maskDepth,255):e.disable(e.STENCIL_TEST)}createVAO(){let e=this.gl,t=e.createVertexArray();e.bindVertexArray(t);let n=new Float32Array([0,0,1,0,0,1,1,1]);return e.bindBuffer(e.ARRAY_BUFFER,this.quadVBO),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,2,e.FLOAT,!1,8,0),e.vertexAttribDivisor(0,0),e.bindBuffer(e.ARRAY_BUFFER,this.instanceVBO),e.bufferData(e.ARRAY_BUFFER,this.instanceData.byteLength,e.DYNAMIC_DRAW),t}setupInstancing(){let e=this.gl;e.bindVertexArray(this.vao),e.bindBuffer(e.ARRAY_BUFFER,this.instanceVBO);let t=this.instanceStride*4,n=0,r=1,i=i=>{e.enableVertexAttribArray(r),e.vertexAttribPointer(r,i,e.FLOAT,!1,t,n),e.vertexAttribDivisor(r,1),n+=i*4,r++};i(2),i(2),i(1),i(4),i(1),i(1),i(1),i(2),i(1)}addInstance(e){let t=this.instanceCount*this.instanceStride;this.instanceData.set(e,t),this.instanceCount++,this.instanceCount>=this.maxInstances&&console.warn(`Instance buffer full`)}flush(){let e=this.gl;this.instanceCount!==0&&(e.useProgram(this.program),e.bindVertexArray(this.vao),e.uniformMatrix4fv(this.uProjectionMatrix,!1,this.projectionMatrix),e.bindBuffer(e.ARRAY_BUFFER,this.instanceVBO),e.bufferSubData(e.ARRAY_BUFFER,0,this.instanceData.subarray(0,this.instanceCount*this.instanceStride)),e.drawArraysInstanced(e.TRIANGLE_STRIP,0,4,this.instanceCount),this.instanceCount=0)}createProgram(e,t){let n=this.gl,r=n.createShader(n.VERTEX_SHADER);if(n.shaderSource(r,e),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS))throw Error(n.getShaderInfoLog(r));let i=n.createShader(n.FRAGMENT_SHADER);if(n.shaderSource(i,t),n.compileShader(i),!n.getShaderParameter(i,n.COMPILE_STATUS))throw Error(n.getShaderInfoLog(i));let a=n.createProgram();if(n.attachShader(a,r),n.attachShader(a,i),n.linkProgram(a),!n.getProgramParameter(a,n.LINK_STATUS))throw Error(n.getProgramInfoLog(a));return n.deleteShader(r),n.deleteShader(i),a}cleanup(){let e=this.gl;e.bindVertexArray(null),this.vao&&e.deleteVertexArray(this.vao),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.quadVBO&&e.deleteBuffer(this.quadVBO),this.instanceVBO&&e.deleteBuffer(this.instanceVBO),this.program&&(e.useProgram(null),e.deleteProgram(this.program)),e.bindTexture(e.TEXTURE_2D,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null)}};function xr(e,t,n,r){let i=document.createElement(`canvas`);i.classList.add(`twisterjs-responsive-full`);let a=()=>{let e=window.devicePixelRatio||1,t=n.getBoundingClientRect(),a=Math.floor(t.width*e),s=Math.floor(t.height*e);(i.width!==a||i.height!==s)&&(i.width=a,i.height=s,o.set_viewport(i.width,i.height),r())},o=new br(e,t,i,32768);o.setupInstancing();let s=new vr(o,16384),c=new ResizeObserver(()=>{a()});return c.observe(n),n.appendChild(i),{canvas:i,batch:s,cleanup(){o.cleanup(),c.unobserve(n)}}}var I=class e{r;g;b;a;constructor(e,t,n,r){this.r=e,this.g=t,this.b=n,this.a=r}static fromRgba255(t,n,r,i=255){return new e(t/255,n/255,r/255,i/255)}static fromHex(t){return e.fromRgba255((t&16711680)>>16,(t&65280)>>8,t&255,255)}static fromHexString(t){let n=t.startsWith(`#`)?t.slice(1):t;n=n.startsWith(`0x`)?n.slice(2):n,n.length===3&&(n=n.split(``).map(e=>e+e).join(``));let r=parseInt(n,16);return isNaN(r)?(console.error(`Invalid color hex string: ${t}`),null):n.length===6?e.fromRgba255(r>>16&255,r>>8&255,r&255,255):n.length===8?e.fromRgba255(r>>24&255,r>>16&255,r>>8&255,r&255):(console.error(`Unsupported hex string length: ${t}`),null)}static white=e.fromRgba255(255,255,255,255);static black=e.fromRgba255(0,0,0,255);static red=e.fromRgba255(255,0,0,255);static lerp(t,n,r){return r=Math.max(0,Math.min(1,r)),new e(t.r+(n.r-t.r)*r,t.g+(n.g-t.g)*r,t.b+(n.b-t.b)*r,t.a+(n.a-t.a)*r)}get rgb24(){let e=Math.round(this.r*255),t=Math.round(this.g*255),n=Math.round(this.b*255);return e<<16|t<<8|n}get rgbaNormalized(){return{r:this.r,g:this.g,b:this.b,a:this.a}}get rgba255(){return{r:Math.round(this.r*255),g:Math.round(this.g*255),b:Math.round(this.b*255),a:Math.round(this.a*255)}}};function Sr(e,t,n){let r=!0,i,a=1e3/60,o=performance.now(),s=0;function c(l){if(!r)return;i=requestAnimationFrame(c);let u=Math.min(l-o,25);for(o=l,s+=u;s>=a;)e(a),s-=a;t(s/a),n?.()}return i=requestAnimationFrame(c),()=>{r=!1,cancelAnimationFrame(i)}}function Cr(e,t){let n=e.getBoundingClientRect(),r=e=>[e.clientX,e.clientY],i=e=>{let[t,i]=r(e);return[(t-n.left)/(n.width+1),(i-n.top)/(n.height+1)]};function a(n){e.setPointerCapture(n.pointerId),t.on_down(i(n))}function o(n){try{e.releasePointerCapture(n.pointerId)}catch{}t.on_up(i(n))}function s(e){t.on_move(i(e))}function c(){n=e.getBoundingClientRect()}e.addEventListener(`pointerdown`,a),e.addEventListener(`pointermove`,s),document.addEventListener(`pointerup`,o);let l=new ResizeObserver(()=>c());return l.observe(e),document.addEventListener(`scroll`,c,{passive:!0,capture:!0}),window.addEventListener(`resize`,c,{passive:!0}),()=>{e.removeEventListener(`pointerdown`,a),e.removeEventListener(`pointermove`,s),document.removeEventListener(`pointerup`,o),l.disconnect(),document.removeEventListener(`scroll`,c),window.removeEventListener(`resize`,c)}}function wr(e,t,n){let r=[500,500],i,a,o,s,c=!1,l=0;function u(n){return[n[0]*e,n[1]*t]}let d=Cr(n,{on_down(e){e=u(e),a=void 0,i=e,o=e,r=e,c=!1},on_up(e){e=u(e),i=void 0,a=e},on_move(e){if(e=u(e),r=e,i){let t=i[0]-e[0],n=i[1]-e[1];t*t+n*n>64&&(c=!0)}}});return{get is_hovering(){return r},get is_down(){return i},get is_up(){return a},get is_just_down(){return o},get is_double_click(){return s},get has_moved_after_last_down(){return c},update(e){s=void 0,o&&l>0&&(s=o,l=0),l-=e,o=void 0,a=void 0},cleanup(){d()}}}const L={black:`#000000`,darkblue:`#1D2B53`,darkred:`#7E2553`,darkgreen:`#008751`,brown:`#AB5236`,gray:`#5F574F`,lightgray:`#C2C3C7`,white:`#FFF1E8`,red:`#FF004D`,orange:`#FFA300`,yellow:`#FFEC27`,green:`#00E436`,blue:`#29ADFF`,purple:`#83769C`,pink:`#FF77A8`,sand:`#FFCCAA`},Tr={white:`#fbf8fd`,light:`#a1a9d1`,blue:`#007fff`,darkblue:`#24256f`,black:`#141218`,purple:`#5f0e52`,red:`#fd1a43`,pink:`#ffb16c`,yellow:`#fede5b`,green:`#74ead6`},R={sand1:`#fff2b9`,sand2:`#ffda80`,sand3:`#feb746`,sand4:`#d16318`,sand5:`#89240d`,orange1:`#fe9f5d`,orange2:`#fd6c09`,orange3:`#db4422`,red1:`#fe6a7d`,red2:`#f01e5b`,red3:`#930d3d`,red4:`#5b0d27`,purple1:`#e8acfd`,purple2:`#c453d4`,purple3:`#8e2082`,purple4:`#640e55`,blue1:`#56dfcf`,blue2:`#35c0c6`,blue3:`#1c6e82`,blue4:`#16416e`,green1:`#8beec0`,green2:`#38be97`,green3:`#228f66`,green4:`#126144`,green5:`#083523`,lime1:`#e2d753`,lime2:`#b3a71c`,lime3:`#777211`,mor1:`#b29ca6`,mor2:`#795670`,mor3:`#4e2140`,mor4:`#290e0f`},z={black:I.fromHexString(L.black),darkblue:I.fromHexString(L.darkblue),darkred:I.fromHexString(L.darkred),darkgreen:I.fromHexString(L.darkgreen),brown:I.fromHexString(L.brown),gray:I.fromHexString(L.gray),lightgray:I.fromHexString(L.lightgray),white:I.fromHexString(L.white),red:I.fromHexString(L.red),orange:I.fromHexString(L.orange),yellow:I.fromHexString(L.yellow),green:I.fromHexString(L.green),blue:I.fromHexString(L.blue),purple:I.fromHexString(L.purple),pink:I.fromHexString(L.pink),sand:I.fromHexString(L.sand)},Er={white:I.fromHexString(Tr.white),light:I.fromHexString(Tr.light),blue:I.fromHexString(Tr.blue),darkblue:I.fromHexString(Tr.darkblue),black:I.fromHexString(Tr.black),purple:I.fromHexString(Tr.purple),red:I.fromHexString(Tr.red),pink:I.fromHexString(Tr.pink),yellow:I.fromHexString(Tr.yellow),green:I.fromHexString(Tr.green)};I.fromHexString(R.sand1),I.fromHexString(R.sand2),I.fromHexString(R.sand3),I.fromHexString(R.sand4),I.fromHexString(R.sand5),I.fromHexString(R.orange1),I.fromHexString(R.orange2),I.fromHexString(R.orange3),I.fromHexString(R.red1),I.fromHexString(R.red2),I.fromHexString(R.red3),I.fromHexString(R.red4),I.fromHexString(R.purple1),I.fromHexString(R.purple2),I.fromHexString(R.purple3),I.fromHexString(R.purple4),I.fromHexString(R.blue1),I.fromHexString(R.blue2),I.fromHexString(R.blue3),I.fromHexString(R.blue4),I.fromHexString(R.green1),I.fromHexString(R.green2),I.fromHexString(R.green3),I.fromHexString(R.green4),I.fromHexString(R.green5),I.fromHexString(R.lime1),I.fromHexString(R.lime2),I.fromHexString(R.lime3),I.fromHexString(R.mor1),I.fromHexString(R.mor2),I.fromHexString(R.mor3),I.fromHexString(R.mor4);function Dr(e){let t={on_new_renderFn:e=>{o(e)},on_destroy:()=>{a&&=(e.removeChild(a.canvas),a.cleanup(),void 0),n=!0}},n=!1,r,i=!1,a,o=async t=>{if(r=t,i)return;a&&=(e.removeChild(a.canvas),a.cleanup(),void 0),i=!0;let s=r;if(a=await s(e),n){a.cleanup(),a=void 0;return}i=!1,r!==s&&o(r)};return t}const Or=[`a`,`b`,`c`,`d`,`e`,`f`,`g`,`h`],kr=[`1`,`2`,`3`,`4`,`5`,`6`,`7`,`8`],Ar=[`white`,`black`],B=[`pawn`,`knight`,`bishop`,`rook`,`queen`,`king`],jr=[`a`,`h`],V=e=>e!==void 0,H=e=>e===`white`?`black`:`white`,Mr=e=>e>>3,U=e=>e&7,Nr=(e,t)=>0<=e&&e<8&&0<=t&&t<8?e+8*t:void 0,Pr=e=>{switch(e){case`pawn`:return`p`;case`knight`:return`n`;case`bishop`:return`b`;case`rook`:return`r`;case`queen`:return`q`;case`king`:return`k`}};function Fr(e){switch(e.toLowerCase()){case`p`:return`pawn`;case`n`:return`knight`;case`b`:return`bishop`;case`r`:return`rook`;case`q`:return`queen`;case`k`:return`king`;default:return}}function Ir(e){if(e.length===2)return Nr(e.charCodeAt(0)-97,e.charCodeAt(1)-49)}const Lr=e=>Or[U(e)]+kr[Mr(e)],Rr=(e,t)=>e===`white`?t===`a`?2:6:t===`a`?58:62,zr=(e,t)=>e===`white`?t===`a`?3:5:t===`a`?59:61,Br=[`a`,`b`,`c`,`d`,`e`,`f`,`g`,`h`],Vr=[`1`,`2`,`3`,`4`,`5`,`6`,`7`,`8`],Hr=[`white`,`black`],Ur=[`pawn`,`knight`,`bishop`,`rook`,`queen`,`king`],Wr=[`a`,`h`],Gr=e=>`role`in e,W=e=>e!==void 0,G=e=>e===`white`?`black`:`white`,Kr=e=>e>>3,qr=e=>e&7,Jr=e=>{switch(e){case`pawn`:return`p`;case`knight`:return`n`;case`bishop`:return`b`;case`rook`:return`r`;case`queen`:return`q`;case`king`:return`k`}},Yr=e=>Br[qr(e)]+Vr[Kr(e)],Xr=(e,t)=>e===`white`?t===`a`?2:6:t===`a`?58:62,Zr=(e,t)=>e===`white`?t===`a`?3:5:t===`a`?59:61;var Qr=e=>(e-=e>>>1&1431655765,e=(e&858993459)+(e>>>2&858993459),Math.imul(e+(e>>>4)&252645135,16843009)>>24),$r=e=>(e=e>>>8&16711935|(e&16711935)<<8,e>>>16&65535|(e&65535)<<16),ei=e=>(e=e>>>1&1431655765|(e&1431655765)<<1,e=e>>>2&858993459|(e&858993459)<<2,e=e>>>4&252645135|(e&252645135)<<4,$r(e)),K=class e{constructor(e,t){this.lo=e|0,this.hi=t|0}static fromSquare(t){return t>=32?new e(0,1<<t-32):new e(1<<t,0)}static fromRank(t){return new e(255,0).shl64(8*t)}static fromFile(t){return new e(16843009<<t,16843009<<t)}static empty(){return new e(0,0)}static full(){return new e(4294967295,4294967295)}static corners(){return new e(129,2164260864)}static center(){return new e(402653184,24)}static backranks(){return new e(255,4278190080)}static backrank(t){return t===`white`?new e(255,0):new e(0,4278190080)}static lightSquares(){return new e(1437226410,1437226410)}static darkSquares(){return new e(2857740885,2857740885)}complement(){return new e(~this.lo,~this.hi)}xor(t){return new e(this.lo^t.lo,this.hi^t.hi)}union(t){return new e(this.lo|t.lo,this.hi|t.hi)}intersect(t){return new e(this.lo&t.lo,this.hi&t.hi)}diff(t){return new e(this.lo&~t.lo,this.hi&~t.hi)}intersects(e){return this.intersect(e).nonEmpty()}isDisjoint(e){return this.intersect(e).isEmpty()}supersetOf(e){return e.diff(this).isEmpty()}subsetOf(e){return this.diff(e).isEmpty()}shr64(t){return t>=64?e.empty():t>=32?new e(this.hi>>>t-32,0):t>0?new e(this.lo>>>t^this.hi<<32-t,this.hi>>>t):this}shl64(t){return t>=64?e.empty():t>=32?new e(0,this.lo<<t-32):t>0?new e(this.lo<<t,this.hi<<t^this.lo>>>32-t):this}bswap64(){return new e($r(this.hi),$r(this.lo))}rbit64(){return new e(ei(this.hi),ei(this.lo))}minus64(t){let n=this.lo-t.lo,r=(n&t.lo&1)+(t.lo>>>1)+(n>>>1)>>>31;return new e(n,this.hi-(t.hi+r))}equals(e){return this.lo===e.lo&&this.hi===e.hi}size(){return Qr(this.lo)+Qr(this.hi)}isEmpty(){return this.lo===0&&this.hi===0}nonEmpty(){return this.lo!==0||this.hi!==0}has(e){return(e>=32?this.hi&1<<e-32:this.lo&1<<e)!=0}set(e,t){return t?this.with(e):this.without(e)}with(t){return t>=32?new e(this.lo,this.hi|1<<t-32):new e(this.lo|1<<t,this.hi)}without(t){return t>=32?new e(this.lo,this.hi&~(1<<t-32)):new e(this.lo&~(1<<t),this.hi)}toggle(t){return t>=32?new e(this.lo,this.hi^1<<t-32):new e(this.lo^1<<t,this.hi)}last(){if(this.hi!==0)return 63-Math.clz32(this.hi);if(this.lo!==0)return 31-Math.clz32(this.lo)}first(){if(this.lo!==0)return 31-Math.clz32(this.lo&-this.lo);if(this.hi!==0)return 63-Math.clz32(this.hi&-this.hi)}withoutFirst(){return this.lo===0?new e(0,this.hi&this.hi-1):new e(this.lo&this.lo-1,this.hi)}moreThanOne(){return this.hi!==0&&this.lo!==0||(this.lo&this.lo-1)!=0||(this.hi&this.hi-1)!=0}singleSquare(){return this.moreThanOne()?void 0:this.last()}*[Symbol.iterator](){let e=this.lo,t=this.hi;for(;e!==0;){let t=31-Math.clz32(e&-e);e^=1<<t,yield t}for(;t!==0;){let e=31-Math.clz32(t&-t);t^=1<<e,yield 32+e}}*reversed(){let e=this.lo,t=this.hi;for(;t!==0;){let e=31-Math.clz32(t);t^=1<<e,yield 32+e}for(;e!==0;){let t=31-Math.clz32(e);e^=1<<t,yield t}}},ti=(e,t)=>{let n=K.empty();for(let r of t){let t=e+r;0<=t&&t<64&&Math.abs(qr(e)-qr(t))<=2&&(n=n.with(t))}return n},ni=e=>{let t=[];for(let n=0;n<64;n++)t[n]=e(n);return t},ri=ni(e=>ti(e,[-9,-8,-7,-1,1,7,8,9])),ii=ni(e=>ti(e,[-17,-15,-10,-6,6,10,15,17])),ai={white:ni(e=>ti(e,[7,9])),black:ni(e=>ti(e,[-7,-9]))};const oi=e=>ri[e],si=e=>ii[e],ci=(e,t)=>ai[e][t];var li=ni(e=>K.fromFile(qr(e)).without(e)),ui=ni(e=>K.fromRank(Kr(e)).without(e)),di=ni(e=>{let t=new K(134480385,2151686160),n=8*(Kr(e)-qr(e));return(n>=0?t.shl64(n):t.shr64(-n)).without(e)}),fi=ni(e=>{let t=new K(270549120,16909320),n=8*(Kr(e)+qr(e)-7);return(n>=0?t.shl64(n):t.shr64(-n)).without(e)}),pi=(e,t,n)=>{let r=n.intersect(t),i=r.bswap64();return r=r.minus64(e),i=i.minus64(e.bswap64()),r.xor(i.bswap64()).intersect(t)},mi=(e,t)=>pi(K.fromSquare(e),li[e],t),hi=(e,t)=>{let n=ui[e],r=t.intersect(n),i=r.rbit64();return r=r.minus64(K.fromSquare(e)),i=i.minus64(K.fromSquare(63-e)),r.xor(i.rbit64()).intersect(n)};const gi=(e,t)=>{let n=K.fromSquare(e);return pi(n,di[e],t).xor(pi(n,fi[e],t))},_i=(e,t)=>mi(e,t).xor(hi(e,t)),vi=(e,t)=>gi(e,t).xor(_i(e,t)),yi=(e,t)=>{let n=K.fromSquare(t);return ui[e].intersects(n)?ui[e].with(e):fi[e].intersects(n)?fi[e].with(e):di[e].intersects(n)?di[e].with(e):li[e].intersects(n)?li[e].with(e):K.empty()},bi=(e,t)=>yi(e,t).intersect(K.full().shl64(e).xor(K.full().shl64(t))).withoutFirst();var xi=class e{constructor(){}static default(){let t=new e;return t.reset(),t}reset(){this.occupied=new K(65535,4294901760),this.promoted=K.empty(),this.white=new K(65535,0),this.black=new K(0,4294901760),this.pawn=new K(65280,16711680),this.knight=new K(66,1107296256),this.bishop=new K(36,603979776),this.rook=new K(129,2164260864),this.queen=new K(8,134217728),this.king=new K(16,268435456)}static empty(){let t=new e;return t.clear(),t}clear(){this.occupied=K.empty(),this.promoted=K.empty();for(let e of Hr)this[e]=K.empty();for(let e of Ur)this[e]=K.empty()}clone(){let t=new e;t.occupied=this.occupied,t.promoted=this.promoted;for(let e of Hr)t[e]=this[e];for(let e of Ur)t[e]=this[e];return t}getColor(e){if(this.white.has(e))return`white`;if(this.black.has(e))return`black`}getRole(e){for(let t of Ur)if(this[t].has(e))return t}get(e){let t=this.getColor(e);if(t)return{color:t,role:this.getRole(e),promoted:this.promoted.has(e)}}take(e){let t=this.get(e);return t&&(this.occupied=this.occupied.without(e),this[t.color]=this[t.color].without(e),this[t.role]=this[t.role].without(e),t.promoted&&(this.promoted=this.promoted.without(e))),t}set(e,t){let n=this.take(e);return this.occupied=this.occupied.with(e),this[t.color]=this[t.color].with(e),this[t.role]=this[t.role].with(e),t.promoted&&(this.promoted=this.promoted.with(e)),n}has(e){return this.occupied.has(e)}*[Symbol.iterator](){for(let e of this.occupied)yield[e,this.get(e)]}pieces(e,t){return this[e].intersect(this[t])}rooksAndQueens(){return this.rook.union(this.queen)}bishopsAndQueens(){return this.bishop.union(this.queen)}steppers(){return this.knight.union(this.pawn).union(this.king)}sliders(){return this.bishop.union(this.rook).union(this.queen)}kingOf(e){return this.pieces(e,`king`).singleSquare()}},Si=class{unwrap(e,t){let n=this._chain(t=>q.ok(e?e(t):t),e=>t?q.ok(t(e)):q.err(e));if(n.isErr)throw n.error;return n.value}map(e,t){return this._chain(t=>q.ok(e(t)),e=>q.err(t?t(e):e))}chain(e,t){return this._chain(e,t??(e=>q.err(e)))}},Ci=class extends Si{constructor(e){super(),this.value=e,this.isOk=!0,this.isErr=!1}_chain(e,t){return e(this.value)}},wi=class extends Si{constructor(e){super(),this.error=e,this.isOk=!1,this.isErr=!0}_chain(e,t){return t(this.error)}},q;(function(e){function t(e){return new Ci(e)}e.ok=t;function n(e){return new wi(e||Error())}e.err=n;function r(t){if(Array.isArray(t)){let n=[];for(let e=0;e<t.length;e++){let r=t[e];if(r.isErr)return r;n.push(r.value)}return e.ok(n)}let n={},r=Object.keys(t);for(let e=0;e<r.length;e++){let i=t[r[e]];if(i.isErr)return i;n[r[e]]=i.value}return e.ok(n)}e.all=r})(q||={});var Ti;(function(e){e.Empty=`ERR_EMPTY`,e.OppositeCheck=`ERR_OPPOSITE_CHECK`,e.PawnsOnBackrank=`ERR_PAWNS_ON_BACKRANK`,e.Kings=`ERR_KINGS`,e.Variant=`ERR_VARIANT`})(Ti||={});var Ei=class extends Error{},Di=(e,t,n,r)=>n[t].intersect(_i(e,r).intersect(n.rooksAndQueens()).union(gi(e,r).intersect(n.bishopsAndQueens())).union(si(e).intersect(n.knight)).union(oi(e).intersect(n.king)).union(ci(G(t),e).intersect(n.pawn))),Oi=class e{constructor(){}static default(){let t=new e;return t.castlingRights=K.corners(),t.rook={white:{a:0,h:7},black:{a:56,h:63}},t.path={white:{a:new K(14,0),h:new K(96,0)},black:{a:new K(0,234881024),h:new K(0,1610612736)}},t}static empty(){let t=new e;return t.castlingRights=K.empty(),t.rook={white:{a:void 0,h:void 0},black:{a:void 0,h:void 0}},t.path={white:{a:K.empty(),h:K.empty()},black:{a:K.empty(),h:K.empty()}},t}clone(){let t=new e;return t.castlingRights=this.castlingRights,t.rook={white:{a:this.rook.white.a,h:this.rook.white.h},black:{a:this.rook.black.a,h:this.rook.black.h}},t.path={white:{a:this.path.white.a,h:this.path.white.h},black:{a:this.path.black.a,h:this.path.black.h}},t}add(e,t,n,r){let i=Xr(e,t),a=Zr(e,t);this.castlingRights=this.castlingRights.with(r),this.rook[e][t]=r,this.path[e][t]=bi(r,a).with(a).union(bi(n,i).with(i)).without(n).without(r)}static fromSetup(t){let n=e.empty(),r=t.castlingRights.intersect(t.board.rook);for(let e of Hr){let i=K.backrank(e),a=t.board.kingOf(e);if(!W(a)||!i.has(a))continue;let o=r.intersect(t.board[e]).intersect(i),s=o.first();W(s)&&s<a&&n.add(e,`a`,a,s);let c=o.last();W(c)&&a<c&&n.add(e,`h`,a,c)}return n}discardRook(e){if(this.castlingRights.has(e)){this.castlingRights=this.castlingRights.without(e);for(let t of Hr)for(let n of Wr)this.rook[t][n]===e&&(this.rook[t][n]=void 0)}}discardColor(e){this.castlingRights=this.castlingRights.diff(K.backrank(e)),this.rook[e].a=void 0,this.rook[e].h=void 0}},ki=class{constructor(e){this.rules=e}reset(){this.board=xi.default(),this.pockets=void 0,this.turn=`white`,this.castles=Oi.default(),this.epSquare=void 0,this.remainingChecks=void 0,this.halfmoves=0,this.fullmoves=1}setupUnchecked(e){this.board=e.board.clone(),this.board.promoted=K.empty(),this.pockets=void 0,this.turn=e.turn,this.castles=Oi.fromSetup(e),this.epSquare=ji(this,e.epSquare),this.remainingChecks=void 0,this.halfmoves=e.halfmoves,this.fullmoves=e.fullmoves}kingAttackers(e,t,n){return Di(e,t,this.board,n)}playCaptureAt(e,t){this.halfmoves=0,t.role===`rook`&&this.castles.discardRook(e),this.pockets&&this.pockets[G(t.color)][t.promoted?`pawn`:t.role]++}ctx(){let e=this.isVariantEnd(),t=this.board.kingOf(this.turn);if(!W(t))return{king:t,blockers:K.empty(),checkers:K.empty(),variantEnd:e,mustCapture:!1};let n=_i(t,K.empty()).intersect(this.board.rooksAndQueens()).union(gi(t,K.empty()).intersect(this.board.bishopsAndQueens())).intersect(this.board[G(this.turn)]),r=K.empty();for(let e of n){let n=bi(t,e).intersect(this.board.occupied);n.moreThanOne()||(r=r.union(n))}let i=this.kingAttackers(t,G(this.turn),this.board.occupied);return{king:t,blockers:r,checkers:i,variantEnd:e,mustCapture:!1}}clone(){let e=new this.constructor;return e.board=this.board.clone(),e.pockets=this.pockets?.clone(),e.turn=this.turn,e.castles=this.castles.clone(),e.epSquare=this.epSquare,e.remainingChecks=this.remainingChecks?.clone(),e.halfmoves=this.halfmoves,e.fullmoves=this.fullmoves,e}validate(){if(this.board.occupied.isEmpty())return q.err(new Ei(Ti.Empty));if(this.board.king.size()!==2||!W(this.board.kingOf(this.turn)))return q.err(new Ei(Ti.Kings));let e=this.board.kingOf(G(this.turn));return W(e)?this.kingAttackers(e,this.turn,this.board.occupied).nonEmpty()?q.err(new Ei(Ti.OppositeCheck)):K.backranks().intersects(this.board.pawn)?q.err(new Ei(Ti.PawnsOnBackrank)):q.ok(void 0):q.err(new Ei(Ti.Kings))}dropDests(e){return K.empty()}dests(e,t){if(t||=this.ctx(),t.variantEnd)return K.empty();let n=this.board.get(e);if(!n||n.color!==this.turn)return K.empty();let r,i;if(n.role===`pawn`){r=ci(this.turn,e).intersect(this.board[G(this.turn)]);let n=this.turn===`white`?8:-8,a=e+n;if(0<=a&&a<64&&!this.board.occupied.has(a)){r=r.with(a);let t=this.turn===`white`?e<16:e>=48,i=a+n;t&&!this.board.occupied.has(i)&&(r=r.with(i))}W(this.epSquare)&&Ni(this,e,t)&&(i=K.fromSquare(this.epSquare))}else r=n.role===`bishop`?gi(e,this.board.occupied):n.role===`knight`?si(e):n.role===`rook`?_i(e,this.board.occupied):n.role===`queen`?vi(e,this.board.occupied):oi(e);if(r=r.diff(this.board[this.turn]),W(t.king)){if(n.role===`king`){let n=this.board.occupied.without(e);for(let e of r)this.kingAttackers(e,G(this.turn),n).nonEmpty()&&(r=r.without(e));return r.union(Pi(this,`a`,t)).union(Pi(this,`h`,t))}if(t.checkers.nonEmpty()){let e=t.checkers.singleSquare();if(!W(e))return K.empty();r=r.intersect(bi(e,t.king).with(e))}t.blockers.has(e)&&(r=r.intersect(yi(e,t.king)))}return i&&(r=r.union(i)),r}isVariantEnd(){return!1}variantOutcome(e){}hasInsufficientMaterial(e){return this.board[e].intersect(this.board.pawn.union(this.board.rooksAndQueens())).nonEmpty()?!1:this.board[e].intersects(this.board.knight)?this.board[e].size()<=2&&this.board[G(e)].diff(this.board.king).diff(this.board.queen).isEmpty():this.board[e].intersects(this.board.bishop)?(!this.board.bishop.intersects(K.darkSquares())||!this.board.bishop.intersects(K.lightSquares()))&&this.board.pawn.isEmpty()&&this.board.knight.isEmpty():!0}toSetup(){return{board:this.board.clone(),pockets:this.pockets?.clone(),turn:this.turn,castlingRights:this.castles.castlingRights,epSquare:Mi(this),remainingChecks:this.remainingChecks?.clone(),halfmoves:Math.min(this.halfmoves,150),fullmoves:Math.min(Math.max(this.fullmoves,1),9999)}}isInsufficientMaterial(){return Hr.every(e=>this.hasInsufficientMaterial(e))}hasDests(e){e||=this.ctx();for(let t of this.board[this.turn])if(this.dests(t,e).nonEmpty())return!0;return this.dropDests(e).nonEmpty()}isLegal(e,t){if(Gr(e))return!this.pockets||this.pockets[this.turn][e.role]<=0||e.role===`pawn`&&K.backranks().has(e.to)?!1:this.dropDests(t).has(e.to);{if(e.promotion===`pawn`||e.promotion===`king`&&this.rules!==`antichess`||!!e.promotion!==(this.board.pawn.has(e.from)&&K.backranks().has(e.to)))return!1;let n=this.dests(e.from,t);return n.has(e.to)||n.has(Ii(this,e).to)}}isCheck(){let e=this.board.kingOf(this.turn);return W(e)&&this.kingAttackers(e,G(this.turn),this.board.occupied).nonEmpty()}isEnd(e){return(e?e.variantEnd:this.isVariantEnd())?!0:this.isInsufficientMaterial()||!this.hasDests(e)}isCheckmate(e){return e||=this.ctx(),!e.variantEnd&&e.checkers.nonEmpty()&&!this.hasDests(e)}isStalemate(e){return e||=this.ctx(),!e.variantEnd&&e.checkers.isEmpty()&&!this.hasDests(e)}outcome(e){let t=this.variantOutcome(e);if(t)return t;if(e||=this.ctx(),this.isCheckmate(e))return{winner:G(this.turn)};if(this.isInsufficientMaterial()||this.isStalemate(e))return{winner:void 0}}allDests(e){e||=this.ctx();let t=new Map;if(e.variantEnd)return t;for(let n of this.board[this.turn])t.set(n,this.dests(n,e));return t}play(e){let t=this.turn,n=this.epSquare,r=Fi(this,e);if(this.epSquare=void 0,this.halfmoves+=1,t===`black`&&(this.fullmoves+=1),this.turn=G(t),Gr(e))this.board.set(e.to,{role:e.role,color:t}),this.pockets&&this.pockets[t][e.role]--,e.role===`pawn`&&(this.halfmoves=0);else{let i=this.board.take(e.from);if(!i)return;let a;if(i.role===`pawn`){this.halfmoves=0,e.to===n&&(a=this.board.take(e.to+(t===`white`?-8:8)));let r=e.from-e.to;Math.abs(r)===16&&8<=e.from&&e.from<=55&&(this.epSquare=e.from+e.to>>1),e.promotion&&(i.role=e.promotion,i.promoted=!!this.pockets)}else if(i.role===`rook`)this.castles.discardRook(e.from);else if(i.role===`king`){if(r){let e=this.castles.rook[t][r];if(W(e)){let n=this.board.take(e);this.board.set(Xr(t,r),i),n&&this.board.set(Zr(t,r),n)}}this.castles.discardColor(t)}if(!r){let t=this.board.set(e.to,i)||a;t&&this.playCaptureAt(e.to,t)}}this.remainingChecks&&this.isCheck()&&(this.remainingChecks[t]=Math.max(this.remainingChecks[t]-1,0))}},Ai=class extends ki{constructor(){super(`chess`)}static default(){let e=new this;return e.reset(),e}static fromSetup(e){let t=new this;return t.setupUnchecked(e),t.validate().map(e=>t)}clone(){return super.clone()}},ji=(e,t)=>{if(!W(t))return;let n=e.turn===`white`?5:2,r=e.turn===`white`?8:-8;if(Kr(t)!==n||e.board.occupied.has(t+r))return;let i=t-r;if(!(!e.board.pawn.has(i)||!e.board[G(e.turn)].has(i)))return t},Mi=e=>{if(!W(e.epSquare))return;let t=e.ctx(),n=e.board.pieces(e.turn,`pawn`).intersect(ci(G(e.turn),e.epSquare));for(let r of n)if(e.dests(r,t).has(e.epSquare))return e.epSquare},Ni=(e,t,n)=>{if(!W(e.epSquare)||!ci(e.turn,t).has(e.epSquare))return!1;if(!W(n.king))return!0;let r=e.turn===`white`?8:-8,i=e.epSquare-r;return e.kingAttackers(n.king,G(e.turn),e.board.occupied.toggle(t).toggle(i).with(e.epSquare)).without(i).isEmpty()},Pi=(e,t,n)=>{if(!W(n.king)||n.checkers.nonEmpty())return K.empty();let r=e.castles.rook[e.turn][t];if(!W(r)||e.castles.path[e.turn][t].intersects(e.board.occupied))return K.empty();let i=Xr(e.turn,t),a=bi(n.king,i),o=e.board.occupied.without(n.king);for(let t of a)if(e.kingAttackers(t,G(e.turn),o).nonEmpty())return K.empty();let s=Zr(e.turn,t),c=e.board.occupied.toggle(n.king).toggle(r).toggle(s);return e.kingAttackers(i,G(e.turn),c).nonEmpty()?K.empty():K.fromSquare(r)};const Fi=(e,t)=>{if(Gr(t))return;let n=t.to-t.from;if(!(Math.abs(n)!==2&&!e.board[e.turn].has(t.to))&&e.board.king.has(t.from))return n>0?`h`:`a`},Ii=(e,t)=>{let n=Fi(e,t);if(!n)return t;let r=e.castles.rook[e.turn][n];return{from:t.from,to:W(r)?r:t.to}};var Li;(function(e){e.Fen=`ERR_FEN`,e.Board=`ERR_BOARD`,e.Pockets=`ERR_POCKETS`,e.Turn=`ERR_TURN`,e.Castling=`ERR_CASTLING`,e.EpSquare=`ERR_EP_SQUARE`,e.RemainingChecks=`ERR_REMAINING_CHECKS`,e.Halfmoves=`ERR_HALFMOVES`,e.Fullmoves=`ERR_FULLMOVES`})(Li||={});const Ri=e=>{let t=Jr(e.role);return e.color===`white`&&(t=t.toUpperCase()),e.promoted&&(t+=`~`),t},zi=e=>{let t=``,n=0;for(let r=7;r>=0;r--)for(let i=0;i<8;i++){let a=i+r*8,o=e.get(a);o?(n>0&&(t+=n,n=0),t+=Ri(o)):n++,i===7&&(n>0&&(t+=n,n=0),r!==0&&(t+=`/`))}return t},Bi=e=>Ur.map(t=>Jr(t).repeat(e[t])).join(``),Vi=e=>Bi(e.white).toUpperCase()+Bi(e.black),Hi=(e,t)=>{let n=``;for(let r of Hr){let i=K.backrank(r),a=e.kingOf(r);W(a)&&!i.has(a)&&(a=void 0);let o=e.pieces(r,`rook`).intersect(i);for(let e of t.intersect(i).reversed())if(e===o.first()&&W(a)&&e<a)n+=r===`white`?`Q`:`q`;else if(e===o.last()&&W(a)&&a<e)n+=r===`white`?`K`:`k`;else{let t=Br[qr(e)];n+=r===`white`?t.toUpperCase():t}}return n||`-`},Ui=e=>`${e.white}+${e.black}`,Wi=(e,t)=>[zi(e.board)+(e.pockets?`[${Vi(e.pockets)}]`:``),e.turn[0],Hi(e.board,e.castlingRights),W(e.epSquare)?Yr(e.epSquare):`-`,...e.remainingChecks?[Ui(e.remainingChecks)]:[],...t?.epd?[]:[Math.max(0,Math.min(e.halfmoves,9999)),Math.max(1,Math.min(e.fullmoves,9999))]].join(` `);var Gi=e=>(e-=e>>>1&1431655765,e=(e&858993459)+(e>>>2&858993459),Math.imul(e+(e>>>4)&252645135,16843009)>>24),Ki=e=>(e=e>>>8&16711935|(e&16711935)<<8,e>>>16&65535|(e&65535)<<16),qi=e=>(e=e>>>1&1431655765|(e&1431655765)<<1,e=e>>>2&858993459|(e&858993459)<<2,e=e>>>4&252645135|(e&252645135)<<4,Ki(e)),J=class e{lo;hi;constructor(e,t){this.lo=e|0,this.hi=t|0}static fromSquare(t){return t>=32?new e(0,1<<t-32):new e(1<<t,0)}static fromRank(t){return new e(255,0).shl64(8*t)}static fromFile(t){return new e(16843009<<t,16843009<<t)}static empty(){return new e(0,0)}static full(){return new e(4294967295,4294967295)}static corners(){return new e(129,2164260864)}static center(){return new e(402653184,24)}static backranks(){return new e(255,4278190080)}static backrank(t){return t===`white`?new e(255,0):new e(0,4278190080)}static lightSquares(){return new e(1437226410,1437226410)}static darkSquares(){return new e(2857740885,2857740885)}complement(){return new e(~this.lo,~this.hi)}xor(t){return new e(this.lo^t.lo,this.hi^t.hi)}union(t){return new e(this.lo|t.lo,this.hi|t.hi)}intersect(t){return new e(this.lo&t.lo,this.hi&t.hi)}diff(t){return new e(this.lo&~t.lo,this.hi&~t.hi)}intersects(e){return this.intersect(e).nonEmpty()}isDisjoint(e){return this.intersect(e).isEmpty()}supersetOf(e){return e.diff(this).isEmpty()}subsetOf(e){return this.diff(e).isEmpty()}shr64(t){return t>=64?e.empty():t>=32?new e(this.hi>>>t-32,0):t>0?new e(this.lo>>>t^this.hi<<32-t,this.hi>>>t):this}shl64(t){return t>=64?e.empty():t>=32?new e(0,this.lo<<t-32):t>0?new e(this.lo<<t,this.hi<<t^this.lo>>>32-t):this}bswap64(){return new e(Ki(this.hi),Ki(this.lo))}rbit64(){return new e(qi(this.hi),qi(this.lo))}minus64(t){let n=this.lo-t.lo,r=(n&t.lo&1)+(t.lo>>>1)+(n>>>1)>>>31;return new e(n,this.hi-(t.hi+r))}equals(e){return this.lo===e.lo&&this.hi===e.hi}size(){return Gi(this.lo)+Gi(this.hi)}isEmpty(){return this.lo===0&&this.hi===0}nonEmpty(){return this.lo!==0||this.hi!==0}has(e){return(e>=32?this.hi&1<<e-32:this.lo&1<<e)!=0}set(e,t){return t?this.with(e):this.without(e)}with(t){return t>=32?new e(this.lo,this.hi|1<<t-32):new e(this.lo|1<<t,this.hi)}without(t){return t>=32?new e(this.lo,this.hi&~(1<<t-32)):new e(this.lo&~(1<<t),this.hi)}toggle(t){return t>=32?new e(this.lo,this.hi^1<<t-32):new e(this.lo^1<<t,this.hi)}last(){if(this.hi!==0)return 63-Math.clz32(this.hi);if(this.lo!==0)return 31-Math.clz32(this.lo)}first(){if(this.lo!==0)return 31-Math.clz32(this.lo&-this.lo);if(this.hi!==0)return 63-Math.clz32(this.hi&-this.hi)}withoutFirst(){return this.lo===0?new e(0,this.hi&this.hi-1):new e(this.lo&this.lo-1,this.hi)}moreThanOne(){return this.hi!==0&&this.lo!==0||(this.lo&this.lo-1)!=0||(this.hi&this.hi-1)!=0}singleSquare(){return this.moreThanOne()?void 0:this.last()}*[Symbol.iterator](){let e=this.lo,t=this.hi;for(;e!==0;){let t=31-Math.clz32(e&-e);e^=1<<t,yield t}for(;t!==0;){let e=31-Math.clz32(t&-t);t^=1<<e,yield 32+e}}*reversed(){let e=this.lo,t=this.hi;for(;t!==0;){let e=31-Math.clz32(t);t^=1<<e,yield 32+e}for(;e!==0;){let t=31-Math.clz32(e);e^=1<<t,yield t}}},Ji=(e,t)=>{let n=J.empty();for(let r of t){let t=e+r;0<=t&&t<64&&Math.abs(U(e)-U(t))<=2&&(n=n.with(t))}return n},Yi=e=>{let t=[];for(let n=0;n<64;n++)t[n]=e(n);return t},Xi=Yi(e=>Ji(e,[-9,-8,-7,-1,1,7,8,9])),Zi=Yi(e=>Ji(e,[-17,-15,-10,-6,6,10,15,17])),Qi={white:Yi(e=>Ji(e,[7,9])),black:Yi(e=>Ji(e,[-7,-9]))};const $i=e=>Xi[e],ea=e=>Zi[e],ta=(e,t)=>Qi[e][t];var na=Yi(e=>J.fromFile(U(e)).without(e)),ra=Yi(e=>J.fromRank(Mr(e)).without(e)),ia=Yi(e=>{let t=new J(134480385,2151686160),n=8*(Mr(e)-U(e));return(n>=0?t.shl64(n):t.shr64(-n)).without(e)}),aa=Yi(e=>{let t=new J(270549120,16909320),n=8*(Mr(e)+U(e)-7);return(n>=0?t.shl64(n):t.shr64(-n)).without(e)}),oa=(e,t,n)=>{let r=n.intersect(t),i=r.bswap64();return r=r.minus64(e),i=i.minus64(e.bswap64()),r.xor(i.bswap64()).intersect(t)},sa=(e,t)=>oa(J.fromSquare(e),na[e],t),ca=(e,t)=>{let n=ra[e],r=t.intersect(n),i=r.rbit64();return r=r.minus64(J.fromSquare(e)),i=i.minus64(J.fromSquare(63-e)),r.xor(i.rbit64()).intersect(n)};const la=(e,t)=>{let n=J.fromSquare(e);return oa(n,ia[e],t).xor(oa(n,aa[e],t))},ua=(e,t)=>sa(e,t).xor(ca(e,t)),da=(e,t)=>la(e,t).xor(ua(e,t)),fa=(e,t,n)=>{switch(e.role){case`pawn`:return ta(e.color,t);case`knight`:return ea(t);case`bishop`:return la(t,n);case`rook`:return ua(t,n);case`queen`:return da(t,n);case`king`:return $i(t)}},pa=(e,t)=>{let n=J.fromSquare(t);return ra[e].intersects(n)?ra[e].with(e):aa[e].intersects(n)?aa[e].with(e):ia[e].intersects(n)?ia[e].with(e):na[e].intersects(n)?na[e].with(e):J.empty()},ma=(e,t)=>pa(e,t).intersect(J.full().shl64(e).xor(J.full().shl64(t))).withoutFirst();function ha(e,t){let{x:n,y:r}=e,i=t.get(n),a=t.get(r);if(U(i)===U(a))return i<a?3:7;if(Mr(i)===Mr(a))return i<a?1:5;let o=U(i)-U(a),s=Mr(i)-Mr(a);if(Math.abs(o)===Math.abs(s))return o<0?s<0?2:8:s<0?4:6;if(o===2){if(s===1)return 11;if(s===-1)return 12}else if(o===-2){if(s===1)return 13;if(s===-1)return 14}else if(o===1){if(s===2)return 15;if(s===-2)return 16}else if(o===-1){if(s===2)return 17;if(s===-2)return 18}return 0}function ga(e){let t=_a(e),n=[];for(let[r,i]of e.entries()){let a=fa(va(r),i,t);a=a.intersect(t);for(let t of a){let[i]=[...e.entries()].find(e=>e[1]===t);n.push({x:r,y:i})}}return n}function _a(e){let t=J.empty();for(let n of e.values())t=t.set(n,!0);return t}function va(e){switch(e[0]){case`P`:return{color:`white`,role:`pawn`};case`p`:return{color:`black`,role:`pawn`};case`b`:return{color:`black`,role:`bishop`};case`n`:return{color:`black`,role:`knight`};case`r`:return{color:`black`,role:`rook`};case`q`:return{color:`black`,role:`queen`};case`k`:return{color:`black`,role:`king`}}}function ya(e){e=e.split(` `)[0];let t=new Map,n=0,r=0,i=0,a=0,o=0,s=0,c=0,l=e=>{switch(e){case`P`:return`P`+ ++n;case`p`:return`p`+ ++r;case`B`:case`b`:return`b`+ ++a;case`N`:case`n`:return`n`+ ++s;case`R`:case`r`:return`r`+ ++o;case`Q`:case`q`:return`q`+ ++c;case`K`:case`k`:return`k`+ ++i}},u=7;for(let n of e.split(`/`)){let e=0;for(let r of n){let n=l(r);if(n!==void 0){let r=Nr(e,u);r!==void 0&&t.set(n,r),e+=1}else{e+=parseInt(r);continue}}--u}return t}function ba(e){let t=xa();for(let[n,r]of e.entries())t.board.set(r,va(n));return Wi(t.toSetup())}function xa(){let e=Ai.default();return e.board=xi.empty(),e}var Sa=120,Y=class e{static createEmptyGrid(){return Array(8).fill(null).map(()=>Array(8).fill(!1))}static checkerboard2(){let t=e.createEmptyGrid();for(let e=0;e<8;e++)for(let n=0;n<8;n++)t[e][n]=(e+n)%2==1;return t}static checkerboard(){let t=e.createEmptyGrid();for(let e=0;e<8;e++)for(let n=0;n<8;n++)t[e][n]=(e+n)%2==0;return t}static fullGrid(){let t=e.createEmptyGrid();for(let e=0;e<8;e++)for(let n=0;n<8;n++)t[e][n]=!0;return t}static border(){let t=e.createEmptyGrid();for(let e=0;e<8;e++)for(let n=0;n<8;n++)t[e][n]=e===0||e===7||n===0||n===7;return t}static diagonal(){let t=e.createEmptyGrid();for(let e=0;e<8;e++)for(let n=0;n<8;n++)t[e][n]=e===n||e===7-n;return t}static cross(){let t=e.createEmptyGrid();for(let e=0;e<8;e++)for(let n=0;n<8;n++)t[e][n]=e===3||e===4||n===3||n===4;return t}static dots(){let t=e.createEmptyGrid();for(let e=0;e<8;e++)for(let n=0;n<8;n++)t[e][n]=e%2==0&&n%2==0;return t}static fromString(t){let n=e.createEmptyGrid(),r=t.trim().split(`
`);for(let e=0;e<8&&e<r.length;e++){let t=r[e].split(``);for(let r=0;r<8&&r<t.length;r++)n[e][r]=t[r]===`1`||t[r]===`X`}return n}static random(){let t=e.createEmptyGrid();for(let e=0;e<8;e++)for(let n=0;n<8;n++)t[e][n]=Math.random()>.5;return t}},Ca=class{static patternTransition(e,t,n=10){let r=[],i=e.length,a=e[0].length;for(let o=0;o<=n;o++){let s=o/n,c=Y.createEmptyGrid();for(let n=0;n<i;n++)for(let r=0;r<a;r++){let i=e[n][r]?1:0,a=t[n][r]?1:0,o=i*(1-s)+a*s;c[n][r]=o>.5}r.push({grid:c,delay:Sa})}return r}static rowSweep(e,t=`top`){let n=[];for(let r=0;r<8;r++){let i=Y.createEmptyGrid(),a=t===`top`?r:7-r;for(let n=0;n<8;n++)for(let r=0;r<8;r++)i[n][r]=e[n][r]&&(t===`top`&&n<=a||t===`bottom`&&n>=a);n.push({grid:i,delay:Sa})}return n}static columnSweep(e,t=`left`){let n=[];for(let r=0;r<8;r++){let i=Y.createEmptyGrid(),a=t===`left`?r:7-r;for(let n=0;n<8;n++)for(let r=0;r<8;r++)i[n][r]=e[n][r]&&(t===`left`&&r<=a||t===`right`&&r>=a);n.push({grid:i,delay:Sa})}return n}static randomBlink(e,t=20){let n=[];for(let r=0;r<t;r++){let t=Y.createEmptyGrid();for(let n=0;n<8;n++)for(let r=0;r<8;r++)t[n][r]=e[n][r]&&Math.random()>.3;n.push({grid:t,delay:Sa})}return n}static pulse(e,t=3){let n=[],r=e.length,i=e[0].length;for(let a=0;a<t;a++)for(let t=0;t<10;t++){let a=t/9,o=Math.sin(a*Math.PI),s=Y.createEmptyGrid();for(let t=0;t<r;t++)for(let n=0;n<i;n++)s[t][n]=e[t][n]&&o>.5;n.push({grid:s,delay:Sa})}return n}static wave(e,t=`horizontal`){let n=[],r=e.length,i=e[0].length;for(let a=0;a<16;a++){let o=Y.createEmptyGrid();for(let n=0;n<r;n++)for(let r=0;r<i;r++){let i=t===`horizontal`?n:r,s=(Math.sin((i+a*.5)*Math.PI/4)+1)*.5;o[n][r]=e[n][r]&&s>.5}n.push({grid:o,delay:Sa})}return n}};const wa={empty:Y.createEmptyGrid,checkerboard:Y.checkerboard,checkerboard2:Y.checkerboard2,full:Y.fullGrid,border:Y.border,diagonal:Y.diagonal,cross:Y.cross,dots:Y.dots,random:Y.random},Ta={rowsweep:e=>Ca.rowSweep(e,`top`),"rowsweep-reverse":e=>Ca.rowSweep(e,`bottom`),colsweep:e=>Ca.columnSweep(e,`left`),"colsweep-reverse":e=>Ca.columnSweep(e,`right`),blink:e=>Ca.randomBlink(e,20),pulse:e=>Ca.pulse(e,3),"wave-horizontal":e=>Ca.wave(e,`horizontal`),"wave-vertical":e=>Ca.wave(e,`vertical`)},Ea=()=>Ca.patternTransition(wa.checkerboard(),wa.checkerboard2(),8),Da=()=>{let e=Object.keys(Ta),t=Ta[e[Math.floor(Math.random()*e.length)]],n=Object.keys(wa);return t(wa[n[Math.floor(Math.random()*n.length)]]())};async function Oa(e,t){let n=await fetch(t).then(e=>e.arrayBuffer());return await e.decodeAudioData(n)}function ka(){let e=new AudioContext,t={};async function n(){t.pickup=await Oa(e,`/sfx/pickup.mp3`),t.pickup2=await Oa(e,`/sfx/pickup2.mp3`),t.drop_good=await Oa(e,`/sfx/drop_good.mp3`),t.win=await Oa(e,`/sfx/win.mp3`)}function r(n,r=!1,i=.9){let a=t[n],o=e.createBufferSource();o.buffer=a;let s=e.createGain();return s.gain.value=i,s.connect(e.destination),o.connect(s),o.loop=r,o.start(),()=>{o.stop()}}return{load:n,play:r,buffers:t}}var Aa=t({_api:()=>wo,_cleanup:()=>vo,_init:()=>qa,_render:()=>eo,_set_ctx:()=>bo,_update:()=>Ja,audio:()=>Ma,hitbox_rect:()=>lo,next_scene:()=>fo,play_sfx:()=>Na}),ja;let Ma=ka();function Na(e){ja||Ma.play(e)}var Pa={xy:ur(60,60),wh:ur(960,960)};mo(Pa);var X,Fa,Ia,La,Ra,za,Ba,Va;function Ha(e,t,n){Ka=n*(Pa.wh.x/8);let r=ya(e),i=ya(t);if(Va!==ba(r).split(` `)[0]){Ia=0,Wa=!1,Ua=0,Z.x.followTo(0),Z.y.followTo(0),Z.r.followTo(0),Ga.frames=[],Va=e.split(` `)[0],Ra=[];for(let e of r.keys())Ra.push({pieces:e,xy:{x:new F(500),y:new F(500)},sq_base:r.get(e)});La=ga(i),za=La.map(e=>({data:e,piece:Ra.find(t=>t.pieces===e.x),xy:{x:new F(0),y:new F(0)},stick:0})),Ba=[]}}var Ua,Wa,Z={x:new F,y:new F,r:new F},Ga,Ka;function qa(){ja=!1,Ga={frames:[],time:0},Ua=0,Wa=!1,Fa=0,X={xy:ur(0,0),wh:{x:40,y:40},follow:{x:new F(500).swayTo({amplitude:-8,frequency:13,bias:0}),y:new F(500).swayTo({amplitude:-8,frequency:13,bias:0})}},Ha(``,``,0)}function Ja(e){if(Za(e),Fa+=e/1e3,Ia+=e/1e3,X.follow.x.followTo(yo.is_hovering[0],{speed:1}),X.follow.y.followTo(yo.is_hovering[1],{speed:1}),X.follow.x.update(e/1e3),X.follow.y.update(e/1e3),X.xy=ur(X.follow.x.value,X.follow.y.value),X.drag&&yo.has_moved_after_last_down){let e=lr(ur(X.drag.piece.xy.x.value,X.drag.piece.xy.y.value),fr(X.xy,X.drag.decay));Ka+=e,xo(Math.floor(Ka/(Pa.wh.x/8))),X.drag.piece.xy.x.followTo(X.xy.x-X.drag.decay.x),X.drag.piece.xy.y.followTo(X.xy.y-X.drag.decay.y)}X.sq=go(X.xy);let t=!Wa&&Ua===0&&Ia>.8;if(t&&yo.is_just_down){let e=X.sq;if(e!==void 0){let t=Ra.find(t=>t.sq===e);t&&(t.xy.x.springTo(t.xy.x.value-10,{stiffness:800,damping:10}),t.xy.y.springTo(t.xy.y.value-15,{stiffness:800,damping:10}),X.drag={decay:fr(X.xy,{x:t.xy.x.value-10,y:t.xy.y.value-15}),piece:t},X.follow.x.swayEnabled=!1,X.follow.y.swayEnabled=!1,Na(`pickup2`))}}yo.is_up&&(X.follow.x.swayEnabled=!0,X.follow.y.swayEnabled=!0);for(let t of Ra)Qa(t,e);for(let t of za)$a(t,za.filter(e=>e.stick===0).indexOf(t),e);for(let t of Ba)$a(t,0,e);if(yo.is_up){if(X.drag){Na(`drop_good`),X.drag=void 0;let e=ba(_o());Va=e.split(` `)[0],So(e)}if(t){let e=ga(_o());La.every(t=>e.some(e=>t.x===e.x&&t.y===e.y))&&e.every(e=>La.some(t=>e.x===t.x&&e.y===t.y))&&(Ua=2e3,Co(),Na(`win`))}}Ua>0&&(Ua-=e,Ua<=0&&(Ua=0,Wa=!0,Ya())),Ua>1500?(Z.x.springTo(0,{stiffness:1e3,damping:8}),Z.y.springTo(45,{stiffness:1e3,damping:8}),Z.r.springTo(Math.PI*.5,{stiffness:1e3,damping:2})):Ua>800&&Z.y.springTo(-1e3,{stiffness:50}),Z.x.update(e/1e3),Z.y.update(e/1e3),Z.r.update(e/1e3),Xa(e)}function Ya(){Ga.frames=[...Ta.blink(wa.full()),...Da(),...Da(),...Da(),...Ea(),...Ta.pulse(wa.full())]}function Xa(e){let t=Ga.frames.shift();t&&(Ga.time+=e,Ga.time>t.delay?Ga.time-=t.delay:Ga.frames.unshift(t))}function Za(e){let t=_o(),n=ga(t),r=za;r.forEach(e=>e.stick=0);for(let e of n){let n=r.find(t=>t.data.x===e.x&&t.data.y===e.y);n&&(n.stick=ha(e,t))}let i=n.filter(e=>!La.find(t=>t.x===e.x&&t.y===e.y)),a=Ba;for(let e of i){let n=a.find(t=>t.data.x===e.x&&t.data.y===e.y),r=ha(e,t);n&&(n.stick=r),n||a.push({data:e,piece:Ra.find(t=>t.pieces===e.x),xy:{x:new F(0),y:new F(0)},stick:ha(e,t)})}let o=a.filter(e=>!i.find(t=>t.x===e.data.x&&t.y===e.data.y));Ba=a.filter(e=>!o.includes(e))}function Qa(e,t){e.sq=go(ur(e.xy.x.value,e.xy.y.value));let n=ho(e.sq_base);X.drag?.piece===e?yo.is_up&&e.sq!==void 0&&(e.sq_base=e.sq):(e.xy.x.springTo(n.x,{stiffness:600,damping:17}),e.xy.y.springTo(n.y,{stiffness:600,damping:17})),e.xy.x.update(t/1e3),e.xy.y.update(t/1e3)}function $a(e,t,n){if(e.stick===0){let n=Math.sin(Fa*.5*Math.PI*2+t*Math.PI*.25)*80,r=Math.cos(Fa*.5*Math.PI*2+t*Math.PI*.25)*80;e.xy.x.followTo(r,{speed:.999}),e.xy.y.followTo(n,{speed:.999})}else{let[t,n]=po[e.stick];e.xy.x.springTo(t*37),e.xy.y.springTo(n*37)}e.xy.x.update(n/1e3),e.xy.y.update(n/1e3)}function eo(){Q.beginFrame(),Q.fillRect(1080/2,1080/2,1080,1080,z.darkblue),so();for(let e of Ra)to(e);co(X.xy.x,X.xy.y),Q.endFrame()}function to(e){let t=e.xy.x.value,n=e.xy.y.value;oo(t,n,e.pieces);for(let e=0;e<za.length;e++){let t=za[e],n=t.piece.xy.x.value,r=t.piece.xy.y.value;n+=t.xy.x.value,r+=t.xy.y.value,n+=Z.x.value*(e%2==0?-20:20),r+=Z.y.value;let i=Z.r.value*(e%2==0?-1:1);ro(n,r,t.data.y,t.stick,i)}for(let e of Ba){let t=e.piece.xy.x.value,n=e.piece.xy.y.value;t+=e.xy.x.value,n+=e.xy.y.value,no(t,n,e.data.y,e.stick)}}function no(e,t,n,r){let i=z.red;Q.fillRoundRect(e,t,46,46,6,z.darkblue),Q.strokeRoundRect(e,t,46,46,6,1,i),ao(e,t,n)}function ro(e,t,n,r,i){let a=r===0?z.red:z.green;Q.fillRoundRect(e,t,46,46,6,z.darkblue,i),Q.strokeRoundRect(e,t,46,46,6,1,a,void 0,i),ao(e,t,n)}var io=[Er.yellow,Er.white,Er.blue,Er.pink,Er.green,Er.light,Er.black,Er.purple,Er.darkblue];function ao(e,t,n){let r=io[parseInt(n[1])-1];n[0]===`r`&&(Q.strokeLine(e-10,t,e+10,t,4,r),Q.strokeLine(e,t-10,e,t+10,4,r)),n[0]===`b`&&(Q.strokeLine(e-8,t-8,e+8,t+8,4,r),Q.strokeLine(e-8,t+8,e+8,t-8,4,r)),n[0]===`P`&&(Q.strokeLine(e-8,t-8,e,t,4,r),Q.strokeLine(e+8,t-8,e,t,4,r),Q.strokeLine(e,t,e,t+4,4,r)),n[0]===`p`&&(Q.strokeLine(e-8,t+8,e,t,4,r),Q.strokeLine(e+8,t+8,e,t,4,r),Q.strokeLine(e,t,e,t-4,4,r)),n[0]===`k`&&Q.strokeRoundRect(e,t,20,20,4,4,r),n[0]===`n`&&(Q.strokeLine(e-4,t-8,e-4,t+8,4,r),Q.strokeLine(e-4,t+8,e+4,t+8,4,r)),n[0]===`q`&&(Q.strokeLine(e-10,t,e+10,t,4,r),Q.strokeLine(e,t-10,e,t+10,4,r),Q.strokeLine(e-8,t-8,e+8,t+8,4,r),Q.strokeLine(e-8,t+8,e+8,t-8,4,r))}function oo(e,t,n){let r=io[parseInt(n[1])-1];n[0]===`b`&&(Q.strokeLine(e-20,t-20,e+20,t+20,9,r),Q.strokeLine(e-20,t+20,e+20,t-20,9,r)),n[0]===`r`&&(Q.strokeLine(e-25,t,e+25,t,9,r),Q.strokeLine(e,t-25,e,t+25,9,r)),n[0]===`P`&&(Q.strokeLine(e-20,t-20,e,t,9,r),Q.strokeLine(e+20,t-20,e,t,9,r),Q.strokeLine(e,t,e,t+10,9,r)),n[0]===`p`&&(Q.strokeLine(e-20,t+20,e,t,9,r),Q.strokeLine(e+20,t+20,e,t,9,r),Q.strokeLine(e,t,e,t-10,9,r)),n[0]===`k`&&Q.strokeRoundRect(e,t,64,64,10,9,r),n[0]===`n`&&(Q.strokeLine(e-10,t-20,e-10,t+20,9,r),Q.strokeLine(e-10,t+20,e+10,t+20,9,r)),n[0]===`q`&&(Q.strokeLine(e-20,t-20,e+20,t+20,9,r),Q.strokeLine(e-20,t+20,e+20,t-20,9,r),Q.strokeLine(e-22,t,e+22,t,9,r),Q.strokeLine(e,t-22,e,t+22,9,r))}function so(){let e,t;e=60,t=60;for(let n=0;n<8;n++)for(let r=0;r<8;r++)Ga.frames[0]?.grid[n][r]&&((n+r)%2==0?Q.fillRoundRect(e+n*120+120/2,t+r*120+120/2,136,136,16,z.pink):Q.fillRoundRect(e+n*120+120/2,t+r*120+120/2,152,152,16,z.blue)),(n+r)%2==0?Q.strokeRoundRect(e+n*120+120/2,t+r*120+120/2,136,136,16,3,z.pink):Q.strokeRoundRect(e+n*120+120/2,t+r*120+120/2,152,152,16,3,z.blue)}function co(e,t){Q.strokeLine(e+40,t+3,e,t,16,z.black),Q.strokeLine(e,t,e+3,t+40,16,z.black)}function lo(e){let t=e.xy.x,n=e.xy.y,r=e.wh.x,i=e.wh.y;Q.strokeRect(t+r/2,n+i/2,r,i,7,z.red)}var uo=void 0;function fo(){let e=uo;if(e!==void 0)return uo=void 0,e}var po=[[0,0],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1],[0,1],[1,1],[0,0],[0,0],[-1,.6],[-1,-.6],[1,.6],[1,-.6],[-.6,1],[-.6,-1],[.6,1],[.6,-1]];function mo(e){let t=[];for(let n=0;n<8;n++){let r=[];for(let t=0;t<8;t++)r.push({xy:ur(e.xy.x+n*120,e.xy.y+t*120),wh:ur(120,120)});t.push(r)}return t}function ho(e){let t=U(e),n=7-Mr(e);return dr(dr(ur(t/8*Pa.wh.x,n/8*Pa.wh.y),Pa.xy),pr(Pa.wh,1/16))}function go(e){let t=fr(e,Pa.xy),n=Pa.wh.x,r=Math.floor(t.x/n*8),i=Math.floor(t.y/n*8);if(!(r<0||r>7||i<0||i>7))return Nr(r,7-i)}function _o(){let e=new Map;if(!Ra)return e;for(let t of Ra)e.set(t.pieces,t.sq??t.sq_base);return e}function vo(){}var Q,yo;function bo(e,t){Q=e,yo=t}var xo=e=>{},So=e=>{},Co=()=>{};function wo(){return{set_muted(e){ja=e},set_update_fen(e){So=e},set_update_steps(e){xo=e},set_update_solved(e){Co=e},load_position:(e,t,n)=>{Ha(e,t,n)}}}var To={_set_ctx(e,t){},_init(){},_update(e){},_render(){},_cleanup(){},next_scene(){}},$,Eo;function Do(e){Eo._cleanup?.(),Eo=e}var Oo={simulate:Aa};function ko(){$=To,Eo=$,Do(Aa)}function Ao(e){Eo!==$&&($=Eo,$._set_ctx(Io,Lo),$._init(),Fo(wo())),$._update(e);let t=$.next_scene();t!==void 0&&Do(Oo[t]),Lo.update(e)}function jo(){$._render()}function Mo(){$._after_render?.()}function No(){$._cleanup(),Po.cleanup()}var Po,Fo,Io,Lo;async function Ro(e){ko(),Po=xr(1080,1080,e,jo),Io=Po.batch,Lo=wr(1080,1080,Po.canvas),await Ma.load();let t=Sr(Ao,jo,Mo);return{canvas:Po.canvas,cleanup:()=>{t(),No()},request_api:()=>new Promise(e=>Fo=e)}}var zo=j(`<div class="w-full h-full flex justify-content items-center">`);const Bo=e=>{let t,n=null,r={fen:void 0,target:void 0,steps:void 0,shouldEngineLoad(e,t,n){return!(this.fen===e&&this.target===t&&this.steps===n)},setEngineState(e,t,n){this.fen=e,this.target=t,this.steps=n}};async function i(){let e=await Ro(t);return n=await e.request_api(),a(n),e}ce(()=>{let{on_new_renderFn:e,on_destroy:n}=Dr(t);E(()=>{e(i)}),le(()=>{n()})});let a=t=>{t.set_muted(o),t.set_update_fen(t=>{r.fen=t,queueMicrotask(()=>{e.set_update_fen(t)})}),t.set_update_steps(t=>{r.steps=t,queueMicrotask(()=>{e.set_update_steps(t)})}),t.set_update_solved(()=>{queueMicrotask(()=>{e.set_update_solved()})});let n=e.fen,i=e.target,a=e.nb_steps??0;n&&i&&(r.setEngineState(n,i,a),t.load_position(n,i,a))},o=!1;return E(()=>{o=e.is_muted,n&&n.set_muted(o)}),E(()=>{let t=e.fen,i=e.target,a=e.nb_steps??0;n&&(!t||!i||r.shouldEngineLoad(t,i,a)&&(r.setEngineState(t,i,a),n.load_position(t,i,a)))}),(()=>{var e=zo(),n=t;return typeof n==`function`?At(n,e):t=e,e})()};var Vo=async(e,t)=>{let n=new AbortController;setTimeout(()=>n.abort(),1e4);let r=await fetch(`https://api.morchess.com`+e,{...t,credentials:`include`,signal:n.signal});if(!r.ok){let e=await r.text();throw Error(`API ${r.status}: ${e}`)}return r.json()};async function Ho(e,t={}){return await Vo(e,{method:`POST`,headers:{"Content-Type":`application/json`},body:JSON.stringify(t)})}var Uo=()=>{let e=[];for(let t=1;t<100;t++)e.push({rank:t,handle:`hello`+t,score:Math.floor(Math.random()*100)});return e};Uo(),Uo();function Wo(){return{async daily_leaderboard(){return Vo(`/daily`)},async weekly_leaderboard(){return Vo(`/weekly`)},async monthly_leaderboard(){return Vo(`/monthly`)},async yearly_leaderboard(){return Vo(`/yearly`)},async set_leaderboard_handle(e){return Ho(`/handle`,{handle:e})},async send_daily_score(e,t){return Ho(`/score`,{hash:await Go(e,t),score:e,difficulty:t})}}}async function Go(e,t){let n=new TextEncoder,r=`s3cr3t-s@lt:${t}:${e}`,i=await crypto.subtle.digest(`SHA-256`,n.encode(r));return[...new Uint8Array(i)].map(e=>e.toString(16).padStart(2,`0`)).join(``)}var Ko={a:{nb_total:0,list:[],you:void 0},b:{nb_total:0,list:[],you:void 0},c:{nb_total:0,list:[],you:void 0}};function qo(e){let t=Wo(),[n,r]=w(void 0,{equals:!1}),[i,a]=w(!1),[o,s]=w(!1),[c,l]=w(!1),u=ar(()=>(n(),t.daily_leaderboard()),{initialValue:Ko}),d=ar(()=>i()?t.weekly_leaderboard():new Promise(()=>{}),{initialValue:Ko}),f=ar(()=>o()?t.monthly_leaderboard():new Promise(()=>{}),{initialValue:Ko}),p=ar(()=>c()?t.yearly_leaderboard():new Promise(()=>{}),{initialValue:Ko});return[{get daily(){return u.latest},get weekly(){return d.latest},get monthly(){return f.latest},get yearly(){return p.latest}},{async set_leaderboard_handle(e){let n=await t.set_leaderboard_handle(e);return r(),a(!1),s(!1),l(!1),a(!0),s(!0),l(!0),n},async send_daily_score(e,n){let i=await t.send_daily_score(e,n);return r(),a(!1),s(!1),l(!1),a(!0),s(!0),l(!0),i},fetch_period(e){e===`daily`?r(void 0):e===`weekly`?a(!0):e===`monthly`?s(!0):e===`yearly`&&l(!0)}}]}var Jo=class{seed;constructor(e){this.seed=this.normalizeSeed(e)}normalizeSeed(e){if(typeof e==`number`)return Math.abs(Math.floor(e));let t=0;for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);t=(t<<5)-t+r,t&=t}return Math.abs(t)}next(){this.seed+=1831565813;let e=this.seed;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}nextFloat(e,t){return e+(t-e)*this.next()}nextInt(e,t){return Math.floor(this.nextFloat(e,t))}nextBoolean(){return this.next()>.5}pick(e){return e[this.nextInt(0,e.length)]}shuffle(e){let t=[...e];for(let e=t.length-1;e>0;e--){let n=this.nextInt(0,e+1);[t[e],t[n]]=[t[n],t[e]]}return t}};function Yo(e=new Date,t=``){return new Jo(`${e.toISOString().split(`T`)[0]}${t}`)}function Xo(e,t=``){return Yo(new Date,t).pick(e)}var Zo=new class{startUTCDate;constructor(e=new Date().toISOString().split(`T`)[0]){this.startUTCDate=e}getTodaysId(){let e=new Date().toISOString().split(`T`)[0];return this.daysBetween(this.startUTCDate,e)}getIdForUTCDate(e){return this.daysBetween(this.startUTCDate,e)}daysBetween(e,t){let n=new Date(e+`T00:00:00Z`),r=new Date(t+`T00:00:00Z`).getTime()-n.getTime(),i=Math.floor(r/(1e3*60*60*24));return Math.max(0,i)}getUTCDateForId(e){let t=new Date(this.startUTCDate+`T00:00:00Z`);return new Date(t.getTime()+e*24*60*60*1e3).toISOString().split(`T`)[0]}}(`2026-01-01`);function Qo(){return Zo.getTodaysId()}var $o=class e{occupied;promoted;white;black;pawn;knight;bishop;rook;queen;king;constructor(){}static default(){let t=new e;return t.reset(),t}reset(){this.occupied=new J(65535,4294901760),this.promoted=J.empty(),this.white=new J(65535,0),this.black=new J(0,4294901760),this.pawn=new J(65280,16711680),this.knight=new J(66,1107296256),this.bishop=new J(36,603979776),this.rook=new J(129,2164260864),this.queen=new J(8,134217728),this.king=new J(16,268435456)}static empty(){let t=new e;return t.clear(),t}clear(){this.occupied=J.empty(),this.promoted=J.empty();for(let e of Ar)this[e]=J.empty();for(let e of B)this[e]=J.empty()}clone(){let t=new e;t.occupied=this.occupied,t.promoted=this.promoted;for(let e of Ar)t[e]=this[e];for(let e of B)t[e]=this[e];return t}getColor(e){if(this.white.has(e))return`white`;if(this.black.has(e))return`black`}getRole(e){for(let t of B)if(this[t].has(e))return t}get(e){let t=this.getColor(e);if(t)return{color:t,role:this.getRole(e),promoted:this.promoted.has(e)}}take(e){let t=this.get(e);return t&&(this.occupied=this.occupied.without(e),this[t.color]=this[t.color].without(e),this[t.role]=this[t.role].without(e),t.promoted&&(this.promoted=this.promoted.without(e))),t}set(e,t){let n=this.take(e);return this.occupied=this.occupied.with(e),this[t.color]=this[t.color].with(e),this[t.role]=this[t.role].with(e),t.promoted&&(this.promoted=this.promoted.with(e)),n}has(e){return this.occupied.has(e)}*[Symbol.iterator](){for(let e of this.occupied)yield[e,this.get(e)]}pieces(e,t){return this[e].intersect(this[t])}rooksAndQueens(){return this.rook.union(this.queen)}bishopsAndQueens(){return this.bishop.union(this.queen)}kingOf(e){return this.pieces(e,`king`).singleSquare()}},es=class e{pawn;knight;bishop;rook;queen;king;constructor(){}static empty(){let t=new e;for(let e of B)t[e]=0;return t}static fromBoard(t,n){let r=new e;for(let e of B)r[e]=t.pieces(n,e).size();return r}clone(){let t=new e;for(let e of B)t[e]=this[e];return t}equals(e){return B.every(t=>this[t]===e[t])}add(t){let n=new e;for(let e of B)n[e]=this[e]+t[e];return n}subtract(t){let n=new e;for(let e of B)n[e]=this[e]-t[e];return n}nonEmpty(){return B.some(e=>this[e]>0)}isEmpty(){return!this.nonEmpty()}hasPawns(){return this.pawn>0}hasNonPawns(){return this.knight>0||this.bishop>0||this.rook>0||this.queen>0||this.king>0}size(){return this.pawn+this.knight+this.bishop+this.rook+this.queen+this.king}},ts=class e{white;black;constructor(e,t){this.white=e,this.black=t}static empty(){return new e(es.empty(),es.empty())}static fromBoard(t){return new e(es.fromBoard(t,`white`),es.fromBoard(t,`black`))}clone(){return new e(this.white.clone(),this.black.clone())}equals(e){return this.white.equals(e.white)&&this.black.equals(e.black)}add(t){return new e(this.white.add(t.white),this.black.add(t.black))}subtract(t){return new e(this.white.subtract(t.white),this.black.subtract(t.black))}count(e){return this.white[e]+this.black[e]}size(){return this.white.size()+this.black.size()}isEmpty(){return this.white.isEmpty()&&this.black.isEmpty()}nonEmpty(){return!this.isEmpty()}hasPawns(){return this.white.hasPawns()||this.black.hasPawns()}hasNonPawns(){return this.white.hasNonPawns()||this.black.hasNonPawns()}},ns=class e{white;black;constructor(e,t){this.white=e,this.black=t}static default(){return new e(3,3)}clone(){return new e(this.white,this.black)}equals(e){return this.white===e.white&&this.black===e.black}},rs=class{cache;capacity;constructor(e){this.capacity=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;let t=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,t),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.capacity){let e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t)}},is=(e,t,n,r)=>n[t].intersect(ua(e,r).intersect(n.rooksAndQueens()).union(la(e,r).intersect(n.bishopsAndQueens())).union(ea(e).intersect(n.knight)).union($i(e).intersect(n.king)).union(ta(H(t),e).intersect(n.pawn))),as=class e{castlingRights;rook;path;constructor(){}static default(){let t=new e;return t.castlingRights=J.corners(),t.rook={white:{a:0,h:7},black:{a:56,h:63}},t.path={white:{a:new J(14,0),h:new J(96,0)},black:{a:new J(0,234881024),h:new J(0,1610612736)}},t}static empty(){let t=new e;return t.castlingRights=J.empty(),t.rook={white:{a:void 0,h:void 0},black:{a:void 0,h:void 0}},t.path={white:{a:J.empty(),h:J.empty()},black:{a:J.empty(),h:J.empty()}},t}clone(){let t=new e;return t.castlingRights=this.castlingRights,t.rook={white:{a:this.rook.white.a,h:this.rook.white.h},black:{a:this.rook.black.a,h:this.rook.black.h}},t.path={white:{a:this.path.white.a,h:this.path.white.h},black:{a:this.path.black.a,h:this.path.black.h}},t}add(e,t,n,r){let i=Rr(e,t),a=zr(e,t);this.castlingRights=this.castlingRights.with(r),this.rook[e][t]=r,this.path[e][t]=ma(r,a).with(a).union(ma(n,i).with(i)).without(n).without(r)}static fromSetup(t){let n=e.empty(),r=t.castlingRights.intersect(t.board.rook);for(let e of Ar){let i=J.backrank(e),a=t.board.kingOf(e);if(!V(a)||!i.has(a))continue;let o=r.intersect(t.board[e]).intersect(i),s=o.first();V(s)&&s<a&&n.add(e,`a`,a,s);let c=o.last();V(c)&&a<c&&n.add(e,`h`,a,c)}return n}discardRook(e){if(this.castlingRights.has(e)){this.castlingRights=this.castlingRights.without(e);for(let t of Ar)for(let n of jr)this.rook[t][n]===e&&(this.rook[t][n]=void 0)}}discardColor(e){this.castlingRights=this.castlingRights.diff(J.backrank(e)),this.rook[e].a=void 0,this.rook[e].h=void 0}},os=class{board;pockets;turn;castles;epSquare;remainingChecks;halfmoves;fullmoves;rules;constructor(e){this.rules=e}reset(){this.board=$o.default(),this.pockets=void 0,this.turn=`white`,this.castles=as.default(),this.epSquare=void 0,this.remainingChecks=void 0,this.halfmoves=0,this.fullmoves=1}setupUnchecked(e){this.board=e.board.clone(),this.board.promoted=J.empty(),this.pockets=void 0,this.turn=e.turn,this.castles=as.fromSetup(e),this.epSquare=cs(this,e.epSquare),this.remainingChecks=void 0,this.halfmoves=e.halfmoves,this.fullmoves=e.fullmoves}kingAttackers(e,t,n){return is(e,t,this.board,n)}playCaptureAt(e,t){this.halfmoves=0,t.role===`rook`&&this.castles.discardRook(e),this.pockets&&this.pockets[H(t.color)][t.promoted?`pawn`:t.role]++}ctx(){let e=this.isVariantEnd(),t=this.board.kingOf(this.turn);if(!V(t))return{king:t,blockers:J.empty(),checkers:J.empty(),variantEnd:e,mustCapture:!1};let n=ua(t,J.empty()).intersect(this.board.rooksAndQueens()).union(la(t,J.empty()).intersect(this.board.bishopsAndQueens())).intersect(this.board[H(this.turn)]),r=J.empty();for(let e of n){let n=ma(t,e).intersect(this.board.occupied);n.moreThanOne()||(r=r.union(n))}let i=this.kingAttackers(t,H(this.turn),this.board.occupied);return{king:t,blockers:r,checkers:i,variantEnd:e,mustCapture:!1}}clone(){let e=new this.constructor;return e.board=this.board.clone(),e.pockets=this.pockets?.clone(),e.turn=this.turn,e.castles=this.castles.clone(),e.epSquare=this.epSquare,e.remainingChecks=this.remainingChecks?.clone(),e.halfmoves=this.halfmoves,e.fullmoves=this.fullmoves,e}dropDests(e){return J.empty()}c_cache=new rs(64);dests(e,t){let n=this.c_cache.get(e+``);if(n)return n;if(t||=this.ctx(),t.variantEnd)return J.empty();let r=this.board.get(e);if(!r||r.color!==this.turn)return J.empty();let i,a;if(r.role===`pawn`){i=ta(this.turn,e).intersect(this.board[H(this.turn)]);let n=this.turn===`white`?8:-8,r=e+n;if(0<=r&&r<64&&!this.board.occupied.has(r)){i=i.with(r);let t=this.turn===`white`?e<16:e>=48,a=r+n;t&&!this.board.occupied.has(a)&&(i=i.with(a))}V(this.epSquare)&&us(this,e,t)&&(a=J.fromSquare(this.epSquare))}else i=r.role===`bishop`?la(e,this.board.occupied):r.role===`knight`?ea(e):r.role===`rook`?ua(e,this.board.occupied):r.role===`queen`?da(e,this.board.occupied):$i(e);if(i=i.diff(this.board[this.turn]),V(t.king)){if(r.role===`king`){let n=this.board.occupied.without(e);for(let e of i)this.kingAttackers(e,H(this.turn),n).nonEmpty()&&(i=i.without(e));return i.union(ds(this,`a`,t)).union(ds(this,`h`,t))}if(t.checkers.nonEmpty()){let e=t.checkers.singleSquare();if(!V(e))return J.empty();i=i.intersect(ma(e,t.king).with(e))}t.blockers.has(e)&&(i=i.intersect(pa(e,t.king)))}return a&&(i=i.union(a)),this.c_cache.put(e+``,i),i}pseudo_dests(e,t){if(t||=this.ctx(),t.variantEnd)return J.empty();let n=this.board.get(e);if(!n||n.color!==this.turn)return J.empty();let r,i;if(n.role===`pawn`){r=ta(this.turn,e);let n=this.turn===`white`?8:-8,a=e+n;if(0<=a&&a<64&&!this.board.occupied.has(a)){r=r.with(a);let t=this.turn===`white`?e<16:e>=48,i=a+n;t&&!this.board.occupied.has(i)&&(r=r.with(i))}V(this.epSquare)&&us(this,e,t)&&(i=J.fromSquare(this.epSquare))}else r=n.role===`bishop`?la(e,this.board.occupied):n.role===`knight`?ea(e):n.role===`rook`?ua(e,this.board.occupied):n.role===`queen`?da(e,this.board.occupied):$i(e);if(V(t.king)){if(n.role===`king`)return r.union(ds(this,`a`,t)).union(ds(this,`h`,t));if(t.checkers.nonEmpty()){let e=t.checkers.singleSquare();if(!V(e))return J.empty();r=r.intersect(ma(e,t.king).with(e))}t.blockers.has(e)&&(r=r.intersect(pa(e,t.king)))}return i&&(r=r.union(i)),r}isVariantEnd(){return!1}variantOutcome(e){}hasInsufficientMaterial(e){return this.board[e].intersect(this.board.pawn.union(this.board.rooksAndQueens())).nonEmpty()?!1:this.board[e].intersects(this.board.knight)?this.board[e].size()<=2&&this.board[H(e)].diff(this.board.king).diff(this.board.queen).isEmpty():this.board[e].intersects(this.board.bishop)?(!this.board.bishop.intersects(J.darkSquares())||!this.board.bishop.intersects(J.lightSquares()))&&this.board.pawn.isEmpty()&&this.board.knight.isEmpty():!0}toSetup(){return{board:this.board.clone(),pockets:this.pockets?.clone(),turn:this.turn,castlingRights:this.castles.castlingRights,epSquare:ls(this),remainingChecks:this.remainingChecks?.clone(),halfmoves:Math.min(this.halfmoves,150),fullmoves:Math.min(Math.max(this.fullmoves,1),9999)}}isInsufficientMaterial(){return Ar.every(e=>this.hasInsufficientMaterial(e))}hasDests(e){e||=this.ctx();for(let t of this.board[this.turn])if(this.dests(t,e).nonEmpty())return!0;return this.dropDests(e).nonEmpty()}isLegal(e,t){{if(e.promotion===`pawn`||e.promotion===`king`&&this.rules!==`antichess`||!!e.promotion!==(this.board.pawn.has(e.from)&&J.backranks().has(e.to)))return!1;let n=this.dests(e.from,t);return n.has(e.to)||n.has(ps(this,e).to)}}isCheck(){let e=this.board.kingOf(this.turn);return V(e)&&this.kingAttackers(e,H(this.turn),this.board.occupied).nonEmpty()}isEnd(e){return(e?e.variantEnd:this.isVariantEnd())?!0:this.isInsufficientMaterial()||!this.hasDests(e)}isCheckmate(e){return e||=this.ctx(),!e.variantEnd&&e.checkers.nonEmpty()&&!this.hasDests(e)}isStalemate(e){return e||=this.ctx(),!e.variantEnd&&e.checkers.isEmpty()&&!this.hasDests(e)}outcome(e){let t=this.variantOutcome(e);if(t)return t;if(e||=this.ctx(),this.isCheckmate(e))return{winner:H(this.turn)};if(this.isInsufficientMaterial()||this.isStalemate(e))return{winner:void 0}}allDests(e){e||=this.ctx();let t=new Map;if(e.variantEnd)return t;for(let n of this.board[this.turn])t.set(n,this.dests(n,e));return t}play(e){let t=this.turn,n=this.epSquare,r=fs(this,e);this.epSquare=void 0,this.halfmoves+=1,t===`black`&&(this.fullmoves+=1),this.turn=H(t);{let i=this.board.take(e.from);if(!i)return;let a;if(i.role===`pawn`){this.halfmoves=0,e.to===n&&(a=this.board.take(e.to+(t===`white`?-8:8)));let r=e.from-e.to;Math.abs(r)===16&&8<=e.from&&e.from<=55&&(this.epSquare=e.from+e.to>>1),e.promotion&&(i.role=e.promotion,i.promoted=!!this.pockets)}else if(i.role===`rook`)this.castles.discardRook(e.from);else if(i.role===`king`){if(r){let e=this.castles.rook[t][r];if(V(e)){let n=this.board.take(e);this.board.set(Rr(t,r),i),n&&this.board.set(zr(t,r),n)}}this.castles.discardColor(t)}if(!r){let t=this.board.set(e.to,i)||a;t&&this.playCaptureAt(e.to,t)}}this.remainingChecks&&this.isCheck()&&(this.remainingChecks[t]=Math.max(this.remainingChecks[t]-1,0))}},ss=class extends os{constructor(){super(`chess`)}static default(){let e=new this;return e.reset(),e}static fromSetupUnchecked(e){let t=new this;return t.setupUnchecked(e),t}clone(){return super.clone()}},cs=(e,t)=>{if(!V(t))return;let n=e.turn===`white`?5:2,r=e.turn===`white`?8:-8;if(Mr(t)!==n||e.board.occupied.has(t+r))return;let i=t-r;if(!(!e.board.pawn.has(i)||!e.board[H(e.turn)].has(i)))return t},ls=e=>{if(!V(e.epSquare))return;let t=e.ctx(),n=e.board.pieces(e.turn,`pawn`).intersect(ta(H(e.turn),e.epSquare));for(let r of n)if(e.dests(r,t).has(e.epSquare))return e.epSquare},us=(e,t,n)=>{if(!V(e.epSquare)||!ta(e.turn,t).has(e.epSquare))return!1;if(!V(n.king))return!0;let r=e.turn===`white`?8:-8,i=e.epSquare-r;return e.kingAttackers(n.king,H(e.turn),e.board.occupied.toggle(t).toggle(i).with(e.epSquare)).without(i).isEmpty()},ds=(e,t,n)=>{if(!V(n.king)||n.checkers.nonEmpty())return J.empty();let r=e.castles.rook[e.turn][t];if(!V(r)||e.castles.path[e.turn][t].intersects(e.board.occupied))return J.empty();let i=Rr(e.turn,t),a=ma(n.king,i),o=e.board.occupied.without(n.king);for(let t of a)if(e.kingAttackers(t,H(e.turn),o).nonEmpty())return J.empty();let s=zr(e.turn,t),c=e.board.occupied.toggle(n.king).toggle(r).toggle(s);return e.kingAttackers(i,H(e.turn),c).nonEmpty()?J.empty():J.fromSquare(r)};const fs=(e,t)=>{let n=t.to-t.from;if(!(Math.abs(n)!==2&&!e.board[e.turn].has(t.to))&&e.board.king.has(t.from))return n>0?`h`:`a`},ps=(e,t)=>{let n=fs(e,t);if(!n)return t;let r=e.castles.rook[e.turn][n];return{from:t.from,to:V(r)?r:t.to}};var ms=(e,t,n)=>{let r=e.indexOf(t);for(;n-- >0&&r!==-1;)r=e.indexOf(t,r+t.length);return r},hs=e=>/^\d{1,4}$/.test(e)?parseInt(e,10):void 0,gs=e=>{let t=Fr(e);return t&&{role:t,color:e.toLowerCase()===e?`black`:`white`}};const _s=e=>{let t=$o.empty(),n=7,r=0;for(let i=0;i<e.length;i++){let a=e[i];if(a===`/`&&r===8)r=0,n--;else{let o=parseInt(a,10);if(o>0)r+=o;else{if(r>=8||n<0)return q.err();let o=r+n*8,s=gs(a);if(!s)return q.err();e[i+1]===`~`&&(s.promoted=!0,i++),t.set(o,s),r++}}}return n!==0||r!==8?q.err():q.ok(t)},vs=e=>{if(e.length>64)return q.err();let t=ts.empty();for(let n of e){let e=gs(n);if(!e)return q.err();t[e.color][e.role]++}return q.ok(t)},ys=(e,t)=>{let n=J.empty();if(t===`-`)return q.ok(n);for(let r of t){let t=r.toLowerCase(),i=r===t?`black`:`white`,a=i===`white`?0:7;if(`a`<=t&&t<=`h`)n=n.with(Nr(t.charCodeAt(0)-97,a));else if(t===`k`||t===`q`){let r=e[i].intersect(J.backrank(i)).intersect(e.rook.union(e.king)),o=t===`k`?r.last():r.first();n=n.with(V(o)&&e.rook.has(o)?o:Nr(t===`k`?7:0,a))}else return q.err()}return Ar.some(e=>J.backrank(e).intersect(n).size()>2)?q.err():q.ok(n)},bs=e=>{let t=e.split(`+`);if(t.length===3&&t[0]===``){let e=hs(t[1]),n=hs(t[2]);return!V(e)||e>3||!V(n)||n>3?q.err():q.ok(new ns(3-e,3-n))}else if(t.length===2){let e=hs(t[0]),n=hs(t[1]);return!V(e)||e>3||!V(n)||n>3?q.err():q.ok(new ns(e,n))}else return q.err()},xs=e=>{let t=e.split(/[\s_]+/),n=t.shift(),r,i=q.ok(void 0);if(n.endsWith(`]`)){let e=n.indexOf(`[`);if(e===-1)return q.err();r=_s(n.slice(0,e)),i=vs(n.slice(e+1,-1))}else{let e=ms(n,`/`,7);e===-1?r=_s(n):(r=_s(n.slice(0,e)),i=vs(n.slice(e+1)))}let a,o=t.shift();if(!V(o)||o===`w`)a=`white`;else if(o===`b`)a=`black`;else return q.err();return r.chain(e=>{let n=t.shift(),r=V(n)?ys(e,n):q.ok(J.empty()),o=t.shift(),s;if(V(o)&&o!==`-`&&(s=Ir(o),!V(s)))return q.err();let c=t.shift(),l;V(c)&&c.includes(`+`)&&(l=bs(c),c=t.shift());let u=V(c)?hs(c):0;if(!V(u))return q.err();let d=t.shift(),f=V(d)?hs(d):1;if(!V(f))return q.err();let p=t.shift(),m=q.ok(void 0);if(V(p)){if(V(l))return q.err();m=bs(p)}else V(l)&&(m=l);return t.length>0?q.err():i.chain(t=>r.chain(n=>m.map(r=>({board:e,pockets:t,turn:a,castlingRights:n,remainingChecks:r,epSquare:s,halfmoves:u,fullmoves:Math.max(1,f)}))))})},Ss=e=>{let t=Pr(e.role);return e.color===`white`&&(t=t.toUpperCase()),e.promoted&&(t+=`~`),t},Cs=e=>{let t=``,n=0;for(let r=7;r>=0;r--)for(let i=0;i<8;i++){let a=i+r*8,o=e.get(a);o?(n>0&&(t+=n,n=0),t+=Ss(o)):n++,i===7&&(n>0&&(t+=n,n=0),r!==0&&(t+=`/`))}return t},ws=e=>B.map(t=>Pr(t).repeat(e[t])).join(``),Ts=e=>ws(e.white).toUpperCase()+ws(e.black),Es=(e,t)=>{let n=``;for(let r of Ar){let i=J.backrank(r),a=e.kingOf(r);V(a)&&!i.has(a)&&(a=void 0);let o=e.pieces(r,`rook`).intersect(i);for(let e of t.intersect(i).reversed())if(e===o.first()&&V(a)&&e<a)n+=r===`white`?`Q`:`q`;else if(e===o.last()&&V(a)&&a<e)n+=r===`white`?`K`:`k`;else{let t=Or[U(e)];n+=r===`white`?t.toUpperCase():t}}return n||`-`},Ds=e=>`${e.white}+${e.black}`,Os=(e,t)=>[Cs(e.board)+(e.pockets?`[${Ts(e.pockets)}]`:``),e.turn[0],Es(e.board,e.castlingRights),V(e.epSquare)?Lr(e.epSquare):`-`,...e.remainingChecks?[Ds(e.remainingChecks)]:[],...t?.epd?[]:[Math.max(0,Math.min(e.halfmoves,9999)),Math.max(1,Math.min(e.fullmoves,9999))]].join(` `);var ks=()=>fetch(`/fens_tenk.txt`).then(e=>e.text()).then(e=>e.split(`
`)),As=class{static daily_puzzle_set=async()=>{let e=await ks(),t=Xo(e,`a`),n=Xo(e,`b`),r=Xo(e,`c`);t=Ns(t),n=Ps(n),t=js(t),n=Ms(n);let i=Qo()*3;return{a:{id:i,fen:t},b:{id:i+1,fen:n},c:{id:i+2,fen:r}}};static todays_date=async()=>new Date};function js(e){let t=ss.fromSetupUnchecked(xs(e).unwrap()),n=[];n=[];for(let e of t.board.bishop)n.push(e);for(let e=2;e<n.length;e++)t.board.take(n[e]);n=[];for(let e of t.board.knight)n.push(e);for(let e=2;e<n.length;e++)t.board.take(n[e]);n=[];for(let e of t.board.rook)n.push(e);for(let e=2;e<n.length;e++)t.board.take(n[e]);return Os(t.toSetup())}function Ms(e){let t=ss.fromSetupUnchecked(xs(e).unwrap()),n=[];n=[];for(let e of t.board.bishop)n.push(e);for(let e=3;e<n.length;e++)t.board.take(n[e]);n=[];for(let e of t.board.knight)n.push(e);for(let e=3;e<n.length;e++)t.board.take(n[e]);n=[];for(let e of t.board.rook)n.push(e);for(let e=3;e<n.length;e++)t.board.take(n[e]);return Os(t.toSetup())}function Ns(e){let t=ss.fromSetupUnchecked(xs(e).unwrap());for(let e of t.board.pawn)t.board.take(e);return Os(t.toSetup())}function Ps(e){let t=ss.fromSetupUnchecked(xs(e).unwrap()),n=t.board.pawn.size();for(let e of t.board.pawn){if(n--<4)break;t.board.take(e)}return Os(t.toSetup())}function Fs(e){let t=ss.fromSetupUnchecked(xs(e).unwrap()),n=xa(),r=[],i=()=>Math.floor(Math.random()*64);for(let e of t.board.occupied){let a=t.board.get(e),o=i();for(;r.includes(o);)o=i();r.push(o),n.board.set(o,a)}return Os(n.toSetup())}function Is(e,t={}){let n=t.storage||globalThis.localStorage,r=t.name||`storage-${et()}`;if(!n)return[e[0],e[1],null];let i=t.storageOptions,a=t.serialize||JSON.stringify.bind(JSON),o=t.deserialize||JSON.parse.bind(JSON),s=n.getItem(r,i),c=typeof e[0]==`function`?t=>{try{let n=o(t);e[1](()=>n)}catch{}}:t=>{try{let n=o(t);e[1](ir(n))}catch{}},l=!0;if(s instanceof Promise?s.then(e=>l&&e&&c(e)):s&&c(s),typeof t.sync?.[0]==`function`){let n=typeof e[0]==`function`?e[0]:()=>e[0];t.sync[0](e=>{e.key!==r||(e.url||globalThis.location.href)!==globalThis.location.href||e.newValue===a(O(n))||c(e.newValue)})}return[e[0],typeof e[0]==`function`?o=>{let s=e[1](o),c=o==null?o:a(s);return t.sync?.[1](r,c),c==null?n.removeItem(r,i):n.setItem(r,c,i),l=!1,s}:(...o)=>{e[1](...o);let s=a(O(()=>e[0]));t.sync?.[1](r,s),n.setItem(r,s,i),l=!1},s]}function Ls(e){let t=ar(()=>As.daily_puzzle_set()),n=ar(()=>As.todays_date()),[r,i]=Is(tr({sound_enabled:!0,daily_selected_tier:`b`,saved_daily_puzzle_set:void 0}),{name:`.morchess.puzzles-store.v1`});function a(){let e=r.saved_daily_puzzle_set,n=t();if(n){if(!e||e.a.base_fen!==n.a.fen){let e=e=>({id:e.id,base_fen:e.fen,fen:Fs(e.fen),stats:{nb_steps:0}}),t={a:e(n.a),b:e(n.b),c:e(n.c)};return i(`saved_daily_puzzle_set`,t),t}return e}}return[{get sound_enabled(){return r.sound_enabled},get daily_selected_tier(){return r.daily_selected_tier},get saved_daily_puzzle_set(){return a()},get stats(){return r.saved_daily_puzzle_set?.[r.daily_selected_tier].stats},get today(){return n()}},{set_sound_enabled(e){i(`sound_enabled`,e)},set_daily_tier(e){i(`daily_selected_tier`,e)},set_daily_steps(e){let t=r.daily_selected_tier;t&&i(`saved_daily_puzzle_set`,t,`stats`,`nb_steps`,e)},set_daily_fen(e){let t=r.daily_selected_tier;t&&i(`saved_daily_puzzle_set`,t,`fen`,e)},set_shuffle(){let e=r.daily_selected_tier;if(!e)return;let t=r.saved_daily_puzzle_set[e].fen;i(`saved_daily_puzzle_set`,e,`fen`,Fs(t))},set_reveal(){let e=r.daily_selected_tier;if(!e)return;let t=r.saved_daily_puzzle_set[e].stats.nb_steps;i(`saved_daily_puzzle_set`,e,`fen`,r.saved_daily_puzzle_set[e].base_fen),!(r.saved_daily_puzzle_set[e].stats.nb_solved!==void 0||r.saved_daily_puzzle_set[e].stats.nb_revealed!==void 0)&&i(`saved_daily_puzzle_set`,e,`stats`,`nb_revealed`,t)},set_solved(){let t=r.daily_selected_tier;if(!t||r.saved_daily_puzzle_set[t].stats.nb_solved!==void 0||r.saved_daily_puzzle_set[t].stats.nb_revealed!==void 0)return;let n=r.saved_daily_puzzle_set[t].stats.nb_steps;i(`saved_daily_puzzle_set`,t,`stats`,`nb_solved`,n);let a=n,[,{send_daily_score:o}]=e.leaderboards;o(a,t)}}]}var Rs=j(`<svg><path stroke-linecap=round stroke-linejoin=round stroke-width=2></svg>`,!1,!0,!1);function zs(e){return()=>(()=>{var t=Rs();return Ct(t,`d`,e),t})()}const Bs={cursor:zs(`m 150.036,266.494
c -0.264,0 -0.517,-0.006 -0.792,-0.018 -6.102,-0.337 -11.332,-4.474 -13.046,-10.347
L 110.131,167.102 14.928,148.235
C 8.914,147.041 4.314,142.176 3.452,136.112 2.594,130.05 5.653,124.096 11.102,121.28
L 242.143,1.617
c 5.357,-2.792 11.914,-1.907 16.375,2.183 4.474,4.101 5.885,10.55 3.562,16.146
l -98.743,237.655
c -2.24,5.417 -7.501,8.893 -13.301,8.893
z`),pawn:zs(`M 25,46.448
H 11.606
c -0.658745,-1.599443 -0.99518,-3.313221 -0.99,-5.043 0,-2.975 0.863,-5.644 2.598,-8.018 1.736,-2.365 3.971,-4.054 6.697,-5.067 -1.158016,-0.517874 -2.148758,-1.348283 -2.861,-2.398 -0.737,-1.071 -1.1,-2.283 -1.1,-3.634 0,-1.69 0.575,-3.156 1.735,-4.392 1.151,-1.244 2.574,-1.961 4.267,-2.15 -1.346,-0.981 -2.015,-2.283 -2.015,-3.89 0,-1.351 0.491,-2.513 1.482,-3.477 0.982,-0.964 2.176,-1.442 3.581,-1.442 1.389,0 0,39.511 0,39.511
z`),queen:zs(`m 24.95,10.752
c -0.94,0 -1.745,-0.33 -2.397,-0.99 -0.652,-0.66 -0.974,-1.465 -0.974,-2.405 0,-0.931 0.322,-1.727 0.974,-2.387 0.652,-0.66 1.456,-0.99 2.396,-0.99 4.457047,0 4.4506,6.772 0,6.772
z

M 25,46.448
c -3.75,0 -7.053,-0.254 -9.898,-0.745 -2.844,-0.5 -4.64,-1.118 -5.384,-1.863
L 11.284,37.888 10.59,33.993 8.405,30.2 6.297,14.774 7.507,14.3
l 6.8,11.455 0.152,-13.64 1.685,-0.296 5.182,13.716 2.776,-14.757
h 1.72
c 0,0 2.861,35.67 -0.822,35.67
z

M 14.535,11.989
c -0.948,0 -1.752,-0.322 -2.413,-0.974 -0.66,-0.652 -0.99,-1.456 -0.99,-2.396 0,-0.923 0.33,-1.719 0.99,-2.38 0.66,-0.661 1.465,-0.99 2.413,-0.99 0.923,0 1.719,0.33 2.38,0.99 0.661,0.66 0.99,1.457 0.99,2.38 0,0.94 -0.33,1.744 -0.99,2.396 -0.626755,0.636476 -1.486852,0.988465 -2.38,0.974
z

M 5.4,14.723
c -0.94,0 -1.736,-0.33 -2.388,-0.982
C 2.36,13.089 2.03,12.293 2.03,11.345 2.03,10.422 2.36,9.626 3.012,8.957 3.664,8.28 4.46,7.95 5.4,7.95
c 0.948,0 1.744,0.33 2.413,1.007 0.66,0.67 0.99,1.465 0.99,2.388 0,0.948 -0.33,1.744 -0.99,2.396 -0.6371462,0.642122 -1.508534,0.996744 -2.413,0.982
z`),rook:zs(`M 28.408,9.22 28.360227,46.509958 8.071,46.448
V 40.52
h 3.793
v -5.08
l 4.242,-4.216
V 19.363
L 10.602,15.121
V 5.825
h 6.774
V 9.22
h 4.242
V 5.825
h 6.79
z`),knight:zs(`m 26.178,9.395
c 3.717522,17.931492 -1.084802,22.136622 -1.084802,36.749211
L 15.468,46.454
c -0.152921,0.0049 -0.22,-0.407 -0.212,-1.21 0.009,-0.814 0.06,-1.466 0.16,-1.965 0.06,-0.398 0.221,-0.957 0.467,-1.685 0.254,-0.728 0.66,-1.609 1.244,-2.65 0.263,-0.534 0.89,-1.304 1.88,-2.32 0.999,-1.016 2.133,-2.201 3.429,-3.539 0.745,-0.762 1.32,-1.719 1.744,-2.879 0.423,-1.151 0.601,-2.201 0.533,-3.15 -0.608025,0.498896 -1.283334,0.909602 -2.006,1.22 -3.505,1.253 -6.045,3.073 -7.612,5.452 -0.118,0.153 -0.49,0.822 -1.117,2.015 -0.33,0.627 -0.618,1.059 -0.847,1.287 -0.313,0.314 -0.77,0.491 -1.363,0.525 -0.923,0.043 -1.643,-0.398 -2.16,-1.346
C 8.915,36.412 8.296,36.497 7.746,36.463 6.823,36.116 6.154,35.743 5.74,35.346 4.893,34.499 4.351,33.661 4.089,32.814 3.8293557,31.928859 3.7009886,31.01041 3.708,30.088
c 0,-1.389 0.855,-3.226 2.582,-5.512 2.015,-2.625 3.09,-4.631 3.217,-6.003 0,-0.593 0.06,-1.261 0.178,-2.007 0.107744,-0.531947 0.317618,-1.037953 0.618,-1.49 0.22,-0.33 0.364,-0.558 0.432,-0.677 0.076,-0.127 0.212,-0.313 0.415,-0.559 0.144,-0.203 0.27,-0.355 0.372,-0.457 0.093,-0.11 0.22,-0.254 0.373,-0.44 0.178,-0.212 0.406,-0.457 0.694,-0.745 -0.876289,-2.3839704 -1.23987,-4.9259689 -1.067,-7.46 3.285,1.169 6.054,3.015 8.28,5.53 0.551,-1.872 1.626,-3.387 3.226,-4.539 1.321,0.923 2.371,2.15 3.15,3.666
z`),bishop:zs(`m 21.939789,10.038494
c 0,-0.9319996 0.322,-1.7199996 0.974,-2.3879996 0.652,-0.66 1.456,-0.99 2.396,-0.99 0.923,0 1.719,0.33 2.38,0.99 0.66,0.669 0.99,1.456 0.99,2.3879996 0,1.354 -0.61,2.353 -1.83,2.997 0.893481,1.058851 1.867735,2.046813 2.914,2.955 1.00122,0.853917 2.031844,1.672746 3.09,2.455 1.236,0.94 2.083,2.015 2.523,3.209 0.449,1.202 0.694,2.294 0.72,3.285 0,0.567 -0.051,1.202 -0.17,1.913 -0.119,0.711 -0.38,1.448 -0.796,2.21 -0.327332,0.590922 -0.750791,1.123203 -1.253,1.575 -0.5,0.457 -1.388,1.05 -2.667,1.795
l 2.583,6.4
c -0.729,0.263 -1.55,0.517 -2.456,0.754 -0.914,0.246 -1.786,0.415 -2.633,0.508 0.381,0.517 0.77,0.906 1.168,1.169 0.398,0.262 0.695,0.448 0.898,0.55 0.347,0.195 1.016,0.296 2.007,0.296 0.896656,-0.134633 1.794001,-0.264635 2.692,-0.39 0.908227,-0.119978 1.814357,-0.255331 2.718,-0.406 0.44,0.051 0.889,0.068 1.346,0.051 0.468462,-0.01644 0.937467,-0.0078 1.405,0.026 1.063053,0.100956 2.101902,0.378073 3.074,0.82 0.296,0.145 0.567,0.289 0.804,0.416 0.246,0.135 0.508,0.364 0.804,0.694
l -2.43,3.945
c -0.296,-0.296 -0.71,-0.524 -1.253,-0.677 -0.533,-0.16 -0.965,-0.237 -1.295,-0.237 -0.22,0 -0.44,-0.017 -0.66,-0.05 -0.250179,-0.03407 -0.503821,-0.03407 -0.754,0
l -6.95,0.964
c -0.992,0.153 -1.914,0.085 -2.761,-0.194 -0.855,-0.28 -1.558,-0.652 -2.1,-1.118 -3.100162,-9.58848 -5.478,-34.544 -5.478,-35.915
z`),king:zs(`m 25.821,12.022
h -1.76
V 8.772
H 21.994
C 21.436,8.772 21.156,8.5 21.156,7.95
V 7.925
c 0,-0.542 0.28,-0.813 0.838,-0.813
H 24.06
V 5.004
c 0,-0.585 0.297,-0.872 0.89,-0.872 0.575,0 0.871,0.287 0.871,0.872
v 2.108
h 2.134
c 0.542,0 0.813,0.27 0.813,0.813
V 7.95
c 0,0.55 -0.271,0.821 -0.813,0.821
l -2.117,0.026
z

m -4.183,1.457
c 0.914,-0.906 2.023,-1.372 3.31,-1.389 1.287,0 2.388,0.466 3.302,1.38 0.906,0.915 1.363,2.015 1.363,3.285 0,0.263 -0.034,0.61 -0.101,1.042 0.228,-0.144 0.457,-0.271 0.669,-0.373 0.762,-0.33 1.76,-0.72 3.005,-1.16 1.423,-0.482 2.701,-0.753 3.844,-0.821 2.921,-0.136 5.241,0.753 6.943,2.65 1.668,1.888 2.447,3.785 2.328,5.681 -0.127,1.973 -0.703,3.65 -1.71,5.038 -0.33,0.449 -0.703,0.863 -1.118,1.253 -0.539774,0.506071 -1.093315,0.997256 -1.66,1.473 -0.541,0.466 -1.007,0.796 -1.388,0.982 -0.38,0.186 -0.6,0.347 -0.669,0.457 -0.01253,0.02813 -0.0294,0.05411 -0.05,0.077 -0.017,0.017 -0.026,0.034 -0.026,0.05
l -0.796,4.666 1.643,6.121
c -0.83,0.745 -2.684,1.355 -5.554,1.837 -2.879,0.483 -6.206,0.72 -9.974,0.72 -3.835,0 -4.284,-32.055 -3.361,-32.969
z`)},Vs=[{id:`basicsI`,icon:Bs.king,title:`The Basics I`,description:`What is Chess? What are all these symbols?`,puzzles:[{id:`empty`,title:`8x8 Board`,description:`The game is played on an 8x8 board. There are no pieces to arrange yet. Click the board to activate next level.`,base_fen:``,initial_fen:``},{id:`thekings`,title:`2 Kings`,description:`There are 2 kings on the board. The small red icons meanining they are attacking each other. Because a king can move to all adjacent squares it is on. Separate them to get rid of red icons.`,base_fen:`6k1/8/8/8/8/8/8/2K5 w - - 0 1`,initial_fen:`8/8/8/4k3/3K4/8/8/8 w - - 0 1`},{id:`theknight`,title:`Knight attacks in L Shape`,description:`L shape is a Knight because knight attacks in L shape in all directions. The small red icons means it is attacking both of the kings. Separate them to get rid of red icons.`,base_fen:`7k/8/8/8/3K4/8/8/6n1 w - - 0 1`,initial_fen:`8/6k1/8/5n2/3K4/8/8/8 w - - 0 1`},{id:`thebishop`,title:`Bishop attacks Diagonally`,description:`X shape is a Bishop because bishop attacks diagonally. The small red icons on the Bishop shows which pieces the Bishop attacks. Separate all of them so no piece attacks any other piece.`,base_fen:`8/6k1/8/8/8/6N1/1K6/3B4 w - - 0 1`,initial_fen:`8/6k1/8/4B3/8/6N1/1K6/8 w - - 0 1`},{id:`therook`,title:`Rook attacks in Straight directions`,description:`+ shape is a Rook because rook attacks in straight directions. The small red icons on the Rook shows which pieces Rook attacks. Separate all of them so no piece attacks any other piece.`,base_fen:`5k2/8/1N6/8/8/3B4/7R/K7 w - - 0 1`,initial_fen:`3k4/8/8/N2R3B/8/8/3K4/8 w - - 0 1`},{id:`thequeen`,title:`Queen attacks like a bishop and a rook`,description:`* shape is a Queen because queen attacks like a bishop and a rook. The small red icons on the Queen shows which pieces Queen attacks. Separate all of them so no piece attacks any other piece.`,base_fen:`3k4/8/8/R7/6Q1/8/3K4/8 w - - 0 1`,initial_fen:`3k4/8/8/3Q4/8/8/R7/3K4 w - - 0 1`},{id:`thepawn`,title:`Pawns attack 1 square diagonnaly forward`,description:`Y shape is a Pawn because pawn attacks diagonally forward by 1 square. The small red icons on the Pawn shows it is attacking the Knight. Separate all of them so they don't attack each other.`,base_fen:`8/8/8/8/2N5/6P1/8/8 w - - 0 1`,initial_fen:`8/8/8/8/2N5/3P4/8/8 w - - 0 1`},{id:`thepawn2`,title:`Black Pawns attack 1 square diagonnaly backward`,description:`Upside Y shape is a Black Pawn because black pawn attacks diagonally backward by 1 square. The small red icons on the Pawn shows it is attacking the Knight. Separate all of them so they don't attack each other.`,base_fen:`8/8/8/8/2N5/6p1/8/8 w - - 0 1`,initial_fen:`8/8/8/3p4/2N5/8/8/8 w - - 0 1`}]},{id:`basicsII`,icon:Bs.king,title:`The Basics II`,description:`All about the pieces attacking each other.`,puzzles:[{id:`attraction`,title:`Kings attraction`,description:`Ah, now the little red icons are orbiting. Orbiting red icon on a piece means, the piece should attack the piece on the orbiting icon. Connect the kings so they attack each other.`,base_fen:`8/8/8/3k4/4K3/8/8/8 w - - 0 1`,initial_fen:`k7/8/8/8/8/8/8/7K w - - 0 1`},{id:`attraction2`,title:`Knight attacks King`,description:`Place the Knight so that it should attack the king.`,base_fen:`8/8/2n5/4K3/8/8/8/8 w - - 0 1`,initial_fen:`8/8/8/2n1K3/8/8/8/8 w - - 0 1`},{id:`attraction3`,title:`Rook and King`,description:`Place Rook and King near so they attack each other.`,base_fen:`8/8/8/8/3RK3/8/8/8 w - - 0 1`,initial_fen:`8/8/2R5/8/8/5K2/8/8 w - - 0 1`},{id:`attraction4`,title:`Bishop and King`,description:`Place Bishop and King near so they attack each other.`,base_fen:`8/8/8/3b4/4K3/8/8/8 w - - 0 1`,initial_fen:`8/8/8/8/8/2b2K2/8/8 w - - 0 1`},{id:`attraction5`,title:`Only Rook attacks King`,description:`This time only the Rook attacks the King. But the King doesn't attack the Rook.`,base_fen:`8/8/8/8/8/8/8/R6K w - - 0 1`,initial_fen:`8/8/2R5/8/4K3/8/8/8 w - - 0 1`},{id:`attraction6`,title:`Only Bishop attacks King`,description:`This time only the Bishop attacks the King. But the King doesn't attack the Bishop.`,base_fen:`8/8/2b5/8/4K3/8/8/8 w - - 0 1`,initial_fen:`8/8/8/3b4/4K3/8/8/8 w - - 0 1`},{id:`attraction7`,title:`Queen attacks only one King`,description:`Queen attacks only one of the kings. Also make sure Queen doesn't attack the other King.`,base_fen:`7k/8/8/8/8/8/8/K5Q1 w - - 0 1`,initial_fen:`8/8/8/3Q1k2/8/1K6/8/8 w - - 0 1`},{id:`attraction9`,title:`King combination`,description:`Some Kings attack some Kings, but not other Kings.`,base_fen:`8/8/8/3k1K2/2K3k1/8/8/8 w - - 0 1`,initial_fen:`k6k/8/8/8/8/8/8/K6K w - - 0 1`},{id:`attraction8`,title:`Queen King 1 and King 2`,description:`Queen attacks one of the King's. Also King's attack each other.`,base_fen:`8/8/8/3Q1k2/5K2/8/8/8 w - - 0 1`,initial_fen:`8/8/8/3Q4/5k2/1K6/8/8 w - - 0 1`}]},{id:`rook`,icon:Bs.rook,title:`The Rook`,description:`Puzzles involving the Rook`,puzzles:[{id:`rooks1`,title:`2 Rooks`,description:`2 rooks attacking each other.`,base_fen:`8/8/8/R6R/8/8/8/8 w - - 0 1`,initial_fen:`8/8/2R5/8/8/5R2/8/8 w - - 0 1`},{id:`rookandknight1`,title:`Rook And Knight`,description:`Rook attacking a Knight.`,base_fen:`8/8/8/8/8/2R2N2/8/8 w - - 0 1`,initial_fen:`8/8/8/8/4N3/2R5/8/8 w - - 0 1`},{id:`rooks2`,title:`3 Rooks`,description:`3 Rooks attacking each other.`,base_fen:`8/8/2R2R2/8/8/2R5/8/8 w - - 0 1`,initial_fen:`8/8/5R2/8/8/2R2R2/8/8 w - - 0 1`},{id:`rookandknight2`,title:`Rook And 2 Knights`,description:`Rook attacks one of the Knights. The other Knight attacks the Rook.`,base_fen:`8/8/8/4R3/8/3r1N2/8/8 w - - 0 1`,initial_fen:`8/8/2R5/4N3/8/5r2/8/8 w - - 0 1`},{id:`rooks3`,title:`4 Rooks`,description:`4 Rooks attacking each other.`,base_fen:`r6r/8/8/8/8/8/8/R6R w - - 0 1`,initial_fen:`8/8/2R5/4r3/3r4/5R2/8/8 w - - 0 1`},{id:`rooksandbishop`,title:`Bishop and 2 Rooks`,description:`Bishop attacks 2 Rooks. And Rooks attacks each other.`,base_fen:`8/8/8/8/8/3R1r2/4B3/8 w - - 0 1`,initial_fen:`8/8/8/2R1B3/8/4r3/8/8 w - - 0 1`},{id:`rooks4`,title:`No Rooks attack each other`,description:`Place the Rooks so they don't attack each other.`,base_fen:`8/8/1R6/3R4/4R3/6r1/2r5/8 w - - 0 1`,initial_fen:`8/8/2R1r3/3r4/2R1R3/8/8/8 w - - 0 1`}]},{id:`bishop`,icon:Bs.bishop,title:`The Bishop`,description:`Puzzles involving the Bishop`,puzzles:[{id:`bishops1`,title:`3 Bishops`,description:`3 bishops attacking each other.`,base_fen:`8/8/2B5/8/4B3/8/2B5/8 w - - 0 1`,initial_fen:`8/8/8/8/2B1B1B1/8/8/8 w - - 0 1`},{id:`bishopsandknight`,title:`Bishop and Knight attack a King`,description:`Bishop and Knight both attack a King.`,base_fen:`8/8/4K3/8/2BN4/8/8/8 w - - 0 1`,initial_fen:`8/8/8/8/2B2N1K/8/8/8 w - - 0 1`},{id:`bishops2`,title:`4 Bishops`,description:`4 Bishops attacking each other.`,base_fen:`8/8/4b3/8/2B3b1/8/4B3/8 w - - 0 1`,initial_fen:`8/8/8/8/1B1b1B1b/8/8/8 w - - 0 1`},{id:`bishops3`,title:`4 Bishops don't attack each other`,description:`Place the Bishops so they don't attack each other.`,base_fen:`8/1b6/3B4/5B2/7B/8/8/8 w - - 0 1`,initial_fen:`8/8/4B3/5B2/4B3/5b2/8/8 w - - 0 1`}]},{id:`knight`,icon:Bs.knight,title:`The Knight`,description:`Puzzles involving the Knight`,puzzles:[{id:`knight1`,title:`3 Knights`,description:`3 Knights attacking each other.`,base_fen:`8/8/8/4n3/6N1/3N4/8/8 w - - 0 1`,initial_fen:`8/8/8/8/N5N1/8/8/3n4 w - - 0 1`},{id:`knight2`,title:`2 Knights vs King`,description:`2 Knights attacking a King`,base_fen:`8/8/8/6N1/3n4/5K2/8/8 w - - 0 1`,initial_fen:`8/8/4n3/6N1/8/3K4/8/8 w - - 0 1`},{id:`knight3`,title:`4 Knights`,description:`4 Knights attacking each other`,base_fen:`8/8/4n3/6N1/3n4/5N2/8/8 w - - 0 1`,initial_fen:`8/8/1n3N2/8/8/1n3N2/8/8 w - - 0 1`},{id:`knight4`,title:`5 Free Knights`,description:`5 Knights that don't attack each other.`,base_fen:`3n4/8/1n3N2/8/8/1n3N2/8/8 w - - 0 1`,initial_fen:`8/8/8/1n1n1N2/8/2n1N3/8/8 w - - 0 1`}]},{id:`pawn`,icon:Bs.pawn,title:`The Pawns`,description:`Puzzles involving the Pawns`,puzzles:[{id:`pawnsandking1`,title:`Forward Pawn attacks King`,description:`Forward Pawn and a King attack each other`,base_fen:`8/8/8/8/8/3K4/2P5/8 w - - 0 1`,initial_fen:`8/8/8/8/8/8/2P1K3/8 w - - 0 1`},{id:`pawnsandknight`,title:`Backward Pawn attacks Knight`,description:`Backward Pawn attacks a Knight`,base_fen:`8/3p4/4n3/8/8/8/8/8 w - - 0 1`,initial_fen:`8/3p1n2/8/8/8/8/8/8 w - - 0 1`},{id:`2pawns`,title:`Pawn Tension`,description:`2 Pawns attacking each other`,base_fen:`8/8/8/8/4p3/3P4/8/8 w - - 0 1`,initial_fen:`8/8/8/8/8/1P3p2/8/8 w - - 0 1`},{id:`pawns1`,title:`Forward Pawn Chain`,description:`3 Forward Pawns form a chain by attacking each other.`,base_fen:`8/8/8/8/3P4/2P5/1P6/8 w - - 0 1`,initial_fen:`8/8/8/8/8/8/1P1P2P1/8 w - - 0 1`},{id:`pawns2`,title:`Backward Pawns`,description:`4 Backward Pawns that don't attack each other`,base_fen:`8/2pppp2/8/8/8/8/8/8 w - - 0 1`,initial_fen:`8/5p2/4p3/3p4/2p5/8/8/8 w - - 0 1`},{id:`bishopandpawns`,title:`Bishop And Pawns`,description:`Bishop And Pawns attacking each other.`,base_fen:`8/5p2/4B3/8/8/1P6/8/8 w - - 0 1`,initial_fen:`8/8/8/8/8/1P2B1p1/8/8 w - - 0 1`},{id:`knightandpawns`,title:`Knight And Pawns`,description:`Knight And Pawns attacking each other.`,base_fen:`8/8/8/2N5/3P4/1P6/3N4/8 w - - 0 1`,initial_fen:`8/8/8/8/8/6N1/P1P1N3/8 w - - 0 1`},{id:`rookandpawns`,title:`Rook And Pawns`,description:`Rook And Pawns attacking each other.`,base_fen:`8/8/5p2/3Rr3/2P5/8/8/8 w - - 0 1`,initial_fen:`8/8/8/8/P1R1r2p/8/8/8 w - - 0 1`},{id:`pawnshelter`,title:`Pawn Shelter`,description:`King is in a Pawn Shelter`,base_fen:`8/8/8/8/8/8/PPP5/1K6 w - - 0 1`,initial_fen:`P6P/8/8/8/8/8/8/K6P w - - 0 1`},{id:`kingfianchetto`,title:`King Fianchetto`,description:`King is again in a Pawn Shelter`,base_fen:`8/8/8/8/8/6P1/5PKP/8 w - - 0 1`,initial_fen:`8/8/8/2P1P3/8/2K1P3/8/8 w - - 0 1`}]},{id:`queen`,icon:Bs.queen,title:`The Queen`,description:`Puzzles involving the Queen`,puzzles:[{id:`queenvsrook`,title:`Queen vs 3 Rooks`,description:`Queen attacks a bunch of Rooks`,base_fen:`8/5R2/8/3Q4/8/1R6/6R1/8 w - - 0 1`,initial_fen:`8/5R2/8/2Q5/8/1R6/6R1/8 w - - 0 1`},{id:`queenknightandking`,title:`Queen Knight and a King`,description:`Queen and Knight attack a King`,base_fen:`5K2/5Q2/8/6N1/8/8/8/8 w - - 0 1`,initial_fen:`5K2/8/8/8/8/8/1Q6/6N1 w - - 0 1`},{id:`queenstrange`,title:`Queen Attacks All Directions`,description:`Queen Attacks to All Directions`,base_fen:`8/8/2K1K1K1/8/2K1Q1K1/8/2K1K1K1/8 w - - 0 1`,initial_fen:`K3K2K/8/8/8/5Q2/K6K/8/K2K3K w - - 0 1`},{id:`4queens`,title:`4 Queens`,description:`4 Queens attacking each other`,base_fen:`8/8/8/8/3Q4/2Q1Q3/3Q4/8 w - - 0 1`,initial_fen:`8/8/8/6Q1/4Q3/2Q5/Q7/8 w - - 0 1`},{id:`queen1`,title:`8 Queen's Problem`,description:`The Famous Puzzle re-demonstrated`,base_fen:`3Q4/1Q6/6Q1/2Q5/5Q2/7Q/4Q3/Q7 w - - 0 1`,initial_fen:`7Q/6Q1/5Q2/4Q3/3Q4/2Q5/1Q6/Q7 w - - 0 1`}]}];function Hs(e){let[t,n]=w(null),[r,i]=Is(tr({puzzles_in_progress:[]}),{name:`.morchess.learn-store.v1`}),a=e=>{let t=s();if(t)return t.puzzles.find(t=>t.id===e)},o=(e,t)=>({id:e.id,module_id:t,fen:e.initial_fen,stats:{nb_steps:0},is_active:!0}),s=D(()=>Vs.find(e=>e.id===t())),c=D(()=>{let e=s();return e?r.puzzles_in_progress.find(t=>t.module_id===e.id&&t.is_active)||o(e.puzzles[0],e.id):void 0}),l=D(()=>{let e=s();if(!e)return;let t=c();if(!t)return;let n=e.puzzles.findIndex(e=>e.id===t.id)+1;return e.puzzles[n]}),u=D(()=>Vs.map(e=>({id:e.id,nb_solved:r.puzzles_in_progress.filter(t=>t.module_id===e.id&&t.stats.nb_solved!==void 0).length}))),d={get module_progressions(){return u()},get module_puzzle(){let e=c();if(e)return a(e.id)},get puzzle(){return c()},get modules(){return Vs},get active_module(){return s()},get can_next(){let e=c();return!e||e.stats.nb_solved===void 0?!1:l()?.id!==void 0},get is_complete(){let e=s();if(!e)return!1;let t=c();return t?e.puzzles[e.puzzles.length-1].id===t.id&&t.stats.nb_solved!==void 0:!1},get can_reset(){let e=c();if(!e)return!1;let t=a(e.id);return t?e.fen!==t.initial_fen:!1}},f=(e,t)=>{r.puzzles_in_progress.find(t=>t.id===e.id)||i(`puzzles_in_progress`,r.puzzles_in_progress.length,o(e,t))};return[d,{on_next(){if(!d.can_next)return;let e=s();if(!e)return;let t=c();if(!t)return;let n=l();n&&oe(()=>{i(`puzzles_in_progress`,e=>e.id===t.id,`is_active`,!1),f(n,e.id),i(`puzzles_in_progress`,e=>e.id===n.id,`is_active`,!0)})},on_reset(){if(!d.can_reset)return;let e=s();if(!e)return;let t=c();if(!t)return;let n=a(t.id);n&&(f(n,e.id),i(`puzzles_in_progress`,e=>e.id===t.id,`fen`,n.initial_fen))},set_solved(){let e=s();if(!e)return;let t=c();if(!t)return;let n=a(t.id);n&&(f(n,e.id),i(`puzzles_in_progress`,e=>e.id===t.id,`stats`,`nb_solved`,0))},set_fen(e){let t=s();if(!t)return;let n=c();if(!n)return;let r=a(n.id);r&&(f(r,t.id),i(`puzzles_in_progress`,e=>e.id===n.id,`fen`,e))},set_steps(){},set_active_module_id(e){n(e)}}]}var Us=ve();function Ws(){return ye(Us)}function Gs(){return Ws().leaderboards}function Ks(){return Ws().puzzles}function qs(){return Ws().learn}function Js(e){let t,n,r,[i]=tr({get leaderboards(){return t},get puzzles(){return n},get learn(){return r}});return t=qo(i),n=Ls(i),r=Hs(i),A(Us.Provider,{value:i,get children(){return e.children}})}var Ys=`modulepreload`,Xs=function(e,t){return new URL(e,t).href},Zs={};const Qs=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let e=document.getElementsByTagName(`link`),i=document.querySelector(`meta[property=csp-nonce]`),a=i?.nonce||i?.getAttribute(`nonce`);function o(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:`fulfilled`,value:e}),e=>({status:`rejected`,reason:e}))))}r=o(t.map(t=>{if(t=Xs(t,n),t in Zs)return;Zs[t]=!0;let r=t.endsWith(`.css`),i=r?`[rel="stylesheet"]`:``;if(n)for(let n=e.length-1;n>=0;n--){let i=e[n];if(i.href===t&&(!r||i.rel===`stylesheet`))return}else if(document.querySelector(`link[href="${t}"]${i}`))return;let o=document.createElement(`link`);if(o.rel=r?`stylesheet`:Ys,r||(o.as=`script`),o.crossOrigin=``,o.href=t,a&&o.setAttribute(`nonce`,a),document.head.appendChild(o),r)return new Promise((e,n)=>{o.addEventListener(`load`,e),o.addEventListener(`error`,()=>n(Error(`Unable to preload CSS for ${t}`)))})}))}function i(e){let t=new Event(`vite:preloadError`,{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(let e of t||[])e.status===`rejected`&&i(e.reason);return e().catch(i)})};var $s=j(`<main class="grow w-full">`),ec=j(`<div class="min-h-screen flex flex-col">`),tc=j(`<div class="grid lg:grid-cols-12 gap-8 items-start py-12"><div class="lg:col-span-7 xl:col-span-8 flex justify-center"><div id=the-game-board class="relative w-full max-w-150 aspect-square shadow-2xl rounded-lg overflow-hidden border-4 border-slate-700"></div></div><div class="lg:col-span-5 xl:col-span-4 space-y-6"><div class="flex bg-slate-900 p-1 rounded-xl border border-slate-800"></div><div class="bg-slate-900 border border-slate-800 rounded-xl p-6 shadow-sm"></div><div class="text-xs text-center text-slate-600 mt-8"> 2026 Mor Chess 3. All rights reserved.<br><div class="flex justify-center gap-x-2"><!><!><!></div><br>Designed with .`),nc=j(`<button>`),rc=j(`<div class="w-full bg-slate-900/50 border-b border-indigo-500/20 backdrop-blur-sm animate-in slide-in-from-top duration-500 overflow-hidden"><div class="max-w-6xl mx-auto px-4 py-3 flex flex-col sm:flex-row items-center justify-between gap-4"><div class="flex items-center gap-3"><div class="w-8 h-8 rounded-lg bg-indigo-500/10 flex items-center justify-center text-indigo-400"><svg class="w-5 h-5"fill=none viewBox="0 0 24 24"stroke=currentColor><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><div><p class="text-sm font-medium text-slate-200">New to Mor Chess 3?</p><p class="text-xs text-slate-500">Master pieces, and symbols in our Academy modules.</p></div></div><div class="flex items-center gap-4"><button class="text-xs font-bold text-indigo-400 hover:text-indigo-300 uppercase tracking-widest transition-colors flex items-center gap-1 group">Visit Learn Section<svg class="w-3 h-3 group-hover:translate-x-1 transition-transform"fill=none viewBox="0 0 24 24"stroke=currentColor><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M9 5l7 7-7 7"></path></svg></button><button class="p-1.5 text-slate-600 hover:text-slate-400 hover:bg-slate-800 rounded-lg transition-all"aria-label="Dismiss banner"><svg class="w-4 h-4"fill=none viewBox="0 0 24 24"stroke=currentColor><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M6 18L18 6M6 6l12 12">`),ic=j(`<div class="grid grid-cols-2 gap-3"><button class="px-4 py-2 bg-slate-800 hover:bg-slate-700 text-slate-200 rounded-lg font-medium transition-colors border border-slate-700">Shuffle Board</button><button class="px-4 py-2 bg-slate-800 hover:bg-slate-700 text-slate-200 rounded-lg font-medium transition-colors border border-slate-700 opacity-50">Reveal Solution`),ac=j(`<div class="flex items-center justify-between"><span class=text-red-500>Failed Loading Daily Puzzle.</span><button class="px-4 py-2 bg-slate-800 hover:bg-slate-700 text-slate-200 rounded-lg font-medium transition-colors border border-slate-700">Refresh Page`),oc=j(`<div class="flex items-center justify-between mb-4"><span class="px-2 py-1 bg-slate-800 text-xs font-bold uppercase tracking-wider text-indigo-400 rounded border border-slate-700">Daily Challenge  </span><span>`),sc=j(`<h1 class="text-2xl font-bold text-white mb-2">Puzzle #`),cc=j(`<p class="text-slate-400 mb-6 leading-relaxed">Reconstruct the original configuration consistent with pieces' attack relationships.`),lc=j(`<span class="font-semibold text-amber-500">Revealed Solution After:`),uc=j(`<span class="font-bold text-xl text-amber-200">`),dc=j(`<span class="font-semibold text-emerald-400">Solved Solution After:`),fc=j(`<span class="font-bold text-xl text-emerald-200">`),pc=j(`<div>`),mc=j(`<span class="text-xs text-slate-400">See the leaderboards if you made it.`),hc=j(`<span class="text-xs text-slate-400">Come back tomorrow to try again.`),gc=j(`<div class=mb-3>`),_c=j(`<span class="font-semibold text-slate-400">Distance Traveled:`),vc=j(`<span class="font-bold text-xl text-slate-200">`),yc=j(`<span class="text-xs text-slate-400">Good luck solving!`),bc=j(`<div class="md:hidden absolute top-16 left-0 w-full bg-slate-900 border-b border-slate-800 shadow-2xl animate-in slide-in-from-top-2 duration-200"><div class="flex flex-col p-4 space-y-2"><button>Puzzles</button><button>Learn</button><button>About</button><button>Legal`),xc=j(`<nav class="border-b border-slate-800 bg-slate-900/50 backdrop-blur sticky top-0 z-50"><div class="max-w-6xl mx-auto px-4 h-16 flex items-center justify-between"><div class="flex items-center gap-2"><div class="w-10 h-10 bg-linear-to-br from-indigo-500 to-purple-600 rounded flex items-center justify-center text-white font-bold font-serif"><img class="w-9 h-9 rounded"alt=logo src=/logo_big.png></div></div><div class="flex items-center gap-6"><div class="hidden md:flex items-center gap-6 text-sm font-medium text-slate-400"></div><button class="md:hidden text-slate-300 hover:text-white p-2">`),Sc=j(`<svg class="w-6 h-6"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M6 18L18 6M6 6l12 12">`),Cc=j(`<svg class="w-6 h-6"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M4 6h16M4 12h16m-7 6h7">`),wc=j(`<div class="bg-slate-900 border border-slate-800 rounded-xl flex flex-col shadow-sm overflow-hidden"><div class="p-6 pb-0 flex flex-col gap-4 bg-slate-900 z-10 shadow-sm"><div class="flex items-center justify-between mb-1"><h3 class="text-lg font-bold text-white flex items-center gap-2"><svg class="w-5 h-5 text-yellow-500"fill=none viewBox="0 0 24 24"stroke=currentColor><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>Leaderboard</h3></div><div class="flex bg-slate-950 p-1 rounded-lg"></div><div class="flex border-b border-slate-800 pb-0 gap-1"></div><div class="flex items-center justify-between text-xs font-bold text-slate-500 uppercase tracking-wider pb-2 border-b border-slate-800 mt-2 px-4"><span class="w-6 text-center">#</span><span class="flex-1 px-3">Player</span><span>Distance Traveled</span></div></div><div class="flex items-center justify-center overflow-y-auto h-64 space-y-0.5"><div class="flex items-center justify-between"><span class=text-slate-500>Loading Leaderboards...</span></div></div><div class="flex items-center justify-between text-sm py-2 px-4"><div class="text-center font-bold text-indigo-400 text-xs">Loading Leaderboards...`),Tc=j(`<button class="capitalize flex-1 py-1.5 text-xs font-medium rounded transition-all text-slate-500 hover:text-slate-300 hover:bg-slate-800">`),Ec=j(`<button class="flex-1 text-xs font-semibold uppercase tracking-wider pb-2 transition-colors relative text-slate-600 hover:text-slate-400">`),Dc=j(`<div class="bg-slate-900 border border-slate-800 rounded-xl p-6 shadow-sm"><div class="flex items-center justify-between"><span class=text-slate-600>Leaderboards Not Available.</span><button class="px-4 py-2 bg-slate-800 hover:bg-slate-700 text-slate-200 rounded-lg font-medium transition-colors border border-slate-700">Refresh Page`),Oc=j(`<div class="bg-slate-900 border border-slate-800 rounded-xl flex flex-col shadow-sm overflow-hidden"><div class="p-6 pb-0 flex flex-col gap-4 bg-slate-900 z-10 shadow-sm"><div class="flex items-center justify-between mb-1"><h3 class="text-lg font-bold text-white flex items-center gap-2"><svg class="w-5 h-5 text-yellow-500"fill=none viewBox="0 0 24 24"stroke=currentColor><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>Leaderboard</h3></div><div class="flex bg-slate-950 p-1 rounded-lg"></div><div class="flex border-b border-slate-800 pb-0 gap-1"></div><div class="flex items-center justify-between text-xs font-bold text-slate-500 uppercase tracking-wider pb-2 border-b border-slate-800 mt-2 px-4"><span class="w-6 text-center">#</span><span class="flex-1 px-3">Player</span><span>Distance Traveled</span></div></div><div class="overflow-y-auto h-64 space-y-0.5"></div><div class="bg-indigo-900/20 border-t border-indigo-500/30 z-20">`),kc=j(`<span class="absolute bottom-0 left-0 w-full h-0.5 bg-indigo-500 rounded-t-full">`),Ac=j(`<div class="flex items-center justify-between text-sm py-2 px-4 hover:bg-slate-800/50 transition-colors"><div></div><span></span><span class="text-slate-500 font-mono text-xs">`),jc=j(`<div class="flex items-center justify-between text-sm py-2 px-4"><div class="text-center font-bold text-indigo-400 text-xs">Solve a puzzle to enter these rankings.`),Mc=j(`<form class="flex items-center p-2 gap-2"><div class="group relative flex items-center justify-center cursor-help"><div class="w-5 h-5 rounded-full border border-indigo-400/50 text-indigo-400 flex items-center justify-center text-[10px] font-bold bg-indigo-500/10 hover:bg-indigo-500/20 transition-colors">?</div><div class="absolute bottom-full left-0 mb-3 w-48 bg-slate-900 border border-slate-700 text-slate-300 text-xs p-3 rounded-xl shadow-xl opacity-0 group-hover:opacity-100 transition-all duration-200 pointer-events-none z-50 transform translate-y-1 group-hover:translate-y-0"><p class=leading-relaxed>Enter a handle* to track your daily progress and compete on the global leaderboard.<br><small>* Between 3-8 characters.</small></p><div class="absolute -bottom-1 left-1.5 w-2 h-2 bg-slate-900 border-b border-r border-slate-700 transform rotate-45"></div></div></div><input type=text placeholder="Enter handle to join..."minlength=3 maxlength=8 class="flex-1 bg-slate-900/50 border border-indigo-500/30 rounded px-3 py-1 text-sm text-indigo-100 placeholder-indigo-400/50 focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 transition-all"><button type=submit class="px-3 py-1 bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white text-xs font-bold rounded transition-colors">Join`),Nc=j(`<div class="flex items-center justify-between text-sm py-2 px-4"><div class="w-6 text-center font-bold text-indigo-400 text-xs"></div><span class="flex-1 px-3 font-bold text-indigo-100 truncate"></span><span class="text-indigo-300 font-mono text-xs font-bold">`),Pc=j(`<button class="p-2 text-slate-400 hover:text-white transition-colors rounded-full hover:bg-slate-800">`),Fc=j(`<svg class="w-5 h-5"fill=none viewBox="0 0 24 24"stroke=currentColor><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z">`),Ic=j(`<svg class="w-5 h-5"fill=none viewBox="0 0 24 24"stroke=currentColor><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2">`),Lc=Qe(()=>Qs(()=>import(`./Legal-B9fEUvrA.js`),[],import.meta.url)),Rc=Qe(()=>Qs(()=>import(`./About-CQeNXyFJ.js`),[],import.meta.url)),zc=Qe(()=>Qs(()=>import(`./Contact-S2TY0srx.js`),[],import.meta.url)),Bc=Qe(()=>Qs(()=>import(`./Learn-_umrVyYV.js`),[],import.meta.url));function Vc(){return A(In,{root:Hc,get children(){return[A(kn,{path:`/`,component:Uc}),A(kn,{path:`/about`,component:Rc}),A(kn,{path:`/legal`,component:Lc}),A(kn,{path:`/contact`,component:zc}),A(kn,{path:`/learn`,component:Bc})]}})}function Hc(e){let[t,n]=w(!1);return(()=>{var r=ec();return N(r,A(Js,{get children(){return[A(Zc,{get isMobileMenuOpen(){return t()},setIsMobileMenuOpen:n}),(()=>{var r=$s();return r.$$click=()=>t()&&n(!1),N(r,()=>e.children),r})()]}})),r})()}var Uc=()=>{let[e,{set_shuffle:t,set_reveal:n,set_daily_steps:r,set_daily_tier:i,set_daily_fen:a,set_solved:o}]=Ks(),s=D(()=>e.daily_selected_tier),c=D(()=>e.saved_daily_puzzle_set),l=D(()=>c()?.[e.daily_selected_tier]),u=D(()=>e.stats);return[A(Wc,{}),(()=>{var c=tc(),d=c.firstChild,f=d.firstChild,p=d.nextSibling,m=p.firstChild,h=m.nextSibling,g=h.nextSibling,_=g.firstChild.nextSibling.nextSibling,v=_.firstChild,y=v.nextSibling,b=y.nextSibling.nextSibling,x=b.nextSibling.nextSibling;return x.nextSibling,N(f,A(ct,{fallback:``,get children(){return A(ut,{get children(){return A(Bo,{get is_muted(){return!e.sound_enabled},get fen(){return l()?.fen},get target(){return l()?.base_fen},get nb_steps(){return u()?.nb_steps},set_update_steps:r,set_update_fen:a,set_update_solved:o})}})}})),N(m,()=>qc.map(e=>(()=>{var t=nc();return t.$$click=()=>i(e),N(t,()=>Jc[e]),T(()=>M(t,`flex-1 py-2 text-sm font-medium rounded-lg transition-all ${s()===e?`bg-indigo-600 text-white shadow-lg`:`text-slate-400 hover:text-white hover:bg-slate-800`}`)),t})())),N(h,A(ct,{fallback:Kc,get children(){return A(ut,{get children(){return[A(Xc,{get stats(){return u()},get selected_tier(){return s()},get puzzle_id(){return l()?.id??0}}),A(Gc,{on_shuffle:t,on_reveal:n})]}})}})),N(p,A(Qc,{}),g),N(_,A(Rn,{href:`legal#privacy`,class:`link`,children:`Privacy Policy`}),v),N(_,A(Rn,{href:`legal#terms`,class:`link`,children:`Terms of Service`}),y),N(_,A(Rn,{href:`contact`,class:`link`,children:`Contact Us`}),b),N(_,A(Rn,{href:`https://buymeacoffee.com/eguneys`,class:`link`,children:`Support Us`}),x),N(_,A(Rn,{href:`https://github.com/eguneys/morchess3`,target:`_blank`,class:`link`,children:`GitHub`}),null),c})()]},Wc=()=>{let[e,t]=w(!1),[n,r]=Is(w(!1),{name:`.morchess3.welcome-dismissed`});E(()=>{if(!n()){let e=setTimeout(()=>t(!0),1e3);return()=>clearTimeout(e)}});let i=pn(),a=()=>{i(`/Learn`)},o=()=>{t(!1),r(!0)};return A(rt,{get when(){return e()},get children(){var e=rc(),t=e.firstChild.firstChild.nextSibling.firstChild,n=t.nextSibling;return t.$$click=a,n.$$click=o,e}})},Gc=e=>(()=>{var t=ic(),n=t.firstChild,r=n.nextSibling;return n.$$click=()=>e.on_shuffle(),r.$$click=()=>e.on_reveal(),t})(),Kc=()=>(()=>{var e=ac(),t=e.firstChild.nextSibling;return t.$$click=()=>location.reload(),e})(),qc=[`a`,`b`,`c`],Jc={a:`Easy`,b:`Medium`,c:`Hard`},Yc={a:`bg-green-500/20 text-green-400`,b:`bg-yellow-500/20 text-yellow-400`,c:`bg-red-500/20 text-red-400`},Xc=e=>{let t=D(()=>e.selected_tier),n=D(()=>Jc[t()]),r=D(()=>Yc[t()]),[i]=Ks(),a=D(()=>i.today),o=D(()=>{let e=a();if(!e)return``;let t=e.toLocaleDateString(void 0,{month:`short`,day:`numeric`,timeZone:`UTC`});return new Date().toLocaleDateString(void 0,{month:`short`,day:`numeric`}),`${t} (UTC)`}),s=D(()=>e.stats?.nb_revealed===void 0?e.stats?.nb_solved===void 0?`bg-slate-950/50 border-slate-800`:`bg-emerald-950/50 border-emerald-800`:`bg-amber-950/50 border-amber-800`);return[(()=>{var e=oc(),t=e.firstChild;t.firstChild;var i=t.nextSibling;return N(t,o,null),N(i,n),T(()=>M(i,`px-2 py-1 text-xs font-bold rounded ${r()}`)),e})(),(()=>{var t=sc();return t.firstChild,N(t,()=>e.puzzle_id,null),t})(),cc(),(()=>{var t=pc();return N(t,A(it,{get fallback(){return[_c(),(()=>{var t=vc();return N(t,()=>e.stats?.nb_steps),t})()]},get children(){return[A(at,{get when(){return e.stats?.nb_revealed!==void 0},get children(){return[lc(),(()=>{var t=uc();return N(t,()=>e.stats.nb_revealed),t})()]}}),A(at,{get when(){return e.stats?.nb_solved!==void 0},get children(){return[dc(),(()=>{var t=fc();return N(t,()=>e.stats.nb_solved),t})()]}})]}})),T(()=>M(t,`flex items-center gap-3 p-4 rounded-lg border ${s()} mb-4`)),t})(),(()=>{var t=gc();return N(t,A(it,{get fallback(){return yc()},get children(){return[A(at,{get when(){return e.stats?.nb_solved!==void 0},get children(){return mc()}}),A(at,{get when(){return e.stats?.nb_revealed!==void 0},get children(){return hc()}})]}})),t})()]},Zc=e=>{let t=()=>``,n=pn(),r=mn(),i=D(()=>{let e=r.pathname.split(`/`)[1];return e===``?`home`:e}),a=ae(()=>i()),o=e=>a(e)?`bg-slate-800 text-white`:`text-slate-400 hover:bg-slate-800 hover:text-indigo-400`,s=e=>a(e)?`text-white`:``,c=t=>{n(t),e.setIsMobileMenuOpen(!1)};return(()=>{var n=xc(),r=n.firstChild.firstChild;r.firstChild;var i=r.nextSibling,a=i.firstChild,l=a.nextSibling;return N(r,A(Rn,{href:`/`,class:`text-xl font-bold tracking-tight text-white`,get children(){return[`Mor Chess 3 `,vt(()=>t())]}}),null),N(a,A(Rn,{href:`/`,get class(){return`${s(`home`)} hover:text-indigo-400 transition-colors`},children:`Puzzles`}),null),N(a,A(Rn,{href:`/learn`,get class(){return`${s(`learn`)} hover:text-indigo-400 transition-colors`},children:`Learn`}),null),N(a,A(Rn,{href:`/about`,get class(){return`${s(`about`)} hover:text-indigo-400 transition-colors`},children:`About`}),null),N(i,A(il,{}),l),l.$$click=()=>e.setIsMobileMenuOpen(!e.isMobileMenuOpen),N(l,(()=>{var t=vt(()=>!!e.isMobileMenuOpen);return()=>t()?Sc():Cc()})()),N(n,A(rt,{get when(){return e.isMobileMenuOpen},get children(){var e=bc(),t=e.firstChild.firstChild,n=t.nextSibling,r=n.nextSibling,i=r.nextSibling;return t.$$click=()=>c(`/`),n.$$click=()=>c(`/learn`),r.$$click=()=>c(`/about`),i.$$click=()=>c(`legal`),T(e=>{var a=`text-left px-4 py-3 rounded-lg text-sm font-medium ${o(`home`)}`,s=`text-left px-4 py-3 rounded-lg text-sm font-medium ${o(`learn`)}`,c=`text-left px-4 py-3 rounded-lg text-sm font-medium ${o(`about`)}`,l=`text-left px-4 py-3 rounded-lg text-sm font-medium ${o(`legal`)}`;return a!==e.e&&M(t,e.e=a),s!==e.t&&M(n,e.t=s),c!==e.a&&M(r,e.a=c),l!==e.o&&M(i,e.o=l),e},{e:void 0,t:void 0,a:void 0,o:void 0}),e}}),null),n})()},Qc=()=>A(ct,{get fallback(){return A(el,{})},get children(){return A(ut,{get fallback(){return A($c,{})},get children(){return A(rl,{})}})}}),$c=()=>(()=>{var e=wc(),t=e.firstChild.firstChild.nextSibling,n=t.nextSibling;return N(t,()=>tl.map(e=>(()=>{var t=Tc();return N(t,e),t})())),N(n,()=>nl.map(e=>(()=>{var t=Ec();return N(t,()=>Jc[e]),t})())),e})(),el=()=>(()=>{var e=Dc(),t=e.firstChild.firstChild.nextSibling;return t.$$click=()=>location.reload(),e})(),tl=[`daily`,`weekly`,`monthly`,`yearly`],nl=[`a`,`b`,`c`],rl=()=>{let[e,t]=w(`daily`),[n,{set_daily_tier:r}]=Ks(),i=D(()=>n.daily_selected_tier),a=r,[o,{fetch_period:s,set_leaderboard_handle:c}]=Gs(),l=D(()=>o[e()][i()].list),u=D(()=>o[e()][i()].you),d=e=>{s(e),t(e)},f=()=>{let e=u();return e===void 0?!1:e.handle===null},[p,m]=w(``),h=c;return(()=>{var t=Oc(),n=t.firstChild,r=n.firstChild.nextSibling,o=r.nextSibling,s=n.nextSibling,c=s.nextSibling;return N(r,()=>tl.map(t=>(()=>{var n=nc();return n.$$click=()=>d(t),N(n,t),T(()=>M(n,`capitalize flex-1 py-1.5 text-xs font-medium rounded transition-all ${e()===t?`bg-indigo-600 text-white shadow`:`text-slate-500 hover:text-slate-300 hover:bg-slate-800`}`)),n})())),N(o,()=>nl.map(e=>(()=>{var t=nc();return t.$$click=()=>a(e),N(t,()=>Jc[e],null),N(t,(()=>{var t=vt(()=>i()===e);return()=>t()&&kc()})(),null),T(()=>M(t,`flex-1 text-xs font-semibold uppercase tracking-wider pb-2 transition-colors relative ${i()===e?`text-white`:`text-slate-600 hover:text-slate-400`}`)),t})())),N(s,A(nt,{get each(){return l()},children:e=>(()=>{var t=Ac(),n=t.firstChild,r=n.nextSibling,i=r.nextSibling;return N(n,()=>e.rank),N(r,()=>e.handle),N(i,()=>e.score.toLocaleString()),T(t=>{var i=`w-6 h-6 flex items-center justify-center rounded font-bold text-xs ${e.rank===1?`bg-yellow-500/20 text-yellow-400`:e.rank===2?`bg-slate-300/20 text-slate-300`:e.rank===3?`bg-amber-700/20 text-amber-600`:`text-slate-500`}`,a=`flex-1 px-3 font-medium truncate ${e.rank<=3?`text-slate-200`:`text-slate-400`}`;return i!==t.e&&M(n,t.e=i),a!==t.t&&M(r,t.t=a),t},{e:void 0,t:void 0}),t})()})),N(c,A(rt,{get when(){return u()},get fallback(){return jc()},children:e=>A(rt,{get when(){return f()},get fallback(){return(()=>{var t=Nc(),n=t.firstChild,r=n.nextSibling,i=r.nextSibling;return N(n,()=>e().rank),N(r,()=>e().handle),N(i,()=>e().score.toLocaleString()),t})()},get children(){var e=Mc(),t=e.firstChild.nextSibling,n=t.nextSibling;return e.addEventListener(`submit`,e=>{e.preventDefault(),p().trim().length>=3&&h(p().trim())}),t.$$keyup=e=>m(e.target.value),T(()=>n.disabled=p().trim().length<3),T(()=>t.value=p()),e}})})),t})()},il=()=>{let[e,{set_sound_enabled:t}]=Ks(),n=t,r=D(()=>e.sound_enabled);return(()=>{var e=Pc();return e.$$click=()=>n(!r()),N(e,(()=>{var e=vt(()=>!!r());return()=>e()?Fc():Ic()})()),T(()=>Ct(e,`aria-label`,r()?`Mute audio`:`Enable audio`)),e})()};St([`click`,`keyup`]),xt(()=>A(Vc,{}),document.getElementById(`root`));export{Et as a,N as c,rt as d,A as f,w as h,Rn as i,Ct as l,T as m,Ks as n,M as o,D as p,Bo as r,St as s,qs as t,j as u};